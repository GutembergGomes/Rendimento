<!DOCTYPE html>
<html lang="pt-BR" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GGOMES-LOG | Sistema de Gestão Agrícola</title>
    
    <!-- Tailwind CSS via CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css">
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- jsPDF para relatórios -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://unpkg.com/jspdf-autotable@3.5.28/dist/jspdf.plugin.autotable.js"></script>
    
    <script>
    tailwind.config = {
        darkMode: 'class',
        theme: {
            extend: {
                colors: {
                    primary: {
                        50: '#f4f3ff',
                        100: '#e9e8ff',
                        200: '#d7d5ff',
                        300: '#bab8ff',
                        400: '#9a97ff',
                        500: '#7c7aff',
                        600: '#5D5CDE', // Cor principal 
                        700: '#5a55cc',
                        800: '#4a46a8',
                        900: '#383670',
                        950: '#201f45',
                    }
                },
                fontFamily: {
                    'sans': ['Inter', 'sans-serif'],
                },
                spacing: {
                    '128': '32rem',
                },
            }
        }
    }
    </script>
    
    <style>
        /* Animações para ícones meteorológicos */
        .icon-sun {
            animation: pulse 2s infinite;
        }
        
        .icon-rain {
            animation: bounce 1s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-3px); }
        }
        
        /* Esconder scrollbar mas manter funcionalidade */
        .scrollbar-hide::-webkit-scrollbar {
            display: none;
        }
        
        .scrollbar-hide {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        
        /* Transições suaves */
        .page-transition {
            transition: all 0.3s ease-in-out;
        }
        
        /* Tabs do dashboard */
        .dashboard-tab {
            transition: all 0.2s ease-in-out;
        }
        
        .tab-active {
            border-bottom: 2px solid #5D5CDE;
            color: #5D5CDE;
        }
        
        .dark .tab-active {
            border-bottom: 2px solid #7c7aff;
            color: #7c7aff;
        }
        
        /* Animação de fade-in para toasts */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateX(100%); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        .animate-fade-in {
            animation: fadeIn 0.3s ease-out forwards;
        }
        
        /* Animação de fade-out para toasts */
        @keyframes fadeOut {
            from { opacity: 1; transform: translateX(0); }
            to { opacity: 0; transform: translateX(100%); }
        }
        
        .toast.fade-out {
            animation: fadeOut 0.3s ease-in forwards;
        }

        /* Estilo para o sidebar mobile */
        @media (max-width: 768px) {
            #app-container {
                position: relative;
                overflow-x: hidden;
            }
            
            #app-container aside {
                position: fixed;
                left: -100%;
                transition: left 0.3s ease;
                height: 100vh;
                z-index: 50;
            }
            
            #app-container.sidebar-open aside {
                left: 0;
            }

            #app-container main {
                transition: margin-left 0.3s ease;
            }
            
            #app-container.sidebar-open main {
                margin-left: 256px;
            }
        }
    </style>
</head>
<body class="bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100 min-h-screen">
    <!-- Container principal da aplicação -->
    <div id="app-container" class="flex h-screen overflow-hidden">
        <!-- Menu lateral (Sidebar) -->
        <aside class="w-64 hidden md:block bg-white dark:bg-gray-800 shadow-md z-10 flex-shrink-0">
            <div class="h-full flex flex-col">
                <!-- Logo e título -->
                <div class="p-4 border-b border-gray-200 dark:border-gray-700 flex items-center justify-center">
                    <h1 class="text-xl font-bold text-primary-600 dark:text-primary-400">GGOMES-LOG</h1>
                </div>
                
                <!-- Informações do usuário -->
                <div class="p-4 border-b border-gray-200 dark:border-gray-700">
                    <div class="flex items-center">
                        <div class="h-10 w-10 rounded-full bg-primary-100 dark:bg-primary-900 flex items-center justify-center">
                            <i class="fas fa-user text-primary-600 dark:text-primary-400"></i>
                        </div>
                        <div class="ml-3">
                            <p id="sidebar-user-name" class="font-medium text-gray-800 dark:text-white">Administrador</p>
                            <p id="sidebar-user-role" class="text-xs text-gray-500 dark:text-gray-400">Administrador</p>
                        </div>
                    </div>
                </div>
                
                <!-- Links de navegação -->
                <div class="py-4 flex-1 overflow-y-auto scrollbar-hide">
                    <nav class="px-2 space-y-1">
                        <a href="#dashboard" class="sidebar-link active bg-primary-100 dark:bg-primary-900 text-primary-700 dark:text-primary-300 flex items-center px-4 py-2 rounded-md font-medium mb-1 transition-colors">
                            <i class="fas fa-tachometer-alt mr-3 text-lg"></i>
                            <span>Dashboard</span>
                        </a>
                        
                        <div class="px-3 py-2 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                            Produção
                        </div>
                        
                        <a href="#colhedoras" class="sidebar-link flex items-center px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md font-medium mb-1 transition-colors">
                            <i class="fas fa-tractor mr-3 text-lg"></i>
                            <span>Colhedoras</span>
                        </a>
                        
                        <a href="#registros" class="sidebar-link flex items-center px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md font-medium mb-1 transition-colors">
                            <i class="fas fa-file-alt mr-3 text-lg"></i>
                            <span>Registrar Produção</span>
                        </a>
                        
                        <a href="#liberacoes" class="sidebar-link flex items-center px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md font-medium mb-1 transition-colors">
                            <i class="fas fa-tasks mr-3 text-lg"></i>
                            <span>Liberações</span>
                        </a>
                        
                        <a href="#consumos" class="sidebar-link flex items-center px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md font-medium mb-1 transition-colors">
                            <i class="fas fa-oil-can mr-3 text-lg"></i>
                            <span>Consumo de Óleos</span>
                        </a>
                        
                        <a href="#historico" class="sidebar-link flex items-center px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md font-medium mb-1 transition-colors">
                            <i class="fas fa-history mr-3 text-lg"></i>
                            <span>Histórico</span>
                        </a>
                        
                        <div class="px-3 py-2 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                            Clima e Paradas
                        </div>
                        
                        <a href="#chuvas" class="sidebar-link flex items-center px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md font-medium mb-1 transition-colors">
                            <i class="fas fa-cloud-rain mr-3 text-lg"></i>
                            <span>Registro de Chuvas</span>
                        </a>
                        
                        <div class="px-3 py-2 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                            Logística
                        </div>
                        
                        <a href="#caminhoes" class="sidebar-link flex items-center px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md font-medium mb-1 transition-colors">
                            <i class="fas fa-truck mr-3 text-lg"></i>
                            <span>Caminhões</span>
                        </a>
                        
                        <div class="px-3 py-2 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                            Sistema
                        </div>
                        
                        <a href="#configuracoes" class="sidebar-link flex items-center px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md font-medium mb-1 transition-colors">
                            <i class="fas fa-cog mr-3 text-lg"></i>
                            <span>Configurações</span>
                        </a>
                    </nav>
                </div>
                
                <!-- Rodapé do sidebar -->
                <div class="p-4 border-t border-gray-200 dark:border-gray-700 text-center">
                    <p class="text-xs text-gray-500 dark:text-gray-400">GGOMES-LOG &copy; 2025</p>
                    <p class="text-xs text-gray-500 dark:text-gray-400">Versão 1.0</p>
                </div>
            </div>
        </aside>
        
        <!-- Conteúdo principal -->
        <div class="flex-1 flex flex-col overflow-hidden">
            <!-- Barra superior (Header) -->
            <header class="bg-white dark:bg-gray-800 shadow-sm z-10">
                <div class="flex items-center justify-between px-4 py-2 border-b border-gray-200 dark:border-gray-700">
                    <!-- Toggle do menu lateral (mobile) -->
                    <button id="mobile-menu-toggle" class="md:hidden p-2 rounded-md text-gray-500 hover:text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:text-gray-300 dark:hover:bg-gray-700">
                        <i class="fas fa-bars"></i>
                    </button>
                    
                    <!-- Informações rápidas -->
                    <div class="hidden md:flex items-center space-x-4">
                        <div class="bg-gray-100 dark:bg-gray-700 p-2 rounded-md">
                            <div class="flex items-center">
                                <div class="flex items-center">
                                    <i class="fas fa-weight-hanging text-blue-500 mr-2"></i>
                                    <span class="text-xs text-gray-500 dark:text-gray-400">Total Colhido</span>
                                </div>
                                <div class="ml-2">
                                    <span id="quick-total-colhido" class="font-semibold text-gray-800 dark:text-white">0 T</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-gray-100 dark:bg-gray-700 p-2 rounded-md">
                            <div class="flex items-center">
                                <div class="flex items-center">
                                    <i class="fas fa-tractor text-yellow-500 mr-2"></i>
                                    <span class="text-xs text-gray-500 dark:text-gray-400">Colhedoras</span>
                                </div>
                                <div class="ml-2">
                                    <span id="quick-colhedoras" class="font-semibold text-gray-800 dark:text-white">0</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-gray-100 dark:bg-gray-700 p-2 rounded-md">
                            <div class="flex items-center">
                                <div class="flex items-center">
                                    <i class="fas fa-cloud-rain text-red-500 mr-2"></i>
                                    <span class="text-xs text-gray-500 dark:text-gray-400">Paradas</span>
                                </div>
                                <div class="ml-2">
                                    <span id="quick-paradas-chuva" class="font-semibold text-gray-800 dark:text-white">0 dias</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Ações e perfil do usuário -->
                    <div class="flex items-center space-x-3">
                        <!-- Informações meteorológicas -->
                        <div class="hidden sm:flex items-center mr-2 bg-gray-100 dark:bg-gray-700 px-3 py-1 rounded-md">
                            <i id="weather-icon" class="text-blue-500 mr-2"></i>
                            <span id="weather-temp" class="text-sm font-medium text-gray-700 dark:text-gray-300">--°C</span>
                        </div>
                        
                        <!-- Data atual -->
                        <div class="hidden sm:block mr-2">
                            <span id="current-date" class="text-sm text-gray-600 dark:text-gray-400">--/--/----</span>
                        </div>
                        
                        <!-- Toggle de tema claro/escuro -->
                        <button id="toggle-theme" class="p-2 rounded-md text-gray-500 hover:text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:text-gray-300 dark:hover:bg-gray-700">
                            <i class="fas fa-moon dark:hidden"></i>
                            <i class="fas fa-sun hidden dark:inline-block"></i>
                        </button>
                        
                        <!-- Ícone de notificações -->
                        <button id="btn-notifications" class="p-2 rounded-md text-gray-500 hover:text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:text-gray-300 dark:hover:bg-gray-700 relative">
                            <i class="fas fa-bell"></i>
                            <span id="notification-badge" class="hidden absolute -top-1 -right-1 bg-red-500 text-white text-xs font-bold rounded-full h-5 w-5 flex items-center justify-center">0</span>
                        </button>
                        
                        <!-- Perfil do usuário -->
                        <div class="flex items-center">
                            <div class="mr-2 text-right hidden sm:block">
                                <div id="user-name" class="text-sm font-medium text-gray-800 dark:text-white">Administrador</div>
                                <div class="flex items-center">
                                    <span id="user-role-badge" class="px-2 py-1 rounded text-xs font-medium bg-primary-100 dark:bg-primary-900 text-primary-700 dark:text-primary-300">Admin</span>
                                </div>
                            </div>
                            <div class="h-8 w-8 rounded-full bg-primary-100 dark:bg-primary-900 flex items-center justify-center">
                                <i class="fas fa-user text-primary-600 dark:text-primary-400"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </header>
            
            <!-- Conteúdo principal -->
            <main class="flex-1 overflow-x-hidden overflow-y-auto bg-gray-100 dark:bg-gray-900 p-4">
                <!-- Toast container para mensagens -->
                <div id="toast-container" class="fixed top-4 right-4 z-50 space-y-4"></div>
                
                <!-- Conteúdo do dashboard -->
                <div id="content-dashboard" class="content">
                    <div class="mb-4">
                        <h2 class="text-xl font-bold text-gray-800 dark:text-white mb-2">Dashboard</h2>
                        <p class="text-gray-600 dark:text-gray-400">Resumo da operação e indicadores de desempenho</p>
                    </div>
                    
                    <!-- Tabs do dashboard -->
                    <div class="border-b border-gray-200 dark:border-gray-700 mb-4">
                        <div class="flex overflow-x-auto scrollbar-hide">
                            <button data-tab="producao" class="dashboard-tab tab-active px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 whitespace-nowrap">
                                Produção e Produtividade
                            </button>
                            <button data-tab="caminhoes" class="dashboard-tab px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 whitespace-nowrap">
                                Caminhões e Logística
                            </button>
                            <button data-tab="chuvas" class="dashboard-tab px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 whitespace-nowrap">
                                Paradas por Chuva
                            </button>
                            <button data-tab="consumos" class="dashboard-tab px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 whitespace-nowrap">
                                Consumo de Óleos
                            </button>
                            <button data-tab="estatisticas" class="dashboard-tab px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 whitespace-nowrap">
                                Estatísticas Gerais
                            </button>
                        </div>
                    </div>
                    
                    <!-- Filtro de período -->
                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 mb-6">
                        <div class="flex flex-wrap items-center">
                            <div class="w-full md:w-auto mr-4 mb-2 md:mb-0">
                                <label for="dashboard-period" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Período:</label>
                                <select id="dashboard-period" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500">
                                    <option value="7">Últimos 7 dias</option>
                                    <option value="15">Últimos 15 dias</option>
                                    <option value="30" selected>Últimos 30 dias</option>
                                    <option value="90">Últimos 90 dias</option>
                                    <option value="180">Últimos 6 meses</option>
                                    <option value="365">Último ano</option>
                                    <option value="0">Todo o período</option>
                                </select>
                            </div>
                            <div class="w-full md:w-auto">
                                <button id="refresh-dashboard" class="mt-5 inline-flex items-center px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white font-medium rounded-lg text-sm">
                                    <i class="fas fa-sync-alt mr-2"></i> Atualizar Dashboard
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Conteúdo da tab "Produção e Produtividade" -->
                    <div id="tab-producao" class="dashboard-tab-content">
                        <!-- Produção do Dia (Nova seção) -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 mb-6">
                            <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-3">Produção do Dia</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div id="card-producao-hoje" class="bg-blue-50 dark:bg-blue-900/30 p-4 rounded-lg">
                                    <h4 class="text-sm font-medium text-gray-600 dark:text-gray-300">Total Colhido Hoje</h4>
                                    <div class="flex items-baseline mt-1">
                                        <span id="producao-hoje-total" class="text-2xl font-bold text-blue-600 dark:text-blue-400">0 T</span>
                                    </div>
                                </div>
                                
                                <div id="card-produtividade-hoje" class="bg-purple-50 dark:bg-purple-900/30 p-4 rounded-lg">
                                    <h4 class="text-sm font-medium text-gray-600 dark:text-gray-300">Média Hora Hoje</h4>
                                    <div class="flex items-baseline mt-1">
                                        <span id="producao-hoje-hora" class="text-2xl font-bold text-purple-600 dark:text-purple-400">0 T/h</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Cards de indicadores -->
                        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
                            <!-- Total colhido -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <h3 class="text-sm font-medium text-gray-500 dark:text-gray-400">Total Colhido</h3>
                                        <div class="flex items-baseline mt-1">
                                            <span id="dash-total-colhido" class="text-2xl font-semibold text-gray-900 dark:text-white">0 T</span>
                                        </div>
                                    </div>
                                    <div class="p-2 bg-primary-50 dark:bg-primary-900/30 rounded-lg">
                                        <i class="fas fa-weight-hanging text-xl text-primary-600 dark:text-primary-400"></i>
                                    </div>
                                </div>
                                <div class="mt-3">
                                    <div id="dash-total-trend" class="text-xs text-gray-500 dark:text-gray-400">
                                        <i class="fas fa-arrow-up mr-1 text-green-500"></i>
                                        <span>0% vs. período anterior</span>
                                    </div>
                                    <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1.5 mt-1">
                                        <div id="dash-total-progress" class="bg-green-500 h-1.5 rounded-full" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Média Geral -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <h3 class="text-sm font-medium text-gray-500 dark:text-gray-400">Média Geral</h3>
                                        <div class="flex items-baseline mt-1">
                                            <span id="dash-media-geral" class="text-2xl font-semibold text-gray-900 dark:text-white">0 T/dia</span>
                                        </div>
                                    </div>
                                    <div class="p-2 bg-primary-50 dark:bg-primary-900/30 rounded-lg">
                                        <i class="fas fa-calculator text-xl text-primary-600 dark:text-primary-400"></i>
                                    </div>
                                </div>
                                <div class="mt-3">
                                    <div id="dash-media-trend" class="text-xs text-gray-500 dark:text-gray-400">
                                        <i class="fas fa-arrow-up mr-1 text-green-500"></i>
                                        <span>0% vs. período anterior</span>
                                    </div>
                                    <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1.5 mt-1">
                                        <div id="dash-media-progress" class="bg-green-500 h-1.5 rounded-full" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Média do Dia -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <h3 class="text-sm font-medium text-gray-500 dark:text-gray-400">Média do Dia</h3>
                                        <div class="flex items-baseline mt-1">
                                            <span id="dash-media-dia" class="text-2xl font-semibold text-gray-900 dark:text-white">0 T/dia</span>
                                        </div>
                                    </div>
                                    <div class="p-2 bg-primary-50 dark:bg-primary-900/30 rounded-lg">
                                        <i class="fas fa-calendar-day text-xl text-primary-600 dark:text-primary-400"></i>
                                    </div>
                                </div>
                                <div class="mt-3">
                                    <div id="dash-media-dia-trend" class="text-xs text-gray-500 dark:text-gray-400">
                                        <i class="fas fa-arrow-up mr-1 text-green-500"></i>
                                        <span>0% vs. período anterior</span>
                                    </div>
                                    <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1.5 mt-1">
                                        <div id="dash-media-dia-progress" class="bg-green-500 h-1.5 rounded-full" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Paradas por chuva -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <h3 class="text-sm font-medium text-gray-500 dark:text-gray-400">Paradas por Chuva</h3>
                                        <div class="flex items-baseline mt-1">
                                            <span id="dash-paradas-chuva" class="text-2xl font-semibold text-gray-900 dark:text-white">0 dias</span>
                                        </div>
                                    </div>
                                    <div class="p-2 bg-primary-50 dark:bg-primary-900/30 rounded-lg">
                                        <i class="fas fa-cloud-rain text-xl text-primary-600 dark:text-primary-400"></i>
                                    </div>
                                </div>
                                <div class="mt-3">
                                    <div id="dash-paradas-trend" class="text-xs text-gray-500 dark:text-gray-400">
                                        <i class="fas fa-arrow-down mr-1 text-green-500"></i>
                                        <span>0% vs. período anterior</span>
                                    </div>
                                    <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1.5 mt-1">
                                        <div id="dash-paradas-progress" class="bg-red-500 h-1.5 rounded-full" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Relatório de Médias de Equipamentos -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 mb-6">
                            <div class="flex justify-between mb-3">
                                <h3 class="text-lg font-semibold text-gray-800 dark:text-white">Relatório de Médias dos Equipamentos</h3>
                                <button class="btn-exportar-equipamentos inline-flex items-center px-3 py-1 bg-green-600 hover:bg-green-700 text-white text-sm font-medium rounded-lg">
                                    <i class="fas fa-file-export mr-1"></i> Exportar
                                </button>
                            </div>
                            <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                    <thead class="bg-gray-50 dark:bg-gray-700">
                                        <tr>
                                            <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Colhedora</th>
                                            <th scope="col" class="px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Média Diária (T/dia)</th>
                                            <th scope="col" class="px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Rendimento (T/h)</th>
                                            <th scope="col" class="px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Eficiência</th>
                                        </tr>
                                    </thead>
                                    <tbody id="tabela-medias-equipamentos" class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                                        <!-- Dados serão preenchidos via JavaScript -->
                                        <tr>
                                            <td colspan="4" class="px-4 py-3 text-center text-gray-500 dark:text-gray-400">
                                                Carregando dados...
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        
                        <!-- Seção de desempenho -->
                        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
                            <!-- Melhores colhedoras -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4">
                                <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-3">Melhores Colhedoras</h3>
                                
                                <div class="space-y-4">
                                    <div class="flex items-center justify-between pb-2 border-b border-gray-200 dark:border-gray-700">
                                        <div>
                                            <p class="text-sm text-gray-500 dark:text-gray-400">Melhor Rendimento</p>
                                            <p id="best-yield-colhedora" class="font-medium text-gray-800 dark:text-white">-</p>
                                        </div>
                                        <div class="flex items-center">
                                            <span id="best-yield-value" class="text-sm font-semibold text-green-600 dark:text-green-400">0 T/h</span>
                                        </div>
                                    </div>
                                    
                                    <div class="flex items-center justify-between pb-2 border-b border-gray-200 dark:border-gray-700">
                                        <div>
                                            <p class="text-sm text-gray-500 dark:text-gray-400">Maior Volume</p>
                                            <p id="best-volume-colhedora" class="font-medium text-gray-800 dark:text-white">-</p>
                                        </div>
                                        <div class="flex items-center">
                                            <span id="best-volume-value" class="text-sm font-semibold text-green-600 dark:text-green-400">0 T</span>
                                        </div>
                                    </div>
                                    
                                    <div class="flex items-center justify-between">
                                        <div>
                                            <p class="text-sm text-gray-500 dark:text-gray-400">Média Diária</p>
                                            <p id="best-daily-colhedora" class="font-medium text-gray-800 dark:text-white">-</p>
                                        </div>
                                        <div class="flex items-center">
                                            <span id="best-daily-value" class="text-sm font-semibold text-green-600 dark:text-green-400">0 T/dia</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Melhores culturas -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4">
                                <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-3">Desempenho por Cultura</h3>
                                
                                <div class="space-y-4">
                                    <div class="flex items-center justify-between pb-2 border-b border-gray-200 dark:border-gray-700">
                                        <div>
                                            <p class="text-sm text-gray-500 dark:text-gray-400">Melhor Rendimento</p>
                                            <p id="best-yield-cultura" class="font-medium text-gray-800 dark:text-white">-</p>
                                        </div>
                                        <div class="flex items-center">
                                            <span id="best-yield-cultura-value" class="text-sm font-semibold text-green-600 dark:text-green-400">0 T/h</span>
                                        </div>
                                    </div>
                                    
                                    <div class="flex items-center justify-between pb-2 border-b border-gray-200 dark:border-gray-700">
                                        <div>
                                            <p class="text-sm text-gray-500 dark:text-gray-400">Maior Volume</p>
                                            <p id="best-volume-cultura" class="font-medium text-gray-800 dark:text-white">-</p>
                                        </div>
                                        <div class="flex items-center">
                                            <span id="best-volume-cultura-value" class="text-sm font-semibold text-green-600 dark:text-green-400">0 T</span>
                                        </div>
                                    </div>
                                    
                                    <div class="flex items-center justify-between">
                                        <div>
                                            <p class="text-sm text-gray-500 dark:text-gray-400">Média Diária</p>
                                            <p id="best-daily-cultura" class="font-medium text-gray-800 dark:text-white">-</p>
                                        </div>
                                        <div class="flex items-center">
                                            <span id="best-daily-cultura-value" class="text-sm font-semibold text-blue-600 dark:text-blue-400">0 T/dia</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Distribuição por cultura -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4">
                                <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-3">Distribuição por Cultura</h3>
                                <div class="h-48">
                                    <canvas id="chart-culturas"></canvas>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Gráficos principais -->
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <!-- Comparativo de colhedoras -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4">
                                <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-3">Comparativo de Colhedoras</h3>
                                <div class="h-64">
                                    <canvas id="chart-colhedoras-comparacao"></canvas>
                                </div>
                            </div>
                            
                            <!-- Produção ao longo do tempo -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4">
                                <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-3">Produção ao Longo do Tempo</h3>
                                <div class="h-64">
                                    <canvas id="chart-producao-tempo"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Conteúdo da tab "Caminhões e Logística" -->
                    <div id="tab-caminhoes" class="dashboard-tab-content hidden">
                        <!-- Cards de indicadores -->
                        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
                            <!-- Total de caminhões -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <h3 class="text-sm font-medium text-gray-500 dark:text-gray-400">Total de Caminhões</h3>
                                        <div class="flex items-baseline mt-1">
                                            <span id="dash-total-caminhoes" class="text-2xl font-semibold text-gray-900 dark:text-white">0</span>
                                        </div>
                                    </div>
                                    <div class="p-2 bg-primary-50 dark:bg-primary-900/30 rounded-lg">
                                        <i class="fas fa-truck text-xl text-primary-600 dark:text-primary-400"></i>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Tempo médio de campo -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <h3 class="text-sm font-medium text-gray-500 dark:text-gray-400">Tempo Médio de Campo</h3>
                                        <div class="flex items-baseline mt-1">
                                            <span id="dash-tempo-campo" class="text-2xl font-semibold text-gray-900 dark:text-white">0 min</span>
                                        </div>
                                    </div>
                                    <div class="p-2 bg-primary-50 dark:bg-primary-900/30 rounded-lg">
                                        <i class="fas fa-stopwatch text-xl text-primary-600 dark:text-primary-400"></i>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Tempo médio de pátio -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <h3 class="text-sm font-medium text-gray-500 dark:text-gray-400">Tempo Médio de Pátio</h3>
                                        <div class="flex items-baseline mt-1">
                                            <span id="dash-tempo-patio" class="text-2xl font-semibold text-gray-900 dark:text-white">0 min</span>
                                        </div>
                                    </div>
                                    <div class="p-2 bg-primary-50 dark:bg-primary-900/30 rounded-lg">
                                        <i class="fas fa-warehouse text-xl text-primary-600 dark:text-primary-400"></i>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Produção transportada -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <h3 class="text-sm font-medium text-gray-500 dark:text-gray-400">Produção Transportada</h3>
                                        <div class="flex items-baseline mt-1">
                                            <span id="dash-producao-transportada" class="text-2xl font-semibold text-gray-900 dark:text-white">0 T</span>
                                        </div>
                                    </div>
                                    <div class="p-2 bg-primary-50 dark:bg-primary-900/30 rounded-lg">
                                        <i class="fas fa-shipping-fast text-xl text-primary-600 dark:text-primary-400"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Gráficos -->
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                            <!-- Produção por tipo de caminhão -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4">
                                <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-3">Produção por Tipo</h3>
                                <div class="h-64">
                                    <canvas id="chart-caminhoes-tipo"></canvas>
                                </div>
                            </div>
                            
                            <!-- Tempo médio por caminhão -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4">
                                <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-3">Tempo Médio por Caminhão</h3>
                                <div class="h-64">
                                    <canvas id="chart-caminhoes-tempo"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Conteúdo da tab "Paradas por Chuva" -->
                    <div id="tab-chuvas" class="dashboard-tab-content hidden">
                        <!-- Cards de indicadores -->
                        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
                            <!-- Total de dias parados -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <h3 class="text-sm font-medium text-gray-500 dark:text-gray-400">Total de Dias Parados</h3>
                                        <div class="flex items-baseline mt-1">
                                            <span id="dash-total-dias-parados" class="text-2xl font-semibold text-gray-900 dark:text-white">0 dias</span>
                                        </div>
                                    </div>
                                    <div class="p-2 bg-primary-50 dark:bg-primary-900/30 rounded-lg">
                                        <i class="fas fa-cloud-rain text-xl text-primary-600 dark:text-primary-400"></i>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Impacto estimado -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <h3 class="text-sm font-medium text-gray-500 dark:text-gray-400">Impacto Estimado</h3>
                                        <div class="flex items-baseline mt-1">
                                            <span id="dash-impacto-estimado" class="text-2xl font-semibold text-gray-900 dark:text-white">0 T</span>
                                        </div>
                                    </div>
                                    <div class="p-2 bg-primary-50 dark:bg-primary-900/30 rounded-lg">
                                        <i class="fas fa-chart-line text-xl text-primary-600 dark:text-primary-400"></i>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Última parada -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <h3 class="text-sm font-medium text-gray-500 dark:text-gray-400">Última Parada</h3>
                                        <div class="flex items-baseline mt-1">
                                            <span id="dash-ultima-parada" class="text-2xl font-semibold text-gray-900 dark:text-white">--/--/----</span>
                                        </div>
                                    </div>
                                    <div class="p-2 bg-primary-50 dark:bg-primary-900/30 rounded-lg">
                                        <i class="fas fa-calendar-alt text-xl text-primary-600 dark:text-primary-400"></i>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Total de registros -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <h3 class="text-sm font-medium text-gray-500 dark:text-gray-400">Total de Registros</h3>
                                        <div class="flex items-baseline mt-1">
                                            <span id="dash-total-registros-chuva" class="text-2xl font-semibold text-gray-900 dark:text-white">0</span>
                                        </div>
                                    </div>
                                    <div class="p-2 bg-primary-50 dark:bg-primary-900/30 rounded-lg">
                                        <i class="fas fa-list-alt text-xl text-primary-600 dark:text-primary-400"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Gráficos -->
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                            <!-- Dias parados por mês -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4">
                                <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-3">Dias Parados por Mês</h3>
                                <div class="h-64">
                                    <canvas id="chart-paradas-mes"></canvas>
                                </div>
                            </div>
                            
                            <!-- Distribuição por intensidade -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4">
                                <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-3">Distribuição por Intensidade</h3>
                                <div class="h-64">
                                    <canvas id="chart-paradas-intensidade"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Conteúdo da tab "Consumo de Óleos" -->
                    <div id="tab-consumos" class="dashboard-tab-content hidden">
                        <!-- Conteúdo de Consumo de Óleos -->
                        <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-3">Consumo de Combustíveis e Óleos</h3>
                        <p class="text-gray-600 dark:text-gray-400 mb-4">Resumo do consumo de óleo diesel e óleo hidráulico por equipamento.</p>
                        
                        <!-- Cards de indicadores -->
                        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
                            <!-- Total de diesel -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <h3 class="text-sm font-medium text-gray-500 dark:text-gray-400">Total Diesel</h3>
                                        <div class="flex items-baseline mt-1">
                                            <span id="total-diesel" class="text-2xl font-semibold text-gray-900 dark:text-white">0 L</span>
                                        </div>
                                    </div>
                                    <div class="p-2 bg-primary-50 dark:bg-primary-900/30 rounded-lg">
                                        <i class="fas fa-gas-pump text-xl text-yellow-600 dark:text-yellow-400"></i>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Total de óleo hidráulico -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <h3 class="text-sm font-medium text-gray-500 dark:text-gray-400">Total Hidráulico</h3>
                                        <div class="flex items-baseline mt-1">
                                            <span id="total-hidraulico" class="text-2xl font-semibold text-gray-900 dark:text-white">0 L</span>
                                        </div>
                                    </div>
                                    <div class="p-2 bg-primary-50 dark:bg-primary-900/30 rounded-lg">
                                        <i class="fas fa-oil-can text-xl text-green-600 dark:text-green-400"></i>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Consumo médio L/h -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <h3 class="text-sm font-medium text-gray-500 dark:text-gray-400">Consumo Médio</h3>
                                        <div class="flex items-baseline mt-1">
                                            <span id="consumo-medio-litro-hora" class="text-2xl font-semibold text-gray-900 dark:text-white">0 L/h</span>
                                        </div>
                                    </div>
                                    <div class="p-2 bg-primary-50 dark:bg-primary-900/30 rounded-lg">
                                        <i class="fas fa-tachometer-alt text-xl text-blue-600 dark:text-blue-400"></i>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Total de registros -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <h3 class="text-sm font-medium text-gray-500 dark:text-gray-400">Abastecimentos</h3>
                                        <div class="flex items-baseline mt-1">
                                            <span id="total-abastecimentos" class="text-2xl font-semibold text-gray-900 dark:text-white">0</span>
                                        </div>
                                    </div>
                                    <div class="p-2 bg-primary-50 dark:bg-primary-900/30 rounded-lg">
                                        <i class="fas fa-clipboard-list text-xl text-primary-600 dark:text-primary-400"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Gráfico de consumo -->
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                            <!-- Gráfico de consumo por equipamento -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4">
                                <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-3">Consumo por Equipamento</h3>
                                <div class="h-64">
                                    <canvas id="chart-consumo-equipamento"></canvas>
                                </div>
                            </div>
                            
                            <!-- Gráfico de evolução temporal -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4">
                                <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-3">Evolução do Consumo</h3>
                                <div class="h-64">
                                    <canvas id="chart-evolucao-consumo"></canvas>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Tabela de equipamentos e seu consumo -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 mb-6">
                            <div class="flex justify-between mb-3">
                                <h3 class="text-lg font-semibold text-gray-800 dark:text-white">Consumo por Equipamento</h3>
                                <button id="btn-export-consumo" class="inline-flex items-center px-3 py-1 bg-green-600 hover:bg-green-700 text-white text-sm font-medium rounded-lg">
                                    <i class="fas fa-file-export mr-1"></i> Exportar
                                </button>
                            </div>
                            <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                    <thead class="bg-gray-50 dark:bg-gray-700">
                                        <tr>
                                            <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Equipamento</th>
                                            <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Tipo</th>
                                            <th scope="col" class="px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Diesel (L)</th>
                                            <th scope="col" class="px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Hidráulico (L)</th>
                                            <th scope="col" class="px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Média (L/h)</th>
                                        </tr>
                                    </thead>
                                    <tbody id="tabela-consumo-equipamentos" class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                                        <!-- Dados serão preenchidos via JavaScript -->
                                        <tr>
                                            <td colspan="5" class="px-4 py-3 text-center text-gray-500 dark:text-gray-400">
                                                Carregando dados...
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Conteúdo da tab "Estatísticas Gerais" -->
                    <div id="tab-estatisticas" class="dashboard-tab-content hidden">
                        <!-- Estatísticas de produção -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 mb-6">
                            <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-3">Estatísticas de Produção</h3>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div class="bg-blue-50 dark:bg-blue-900/30 p-4 rounded-lg">
                                    <h4 class="text-sm font-medium text-gray-600 dark:text-gray-300">Total Colhido</h4>
                                    <div class="flex items-baseline mt-1">
                                        <span id="stats-total-colhido" class="text-xl font-bold text-blue-600 dark:text-blue-400">0 T</span>
                                    </div>
                                </div>
                                
                                <div class="bg-green-50 dark:bg-green-900/30 p-4 rounded-lg">
                                    <h4 class="text-sm font-medium text-gray-600 dark:text-gray-300">Rendimento Médio</h4>
                                    <div class="flex items-baseline mt-1">
                                        <span id="stats-rendimento-medio" class="text-xl font-bold text-green-600 dark:text-green-400">0 T/h</span>
                                    </div>
                                </div>
                                
                                <div class="bg-purple-50 dark:bg-purple-900/30 p-4 rounded-lg">
                                    <h4 class="text-sm font-medium text-gray-600 dark:text-gray-300">Registros Totais</h4>
                                    <div class="flex items-baseline mt-1">
                                        <span id="stats-registros-totais" class="text-xl font-bold text-purple-600 dark:text-purple-400">0</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Estatísticas de frota -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 mb-6">
                            <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-3">Estatísticas de Frota</h3>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div class="bg-yellow-50 dark:bg-yellow-900/30 p-4 rounded-lg">
                                    <h4 class="text-sm font-medium text-gray-600 dark:text-gray-300">Total de Caminhões</h4>
                                    <div class="flex items-baseline mt-1">
                                        <span id="stats-total-caminhoes" class="text-xl font-bold text-yellow-600 dark:text-yellow-400">0</span>
                                    </div>
                                </div>
                                
                                <div class="bg-red-50 dark:bg-red-900/30 p-4 rounded-lg">
                                    <h4 class="text-sm font-medium text-gray-600 dark:text-gray-300">Tempo Médio Total</h4>
                                    <div class="flex items-baseline mt-1">
                                        <span id="stats-tempo-medio-total" class="text-xl font-bold text-red-600 dark:text-red-400">0 min</span>
                                    </div>
                                </div>
                                
                                <div class="bg-indigo-50 dark:bg-indigo-900/30 p-4 rounded-lg">
                                    <h4 class="text-sm font-medium text-gray-600 dark:text-gray-300">Viagens Registradas</h4>
                                    <div class="flex items-baseline mt-1">
                                        <span id="stats-viagens-registradas" class="text-xl font-bold text-indigo-600 dark:text-indigo-400">0</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Estatísticas de consumo -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 mb-6">
                            <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-3">Estatísticas de Consumo</h3>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div class="bg-amber-50 dark:bg-amber-900/30 p-4 rounded-lg">
                                    <h4 class="text-sm font-medium text-gray-600 dark:text-gray-300">Total Óleo Diesel</h4>
                                    <div class="flex items-baseline mt-1">
                                        <span id="stats-total-diesel" class="text-xl font-bold text-amber-600 dark:text-amber-400">0 L</span>
                                    </div>
                                </div>
                                
                                <div class="bg-emerald-50 dark:bg-emerald-900/30 p-4 rounded-lg">
                                    <h4 class="text-sm font-medium text-gray-600 dark:text-gray-300">Total Óleo Hidráulico</h4>
                                    <div class="flex items-baseline mt-1">
                                        <span id="stats-total-hidraulico" class="text-xl font-bold text-emerald-600 dark:text-emerald-400">0 L</span>
                                    </div>
                                </div>
                                
                                <div class="bg-cyan-50 dark:bg-cyan-900/30 p-4 rounded-lg">
                                    <h4 class="text-sm font-medium text-gray-600 dark:text-gray-300">Eficiência (T/L)</h4>
                                    <div class="flex items-baseline mt-1">
                                        <span id="stats-eficiencia-litro" class="text-xl font-bold text-cyan-600 dark:text-cyan-400">0 T/L</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Conteúdo de Colhedoras -->
                <div id="content-colhedoras" class="content hidden">
                    <div class="mb-4">
                        <h2 class="text-xl font-bold text-gray-800 dark:text-white mb-2">Colhedoras</h2>
                        <p class="text-gray-600 dark:text-gray-400">Cadastro e gerenciamento de colhedoras</p>
                    </div>
                    
                    <!-- Formulário de cadastro de colhedora -->
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                        <div class="lg:col-span-1">
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4">
                                <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-3">Cadastrar Colhedora</h3>
                                
                                <form id="form-colhedora">
                                    <div class="mb-4">
                                        <label for="colhedora-id" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">ID da Colhedora</label>
                                        <input type="text" id="colhedora-id" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" placeholder="Ex: COL-001" required>
                                    </div>
                                    
                                    <div class="mb-4">
                                        <label for="colhedora-marca" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Marca</label>
                                        <input type="text" id="colhedora-marca" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" placeholder="Ex: John Deere">
                                    </div>
                                    
                                    <div class="mb-4">
                                        <label for="colhedora-modelo" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Modelo</label>
                                        <input type="text" id="colhedora-modelo" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" placeholder="Ex: 9670 STS">
                                    </div>
                                    
                                    <div class="mb-4">
                                        <label for="colhedora-ano" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Ano</label>
                                        <input type="number" id="colhedora-ano" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" placeholder="Ex: 2021">
                                    </div>
                                    
                                    <div class="mb-4">
                                        <label for="colhedora-observacoes" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Observações</label>
                                        <textarea id="colhedora-observacoes" rows="3" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" placeholder="Observações adicionais..."></textarea>
                                    </div>
                                    
                                    <div class="flex items-center space-x-2">
                                        <button type="submit" class="inline-flex items-center px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white font-medium rounded-lg text-sm">
                                            <i class="fas fa-save mr-2"></i> Salvar Colhedora
                                        </button>
                                        <button type="reset" class="inline-flex items-center px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-700 dark:bg-gray-700 dark:hover:bg-gray-600 dark:text-white font-medium rounded-lg text-sm">
                                            <i class="fas fa-times mr-2"></i> Cancelar
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                        
                        <div class="lg:col-span-2">
                            <!-- Lista de colhedoras -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4">
                                <div class="flex justify-between mb-3">
                                    <h3 class="text-lg font-semibold text-gray-800 dark:text-white">Colhedoras Cadastradas</h3>
                                    <div class="flex space-x-2">
                                        <button id="btn-add-colhedora" class="inline-flex items-center px-3 py-1 bg-primary-600 hover:bg-primary-700 text-white text-sm font-medium rounded-lg">
                                            <i class="fas fa-plus mr-1"></i> Nova Colhedora
                                        </button>
                                        <button id="btn-export-colhedoras" class="inline-flex items-center px-3 py-1 bg-green-600 hover:bg-green-700 text-white text-sm font-medium rounded-lg">
                                            <i class="fas fa-file-export mr-1"></i> Exportar
                                        </button>
                                    </div>
                                </div>
                                
                                <div class="overflow-x-auto">
                                    <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                        <thead class="bg-gray-50 dark:bg-gray-700">
                                            <tr>
                                                <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">ID</th>
                                                <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Marca</th>
                                                <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Modelo</th>
                                                <th scope="col" class="px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Ano</th>
                                                <th scope="col" class="px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Ações</th>
                                            </tr>
                                        </thead>
                                        <tbody id="tabela-colhedoras" class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                                            <!-- Dados serão preenchidos via JavaScript -->
                                            <tr>
                                                <td colspan="5" class="px-4 py-3 text-center text-gray-500 dark:text-gray-400">
                                                    Carregando colhedoras...
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Conteúdo de Registros de Produção -->
                <div id="content-registros" class="content hidden">
                    <div class="mb-4">
                        <h2 class="text-xl font-bold text-gray-800 dark:text-white mb-2">Registrar Produção</h2>
                        <p class="text-gray-600 dark:text-gray-400">Registro de produção diária das colhedoras</p>
                    </div>
                    
                    <!-- Grid de conteúdo -->
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                        <!-- Formulário de registro -->
                        <div class="lg:col-span-1">
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4">
                                <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-3">Novo Registro</h3>
                                
                                <form id="form-registro">
                                    <div class="mb-4">
                                        <label for="registro-data" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Data</label>
                                        <input type="date" id="registro-data" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" required>
                                    </div>
                                    
                                    <div class="mb-4">
                                        <label for="registro-colhedora" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Colhedora</label>
                                        <select id="registro-colhedora" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" required>
                                            <option value="">Selecione uma colhedora</option>
                                        </select>
                                    </div>
                                    
                                    <div class="mb-4">
                                        <label for="registro-cultura" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Cultura</label>
                                        <select id="registro-cultura" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" required>
                                            <option value="">Selecione uma cultura</option>
                                            <option value="Soja">Soja</option>
                                            <option value="Milho">Milho</option>
                                            <option value="Trigo">Trigo</option>
                                            <option value="Algodão">Algodão</option>
                                            <option value="Feijão">Feijão</option>
                                            <option value="Arroz">Arroz</option>
                                            <option value="Cana-de-açúcar">Cana-de-açúcar</option>
                                            <option value="Sorgo">Sorgo</option>
                                            <option value="Outra">Outra</option>
                                        </select>
                                    </div>
                                    
                                    <div class="mb-4">
                                        <label for="registro-quantidade" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Quantidade (T)</label>
                                        <input type="number" step="0.1" id="registro-quantidade" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" placeholder="Ex: 145.5" required>
                                    </div>
                                    
                                    <div class="mb-4">
                                        <label for="registro-horas" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Horas Trabalhadas</label>
                                        <input type="number" step="0.5" id="registro-horas" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" placeholder="Ex: 8.5" required>
                                    </div>
                                    
                                    <div class="mb-4">
                                        <label for="registro-combustivel" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Consumo de Combustível (L)</label>
                                        <input type="number" step="1" id="registro-combustivel" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" placeholder="Ex: 120">
                                    </div>
                                    
                                    <div class="mb-4">
                                        <label for="registro-observacoes" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Observações</label>
                                        <textarea id="registro-observacoes" rows="2" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" placeholder="Observações adicionais..."></textarea>
                                    </div>
                                    
                                    <div class="flex items-center space-x-2">
                                        <button type="submit" class="inline-flex items-center px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white font-medium rounded-lg text-sm">
                                            <i class="fas fa-save mr-2"></i> Registrar Produção
                                        </button>
                                        <button type="reset" class="inline-flex items-center px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-700 dark:bg-gray-700 dark:hover:bg-gray-600 dark:text-white font-medium rounded-lg text-sm">
                                            <i class="fas fa-times mr-2"></i> Cancelar
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                        
                        <!-- Informações de produção -->
                        <div class="lg:col-span-2">
                            <!-- Cards de estatísticas -->
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                                <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4">
                                    <div class="flex justify-between items-start">
                                        <div>
                                            <h3 class="text-sm font-medium text-gray-500 dark:text-gray-400">Total Colhido</h3>
                                            <div class="flex items-baseline mt-1">
                                                <span id="total-colhido" class="text-2xl font-semibold text-gray-900 dark:text-white">0 T</span>
                                            </div>
                                        </div>
                                        <div class="p-2 bg-primary-50 dark:bg-primary-900/30 rounded-lg">
                                            <i class="fas fa-weight-hanging text-xl text-primary-600 dark:text-primary-400"></i>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4">
                                    <div class="flex justify-between items-start">
                                        <div>
                                            <h3 class="text-sm font-medium text-gray-500 dark:text-gray-400">Rendimento Médio</h3>
                                            <div class="flex items-baseline mt-1">
                                                <span id="rendimento-medio" class="text-2xl font-semibold text-gray-900 dark:text-white">0 T/h</span>
                                            </div>
                                        </div>
                                        <div class="p-2 bg-primary-50 dark:bg-primary-900/30 rounded-lg">
                                            <i class="fas fa-tachometer-alt text-xl text-primary-600 dark:text-primary-400"></i>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4">
                                    <div class="flex justify-between items-start">
                                        <div>
                                            <h3 class="text-sm font-medium text-gray-500 dark:text-gray-400">Paradas por Chuva</h3>
                                            <div class="flex items-baseline mt-1">
                                                <span id="paradas-chuva-total" class="text-2xl font-semibold text-gray-900 dark:text-white">0 dias</span>
                                            </div>
                                        </div>
                                        <div class="p-2 bg-primary-50 dark:bg-primary-900/30 rounded-lg">
                                            <i class="fas fa-cloud-rain text-xl text-primary-600 dark:text-primary-400"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Tabela de produção por colhedora -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4">
                                <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-3">Produção por Colhedora</h3>
                                <div class="overflow-x-auto">
                                    <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                        <thead class="bg-gray-50 dark:bg-gray-700">
                                            <tr>
                                                <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Colhedora</th>
                                                <th scope="col" class="px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Quantidade (T)</th>
                                                <th scope="col" class="px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Rend. (T/h)</th>
                                            </tr>
                                        </thead>
                                        <tbody id="tabela-producao-colhedoras" class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                                            <!-- Dados serão preenchidos via JavaScript -->
                                            <tr>
                                                <td colspan="3" class="px-4 py-3 text-center text-gray-500 dark:text-gray-400">
                                                    Nenhum registro encontrado
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Conteúdo de Liberações -->
                <div id="content-liberacoes" class="content hidden">
                    <div class="mb-4">
                        <h2 class="text-xl font-bold text-gray-800 dark:text-white mb-2">Liberações</h2>
                        <p class="text-gray-600 dark:text-gray-400">Gerenciamento de liberações de produção</p>
                    </div>
                    
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                        <!-- Formulário de liberação -->
                        <div class="lg:col-span-1">
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4">
                                <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-3">Registrar Liberação</h3>
                                
                                <form id="form-liberacao">
                                    <div class="mb-4">
                                        <label class="block text-gray-700 dark:text-gray-300 mb-1 text-sm font-medium" for="liberacao-frente">
                                            Frente *
                                        </label>
                                        <input type="text" id="liberacao-frente" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" placeholder="Ex: Frente 01" required>
                                    </div>
                                    
                                    <div class="mb-4">
                                        <label class="block text-gray-700 dark:text-gray-300 mb-1 text-sm font-medium" for="liberacao-fazenda">
                                            Fazenda *
                                        </label>
                                        <input type="text" id="liberacao-fazenda" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" placeholder="Ex: Fazenda São João" required>
                                    </div>
                                    
                                    <div class="mb-4">
                                        <label class="block text-gray-700 dark:text-gray-300 mb-1 text-sm font-medium" for="liberacao-numero">
                                            Número da Liberação
                                        </label>
                                        <input type="text" id="liberacao-numero" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" placeholder="Ex: LIB-2025-001">
                                    </div>
                                    
                                    <div class="mb-4">
                                        <label class="block text-gray-700 dark:text-gray-300 mb-1 text-sm font-medium" for="liberacao-previsto">
                                            Previsto (T) *
                                        </label>
                                        <input type="number" step="0.01" id="liberacao-previsto" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" placeholder="Ex: 1000" required>
                                    </div>
                                    
                                    <div class="mb-4">
                                        <label class="block text-gray-700 dark:text-gray-300 mb-1 text-sm font-medium" for="liberacao-realizado">
                                            Realizado (T) *
                                        </label>
                                        <input type="number" step="0.01" id="liberacao-realizado" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" placeholder="Ex: 850" required>
                                    </div>
                                    
                                    <div class="mb-4">
                                        <label class="block text-gray-700 dark:text-gray-300 mb-1 text-sm font-medium" for="liberacao-data">
                                            Data *
                                        </label>
                                        <input type="date" id="liberacao-data" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" required>
                                    </div>
                                    
                                    <div class="mb-4">
                                        <label class="block text-gray-700 dark:text-gray-300 mb-1 text-sm font-medium" for="liberacao-observacoes">
                                            Observações
                                        </label>
                                        <textarea id="liberacao-observacoes" rows="2" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" placeholder="Observações adicionais"></textarea>
                                    </div>
                                    
                                    <div class="flex items-center space-x-2">
                                        <button type="submit" class="inline-flex items-center px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white font-medium rounded-lg text-sm">
                                            <i class="fas fa-save mr-2"></i> Registrar Liberação
                                        </button>
                                        <button type="reset" class="inline-flex items-center px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-700 dark:bg-gray-700 dark:hover:bg-gray-600 dark:text-white font-medium rounded-lg text-sm">
                                            <i class="fas fa-times mr-2"></i> Cancelar
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                        
                        <!-- Resumo e tabela -->
                        <div class="lg:col-span-2">
                            <!-- Filtros e resumo -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 mb-6">
                                <div class="flex justify-between mb-3">
                                    <h3 class="text-lg font-semibold text-gray-800 dark:text-white">Filtros</h3>
                                    <button id="btn-export-liberacoes" class="inline-flex items-center px-3 py-1 bg-green-600 hover:bg-green-700 text-white text-sm font-medium rounded-lg">
                                        <i class="fas fa-file-export mr-1"></i> Exportar Dados
                                    </button>
                                </div>
                                
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                                    <div>
                                        <label class="block text-gray-700 dark:text-gray-300 mb-1 text-sm font-medium" for="filtro-liberacao-frente">
                                            Frente
                                        </label>
                                        <select id="filtro-liberacao-frente" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500">
                                            <option value="">Todas</option>
                                            <!-- Opções carregadas dinamicamente -->
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-gray-700 dark:text-gray-300 mb-1 text-sm font-medium" for="filtro-liberacao-fazenda">
                                            Fazenda
                                        </label>
                                        <select id="filtro-liberacao-fazenda" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500">
                                            <option value="">Todas</option>
                                            <!-- Opções carregadas dinamicamente -->
                                        </select>
                                    </div>
                                </div>
                                
                                <!-- Resumo -->
                                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-4">
                                    <div class="bg-gray-50 dark:bg-gray-900/30 p-3 rounded-lg">
                                        <div class="text-center">
                                            <span class="text-sm text-gray-500 dark:text-gray-400">Total Previsto</span>
                                            <p id="resumo-total-previsto" class="text-xl font-bold text-gray-800 dark:text-white">0</p>
                                        </div>
                                    </div>
                                    <div class="bg-gray-50 dark:bg-gray-900/30 p-3 rounded-lg">
                                        <div class="text-center">
                                            <span class="text-sm text-gray-500 dark:text-gray-400">Total Realizado</span>
                                            <p id="resumo-total-realizado" class="text-xl font-bold text-green-600 dark:text-green-400">0</p>
                                        </div>
                                    </div>
                                    <div class="bg-gray-50 dark:bg-gray-900/30 p-3 rounded-lg">
                                        <div class="text-center">
                                            <span class="text-sm text-gray-500 dark:text-gray-400">Restante</span>
                                            <p id="resumo-total-restante" class="text-xl font-bold text-red-600 dark:text-red-400">0</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Tabela de liberações -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4">
                                <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-3">Liberações</h3>
                                <div class="overflow-x-auto">
                                    <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                        <thead class="bg-gray-50 dark:bg-gray-700">
                                            <tr>
                                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Frente</th>
                                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Fazenda</th>
                                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Nº Liberação</th>
                                                <th class="px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Previsto</th>
                                                <th class="px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Realizado</th>
                                                <th class="px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Restante</th>
                                                <th class="px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Progresso</th>
                                                <th class="px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Ações</th>
                                            </tr>
                                        </thead>
                                        <tbody id="tabela-liberacoes" class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                                            <!-- Os dados serão carregados dinamicamente -->
                                            <tr>
                                                <td colspan="8" class="px-4 py-3 text-center text-gray-500 dark:text-gray-400">
                                                    Carregando liberações...
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Conteúdo de Consumo de Óleos -->
                <div id="content-consumos" class="content hidden">
                    <div class="mb-4">
                        <h2 class="text-xl font-bold text-gray-800 dark:text-white mb-2">Consumo de Óleos</h2>
                        <p class="text-gray-600 dark:text-gray-400">Registro e acompanhamento de consumo de óleos por equipamento</p>
                    </div>
                    
                    <!-- Grid de conteúdo -->
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                        <!-- Formulário de registro -->
                        <div class="lg:col-span-1">
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4">
                                <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-3">Registrar Consumo</h3>
                                
                                <form id="form-consumo">
                                    <div class="mb-4">
                                        <label for="consumo-data" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Data</label>
                                        <input type="date" id="consumo-data" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" required>
                                    </div>
                                    
                                    <div class="mb-4">
                                        <label for="consumo-tipo-equipamento" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Tipo de Equipamento</label>
                                        <select id="consumo-tipo-equipamento" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" required>
                                            <option value="">Selecione o tipo</option>
                                            <option value="colhedora">Colhedora</option>
                                            <option value="caminhao">Caminhão</option>
                                        </select>
                                    </div>
                                    
                                    <div class="mb-4">
                                        <label for="consumo-equipamento" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Equipamento</label>
                                        <select id="consumo-equipamento" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" required disabled>
                                            <option value="">Selecione o equipamento</option>
                                        </select>
                                    </div>
                                    
                                    <div class="mb-4">
                                        <label for="consumo-tipo-oleo" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Tipo de Óleo</label>
                                        <select id="consumo-tipo-oleo" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" required>
                                            <option value="">Selecione o tipo</option>
                                            <option value="diesel">Óleo Diesel</option>
                                            <option value="hidraulico">Óleo Hidráulico</option>
                                        </select>
                                    </div>
                                    
                                    <div class="mb-4">
                                        <label for="consumo-quantidade" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Quantidade (Litros)</label>
                                        <input type="number" step="0.1" id="consumo-quantidade" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" placeholder="Ex: 120.5" required>
                                    </div>
                                    
                                    <div class="mb-4">
                                        <label for="consumo-horimetro" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Horímetro/Hodômetro</label>
                                        <input type="number" step="0.1" id="consumo-horimetro" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" placeholder="Leitura atual">
                                    </div>
                                    
                                    <div class="mb-4">
                                        <label for="consumo-observacoes" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Observações</label>
                                        <textarea id="consumo-observacoes" rows="2" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" placeholder="Observações adicionais..."></textarea>
                                    </div>
                                    
                                    <div class="flex items-center space-x-2">
                                        <button type="submit" class="inline-flex items-center px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white font-medium rounded-lg text-sm">
                                            <i class="fas fa-save mr-2"></i> Registrar Consumo
                                        </button>
                                        <button type="reset" class="inline-flex items-center px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-700 dark:bg-gray-700 dark:hover:bg-gray-600 dark:text-white font-medium rounded-lg text-sm">
                                            <i class="fas fa-times mr-2"></i> Cancelar
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                        
                        <!-- Resumo e estatísticas -->
                        <div class="lg:col-span-2">
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 mb-6">
                                <div class="flex justify-between mb-3">
                                    <h3 class="text-lg font-semibold text-gray-800 dark:text-white">Resumo de Consumo</h3>
                                    <button id="btn-export-consumo-historico" class="inline-flex items-center px-3 py-1 bg-green-600 hover:bg-green-700 text-white text-sm font-medium rounded-lg">
                                        <i class="fas fa-file-export mr-1"></i> Exportar
                                    </button>
                                </div>
                                
                                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-4">
                                    <div class="bg-yellow-50 dark:bg-yellow-900/30 p-4 rounded-lg">
                                        <h4 class="text-sm font-medium text-gray-600 dark:text-gray-300">Total Óleo Diesel</h4>
                                        <div class="flex items-baseline mt-1">
                                            <span id="resumo-total-diesel" class="text-xl font-bold text-yellow-600 dark:text-yellow-400">0 L</span>
                                        </div>
                                    </div>
                                    
                                    <div class="bg-green-50 dark:bg-green-900/30 p-4 rounded-lg">
                                        <h4 class="text-sm font-medium text-gray-600 dark:text-gray-300">Total Óleo Hidráulico</h4>
                                        <div class="flex items-baseline mt-1">
                                            <span id="resumo-total-hidraulico" class="text-xl font-bold text-green-600 dark:text-green-400">0 L</span>
                                        </div>
                                    </div>
                                    
                                    <div class="bg-blue-50 dark:bg-blue-900/30 p-4 rounded-lg">
                                        <h4 class="text-sm font-medium text-gray-600 dark:text-gray-300">Consumo Médio</h4>
                                        <div class="flex items-baseline mt-1">
                                            <span id="resumo-media-consumo" class="text-xl font-bold text-blue-600 dark:text-blue-400">0 L/h</span>
                                        </div>
                                    </div>
                                    
                                    <div class="bg-purple-50 dark:bg-purple-900/30 p-4 rounded-lg">
                                        <h4 class="text-sm font-medium text-gray-600 dark:text-gray-300">Total Abastecimentos</h4>
                                        <div class="flex items-baseline mt-1">
                                            <span id="resumo-total-abastecimentos" class="text-xl font-bold text-purple-600 dark:text-purple-400">0</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Tabela de histórico -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4">
                                <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-3">Histórico de Consumo</h3>
                                
                                <!-- Filtros -->
                                <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-4">
                                    <div>
                                        <label for="filtro-consumo-tipo" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Tipo de Óleo</label>
                                        <select id="filtro-consumo-tipo" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500">
                                            <option value="">Todos</option>
                                            <option value="diesel">Diesel</option>
                                            <option value="hidraulico">Hidráulico</option>
                                        </select>
                                    </div>
                                    
                                    <div>
                                        <label for="filtro-consumo-equipamento" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Equipamento</label>
                                        <select id="filtro-consumo-equipamento" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500">
                                            <option value="">Todos</option>
                                        </select>
                                    </div>
                                    
                                    <div>
                                        <label for="filtro-consumo-data-inicio" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Data Início</label>
                                        <input type="date" id="filtro-consumo-data-inicio" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500">
                                    </div>
                                    
                                    <div>
                                        <label for="filtro-consumo-data-fim" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Data Fim</label>
                                        <input type="date" id="filtro-consumo-data-fim" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500">
                                    </div>
                                </div>
                                
                                <div class="flex justify-end mb-4 space-x-2">
                                    <button id="btn-limpar-filtros-consumo" class="inline-flex items-center px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-700 dark:bg-gray-700 dark:hover:bg-gray-600 dark:text-white font-medium rounded-lg text-sm">
                                        <i class="fas fa-eraser mr-2"></i> Limpar Filtros
                                    </button>
                                    <button id="btn-aplicar-filtros-consumo" class="inline-flex items-center px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white font-medium rounded-lg text-sm">
                                        <i class="fas fa-filter mr-2"></i> Aplicar Filtros
                                    </button>
                                </div>
                                
                                <div class="overflow-x-auto">
                                    <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                        <thead class="bg-gray-50 dark:bg-gray-700">
                                            <tr>
                                                <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Data</th>
                                                <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Equipamento</th>
                                                <th scope="col" class="px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Tipo</th>
                                                <th scope="col" class="px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Quantidade</th>
                                                <th scope="col" class="px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Horímetro</th>
                                                <th scope="col" class="px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Ações</th>
                                            </tr>
                                        </thead>
                                        <tbody id="tabela-historico-consumo" class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                                            <!-- Dados serão preenchidos via JavaScript -->
                                            <tr>
                                                <td colspan="6" class="px-4 py-3 text-center text-gray-500 dark:text-gray-400">
                                                    Nenhum registro encontrado
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Conteúdo de Histórico -->
                <div id="content-historico" class="content hidden">
                    <div class="mb-4">
                        <h2 class="text-xl font-bold text-gray-800 dark:text-white mb-2">Histórico</h2>
                        <p class="text-gray-600 dark:text-gray-400">Histórico completo de registros de produção</p>
                    </div>
                    
                    <!-- Filtros -->
                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 mb-6">
                        <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-3">Filtros</h3>
                        
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-4">
                            <div>
                                <label for="filtro-colhedora" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Colhedora</label>
                                <select id="filtro-colhedora" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500">
                                    <option value="">Todas</option>
                                </select>
                            </div>
                            
                            <div>
                                <label for="filtro-cultura" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Cultura</label>
                                <select id="filtro-cultura" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500">
                                    <option value="">Todas</option>
                                </select>
                            </div>
                            
                            <div>
                                <label for="filtro-data-inicio" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Data Início</label>
                                <input type="date" id="filtro-data-inicio" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500">
                            </div>
                            
                            <div>
                                <label for="filtro-data-fim" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Data Fim</label>
                                <input type="date" id="filtro-data-fim" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500">
                            </div>
                        </div>
                        
                        <div class="flex justify-end space-x-2">
                            <button id="btn-limpar-filtros" class="inline-flex items-center px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-700 dark:bg-gray-700 dark:hover:bg-gray-600 dark:text-white font-medium rounded-lg text-sm">
                                <i class="fas fa-eraser mr-2"></i> Limpar Filtros
                            </button>
                            <button id="btn-aplicar-filtros" class="inline-flex items-center px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white font-medium rounded-lg text-sm">
                                <i class="fas fa-filter mr-2"></i> Aplicar Filtros
                            </button>
                        </div>
                    </div>
                    
                    <!-- Tabela de registros -->
                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4">
                        <div class="flex justify-between mb-3">
                            <h3 class="text-lg font-semibold text-gray-800 dark:text-white">Registros <span id="registros-contagem" class="text-sm text-gray-500 dark:text-gray-400 ml-2">(0)</span></h3>
                            <button id="btn-export-historico" class="inline-flex items-center px-3 py-1 bg-green-600 hover:bg-green-700 text-white text-sm font-medium rounded-lg">
                                <i class="fas fa-file-export mr-1"></i> Exportar
                            </button>
                        </div>
                        
                        <div class="overflow-x-auto">
                            <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                <thead class="bg-gray-50 dark:bg-gray-700">
                                    <tr>
                                        <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Data</th>
                                        <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Colhedora</th>
                                        <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Cultura</th>
                                        <th scope="col" class="px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Quantidade</th>
                                        <th scope="col" class="px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Horas</th>
                                        <th scope="col" class="px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Rendimento</th>
                                        <th scope="col" class="px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Ações</th>
                                    </tr>
                                </thead>
                                <tbody id="tabela-registros" class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                                    <!-- Dados serão preenchidos via JavaScript -->
                                    <tr>
                                        <td colspan="7" class="px-4 py-3 text-center text-gray-500 dark:text-gray-400">
                                            Nenhum registro encontrado
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <!-- Conteúdo de Chuvas -->
                <div id="content-chuvas" class="content hidden">
                    <div class="mb-4">
                        <h2 class="text-xl font-bold text-gray-800 dark:text-white mb-2">Registro de Chuvas</h2>
                        <p class="text-gray-600 dark:text-gray-400">Monitoramento de paradas por chuva e condições climáticas</p>
                    </div>
                    
                    <!-- Grid de conteúdo -->
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                        <!-- Formulário de registro -->
                        <div class="lg:col-span-1">
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4">
                                <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-3">Registrar Parada</h3>
                                
                                <form id="form-chuva">
                                    <div class="mb-4">
                                        <label for="chuva-data-inicio" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Data Início</label>
                                        <input type="date" id="chuva-data-inicio" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" required>
                                    </div>
                                    
                                    <div class="mb-4">
                                        <label for="chuva-data-fim" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Data Fim</label>
                                        <input type="date" id="chuva-data-fim" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" required>
                                    </div>
                                    
                                    <div class="mb-4">
                                        <label for="chuva-dias" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Dias Parados</label>
                                        <input type="number" step="0.5" id="chuva-dias" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" placeholder="Ex: 2.5" required>
                                    </div>
                                    
                                    <div class="mb-4">
                                        <label for="chuva-intensidade" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Intensidade</label>
                                        <select id="chuva-intensidade" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" required>
                                            <option value="">Selecione a intensidade</option>
                                            <option value="baixa">Baixa</option>
                                            <option value="media">Média</option>
                                            <option value="alta">Alta</option>
                                        </select>
                                    </div>
                                    
                                    <div class="mb-4">
                                        <label for="chuva-observacoes" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Observações</label>
                                        <textarea id="chuva-observacoes" rows="3" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" placeholder="Observações adicionais..."></textarea>
                                    </div>
                                    
                                    <div class="flex items-center space-x-2">
                                        <button type="submit" class="inline-flex items-center px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white font-medium rounded-lg text-sm">
                                            <i class="fas fa-save mr-2"></i> Registrar Parada
                                        </button>
                                        <button type="reset" class="inline-flex items-center px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-700 dark:bg-gray-700 dark:hover:bg-gray-600 dark:text-white font-medium rounded-lg text-sm">
                                            <i class="fas fa-times mr-2"></i> Cancelar
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                        
                        <!-- Informações de chuvas -->
                        <div class="lg:col-span-2">
                            <!-- Cards de estatísticas -->
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                                <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4">
                                    <div class="flex justify-between items-start">
                                        <div>
                                            <h3 class="text-sm font-medium text-gray-500 dark:text-gray-400">Total de Registros</h3>
                                            <div class="flex items-baseline mt-1">
                                                <span id="chuva-total-registros" class="text-2xl font-semibold text-gray-900 dark:text-white">0 registros</span>
                                            </div>
                                        </div>
                                        <div class="p-2 bg-primary-50 dark:bg-primary-900/30 rounded-lg">
                                            <i class="fas fa-list-alt text-xl text-primary-600 dark:text-primary-400"></i>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4">
                                    <div class="flex justify-between items-start">
                                        <div>
                                            <h3 class="text-sm font-medium text-gray-500 dark:text-gray-400">Total de Dias Parados</h3>
                                            <div class="flex items-baseline mt-1">
                                                <span id="chuva-total-dias" class="text-2xl font-semibold text-gray-900 dark:text-white">0 dias</span>
                                            </div>
                                        </div>
                                        <div class="p-2 bg-primary-50 dark:bg-primary-900/30 rounded-lg">
                                            <i class="fas fa-calendar-alt text-xl text-primary-600 dark:text-primary-400"></i>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4">
                                    <div class="flex justify-between items-start">
                                        <div>
                                            <h3 class="text-sm font-medium text-gray-500 dark:text-gray-400">Última Parada</h3>
                                            <div class="flex items-baseline mt-1">
                                                <span id="chuva-ultima-parada" class="text-2xl font-semibold text-gray-900 dark:text-white">--/--/----</span>
                                            </div>
                                        </div>
                                        <div class="p-2 bg-primary-50 dark:bg-primary-900/30 rounded-lg">
                                            <i class="fas fa-history text-xl text-primary-600 dark:text-primary-400"></i>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4">
                                    <div class="flex justify-between items-start">
                                        <div>
                                            <h3 class="text-sm font-medium text-gray-500 dark:text-gray-400">Impacto Estimado</h3>
                                            <div class="flex items-baseline mt-1">
                                                <span id="chuva-impacto-estimado" class="text-2xl font-semibold text-gray-900 dark:text-white">0 T</span>
                                            </div>
                                        </div>
                                        <div class="p-2 bg-primary-50 dark:bg-primary-900/30 rounded-lg">
                                            <i class="fas fa-chart-line text-xl text-primary-600 dark:text-primary-400"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Tabela de histórico de chuvas -->
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4">
                                <div class="flex justify-between mb-3">
                                    <h3 class="text-lg font-semibold text-gray-800 dark:text-white">Histórico de Paradas</h3>
                                    <button id="btn-export-chuvas" class="inline-flex items-center px-3 py-1 bg-green-600 hover:bg-green-700 text-white text-sm font-medium rounded-lg">
                                        <i class="fas fa-file-export mr-1"></i> Exportar
                                    </button>
                                </div>
                                
                                <div class="overflow-x-auto">
                                    <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                        <thead class="bg-gray-50 dark:bg-gray-700">
                                            <tr>
                                                <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Período</th>
                                                <th scope="col" class="px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Dias</th>
                                                <th scope="col" class="px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Intensidade</th>
                                                <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Observações</th>
                                                <th scope="col" class="px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Ações</th>
                                            </tr>
                                        </thead>
                                        <tbody id="tabela-chuvas" class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                                            <!-- Dados serão preenchidos via JavaScript -->
                                            <tr>
                                                <td colspan="5" class="px-4 py-3 text-center text-gray-500 dark:text-gray-400">
                                                    Nenhum registro encontrado
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Conteúdo de Caminhões -->
                <div id="content-caminhoes" class="content hidden">
                    <div class="mb-4">
                        <h2 class="text-xl font-bold text-gray-800 dark:text-white mb-2">Caminhões</h2>
                        <p class="text-gray-600 dark:text-gray-400">Gerenciamento de frota e logística</p>
                    </div>
                    
                    <!-- Tabs de caminhões -->
                    <div class="border-b border-gray-200 dark:border-gray-700 mb-4">
                        <div class="flex overflow-x-auto scrollbar-hide">
                            <button data-tab="cadastro" class="caminhoes-tab tab-active px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300">
                                Cadastro
                            </button>
                            <button data-tab="registros" class="caminhoes-tab px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300">
                                Registrar Viagem
                            </button>
                            <button data-tab="estatisticas" class="caminhoes-tab px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300">
                                Estatísticas
                            </button>
                        </div>
                    </div>
                    
                    <!-- Conteúdo da tab "Cadastro" -->
                    <div id="tab-cadastro" class="caminhoes-tab-content">
                        <!-- Botão para adicionar caminhão -->
                        <div class="mb-4 flex justify-end">
                            <button id="btn-add-new-caminhao" class="inline-flex items-center px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white font-medium rounded-lg text-sm">
                                <i class="fas fa-plus mr-2"></i> Novo Caminhão
                            </button>
                        </div>
                        
                        <!-- Card de cadastro (inicialmente escondido) -->
                        <div id="cadastro-caminhao-card" class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 mb-6 hidden">
                            <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-3">Cadastrar Caminhão</h3>
                            
                            <form id="form-cadastro-caminhao">
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div class="mb-4">
                                        <label for="cadastro-caminhao-id" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">ID do Caminhão</label>
                                        <input type="text" id="cadastro-caminhao-id" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" placeholder="Ex: CAM-001" required>
                                    </div>
                                    
                                    <div class="mb-4">
                                        <label for="cadastro-caminhao-placa" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Placa</label>
                                        <input type="text" id="cadastro-caminhao-placa" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" placeholder="Ex: ABC-1234" required>
                                    </div>
                                    
                                    <div class="mb-4">
                                        <label for="cadastro-caminhao-modelo" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Modelo</label>
                                        <input type="text" id="cadastro-caminhao-modelo" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" placeholder="Ex: Scania R 450">
                                    </div>
                                    
                                    <div class="mb-4">
                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Tipo</label>
                                        <div class="flex space-x-4">
                                            <div class="flex items-center">
                                                <input type="radio" id="tipo-proprio" name="tipo-caminhao" value="proprio" class="w-4 h-4 text-primary-600 bg-gray-100 border-gray-300 focus:ring-primary-500 dark:focus:ring-primary-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600" checked>
                                                <label for="tipo-proprio" class="ml-2 text-sm font-medium text-gray-900 dark:text-gray-300">Próprio</label>
                                            </div>
                                            <div class="flex items-center">
                                                <input type="radio" id="tipo-terceiro" name="tipo-caminhao" value="terceiro" class="w-4 h-4 text-primary-600 bg-gray-100 border-gray-300 focus:ring-primary-500 dark:focus:ring-primary-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600">
                                                <label for="tipo-terceiro" class="ml-2 text-sm font-medium text-gray-900 dark:text-gray-300">Terceiro</label>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="mb-4">
                                        <label for="cadastro-caminhao-capacidade" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Capacidade (T)</label>
                                        <input type="number" step="0.1" id="cadastro-caminhao-capacidade" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" placeholder="Ex: 28.5">
                                    </div>
                                    
                                    <div class="mb-4">
                                        <label for="cadastro-caminhao-motorista" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Motorista</label>
                                        <input type="text" id="cadastro-caminhao-motorista" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" placeholder="Nome do motorista">
                                    </div>
                                    
                                    <div class="mb-4 md:col-span-2">
                                        <label for="cadastro-caminhao-observacoes" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Observações</label>
                                        <textarea id="cadastro-caminhao-observacoes" rows="2" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" placeholder="Observações adicionais..."></textarea>
                                    </div>
                                </div>
                                
                                <div class="flex items-center space-x-2">
                                    <button type="submit" class="inline-flex items-center px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white font-medium rounded-lg text-sm">
                                        <i class="fas fa-save mr-2"></i> Cadastrar
                                    </button>
                                    <button type="button" id="btn-cancelar-cadastro-caminhao" class="inline-flex items-center px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-700 dark:bg-gray-700 dark:hover:bg-gray-600 dark:text-white font-medium rounded-lg text-sm">
                                        <i class="fas fa-times mr-2"></i> Cancelar
                                    </button>
                                </div>
                            </form>
                        </div>
                        
                        <!-- Tabela de caminhões -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4">
                            <div class="flex justify-between mb-3">
                                <h3 class="text-lg font-semibold text-gray-800 dark:text-white">Caminhões Cadastrados</h3>
                                <button id="btn-export-caminhoes" class="inline-flex items-center px-3 py-1 bg-green-600 hover:bg-green-700 text-white text-sm font-medium rounded-lg">
                                    <i class="fas fa-file-export mr-1"></i> Exportar
                                </button>
                            </div>
                            
                            <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                    <thead class="bg-gray-50 dark:bg-gray-700">
                                        <tr>
                                            <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">ID</th>
                                            <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Placa</th>
                                            <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Modelo</th>
                                            <th scope="col" class="px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Tipo</th>
                                            <th scope="col" class="px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Capacidade</th>
                                            <th scope="col" class="px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Ações</th>
                                        </tr>
                                    </thead>
                                    <tbody id="tabela-caminhoes" class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                                        <!-- Dados serão preenchidos via JavaScript -->
                                        <tr>
                                            <td colspan="6" class="px-4 py-3 text-center text-gray-500 dark:text-gray-400">
                                                Carregando caminhões...
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Conteúdo da tab "Registrar Viagem" -->
                    <div id="tab-registros" class="caminhoes-tab-content hidden">
                        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                            <!-- Formulário de registro -->
                            <div class="lg:col-span-1">
                                <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4">
                                    <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-3">Registrar Viagem</h3>
                                    
                                    <form id="form-caminhao">
                                        <div class="mb-4">
                                            <label for="caminhao-data" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Data</label>
                                            <input type="date" id="caminhao-data" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" required>
                                        </div>
                                        
                                        <div class="mb-4">
                                            <label for="caminhao-id" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Caminhão</label>
                                            <select id="caminhao-id" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" required>
                                                <option value="">Selecione um caminhão</option>
                                            </select>
                                        </div>
                                        
                                        <div class="mb-4">
                                            <label for="caminhao-cultura" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Cultura</label>
                                            <select id="caminhao-cultura" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" required>
                                                <option value="">Selecione uma cultura</option>
                                                <option value="Soja">Soja</option>
                                                <option value="Milho">Milho</option>
                                                <option value="Trigo">Trigo</option>
                                                <option value="Algodão">Algodão</option>
                                                <option value="Feijão">Feijão</option>
                                                <option value="Arroz">Arroz</option>
                                                <option value="Cana-de-açúcar">Cana-de-açúcar</option>
                                                <option value="Sorgo">Sorgo</option>
                                                <option value="Outra">Outra</option>
                                            </select>
                                        </div>
                                        
                                        <div class="mb-4">
                                            <label for="caminhao-producao" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Produção (T)</label>
                                            <input type="number" step="0.1" id="caminhao-producao" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" placeholder="Ex: 28.5" required>
                                        </div>
                                        
                                        <div class="mb-4">
                                            <label for="caminhao-tempo-campo" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Tempo Campo (min)</label>
                                            <input type="number" id="caminhao-tempo-campo" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" placeholder="Ex: 45" required>
                                        </div>
                                        
                                        <div class="mb-4">
                                            <label for="caminhao-tempo-patio" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Tempo Pátio (min)</label>
                                            <input type="number" id="caminhao-tempo-patio" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" placeholder="Ex: 30" required>
                                        </div>
                                        
                                        <div class="mb-4">
                                            <label for="caminhao-observacoes" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Observações</label>
                                            <textarea id="caminhao-observacoes" rows="2" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" placeholder="Observações adicionais..."></textarea>
                                        </div>
                                        
                                        <div class="flex items-center space-x-2">
                                            <button type="submit" class="inline-flex items-center px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white font-medium rounded-lg text-sm">
                                                <i class="fas fa-save mr-2"></i> Registrar Viagem
                                            </button>
                                            <button type="reset" class="inline-flex items-center px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-700 dark:bg-gray-700 dark:hover:bg-gray-600 dark:text-white font-medium rounded-lg text-sm">
                                                <i class="fas fa-times mr-2"></i> Cancelar
                                            </button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                            
                            <!-- Histórico de viagens -->
                            <div class="lg:col-span-2">
                                <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4">
                                    <div class="flex justify-between mb-3">
                                        <h3 class="text-lg font-semibold text-gray-800 dark:text-white">Histórico de Viagens</h3>
                                        <button id="btn-export-viagens" class="inline-flex items-center px-3 py-1 bg-green-600 hover:bg-green-700 text-white text-sm font-medium rounded-lg">
                                            <i class="fas fa-file-export mr-1"></i> Exportar
                                        </button>
                                    </div>
                                    
                                    <div class="overflow-x-auto">
                                        <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                            <thead class="bg-gray-50 dark:bg-gray-700">
                                                <tr>
                                                    <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Data</th>
                                                    <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Caminhão</th>
                                                    <th scope="col" class="px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Tipo</th>
                                                    <th scope="col" class="px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Produção</th>
                                                    <th scope="col" class="px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">T. Campo</th>
                                                    <th scope="col" class="px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">T. Pátio</th>
                                                    <th scope="col" class="px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Ações</th>
                                                </tr>
                                            </thead>
                                            <tbody id="tabela-historico-caminhoes" class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                                                <!-- Dados serão preenchidos via JavaScript -->
                                                <tr>
                                                    <td colspan="7" class="px-4 py-3 text-center text-gray-500 dark:text-gray-400">
                                                        Nenhum registro encontrado
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Conteúdo da tab "Estatísticas" -->
                    <div id="tab-estatisticas" class="caminhoes-tab-content hidden">
                        <!-- Cards de estatísticas -->
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <h3 class="text-sm font-medium text-gray-500 dark:text-gray-400">Total Produção</h3>
                                        <div class="flex items-baseline mt-1">
                                            <span id="estatisticas-total-producao-caminhoes" class="text-2xl font-semibold text-gray-900 dark:text-white">0 T</span>
                                        </div>
                                    </div>
                                    <div class="p-2 bg-primary-50 dark:bg-primary-900/30 rounded-lg">
                                        <i class="fas fa-weight-hanging text-xl text-primary-600 dark:text-primary-400"></i>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <h3 class="text-sm font-medium text-gray-500 dark:text-gray-400">Média Tempo Campo</h3>
                                        <div class="flex items-baseline mt-1">
                                            <span id="estatisticas-media-campo" class="text-2xl font-semibold text-gray-900 dark:text-white">0 min</span>
                                        </div>
                                    </div>
                                    <div class="p-2 bg-primary-50 dark:bg-primary-900/30 rounded-lg">
                                        <i class="fas fa-stopwatch text-xl text-primary-600 dark:text-primary-400"></i>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <h3 class="text-sm font-medium text-gray-500 dark:text-gray-400">Média Tempo Pátio</h3>
                                        <div class="flex items-baseline mt-1">
                                            <span id="estatisticas-media-patio" class="text-2xl font-semibold text-gray-900 dark:text-white">0 min</span>
                                        </div>
                                    </div>
                                    <div class="p-2 bg-primary-50 dark:bg-primary-900/30 rounded-lg">
                                        <i class="fas fa-warehouse text-xl text-primary-600 dark:text-primary-400"></i>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <h3 class="text-sm font-medium text-gray-500 dark:text-gray-400">Total de Viagens</h3>
                                        <div class="flex items-baseline mt-1">
                                            <span id="estatisticas-total-registros-caminhoes" class="text-2xl font-semibold text-gray-900 dark:text-white">0</span>
                                        </div>
                                    </div>
                                    <div class="p-2 bg-primary-50 dark:bg-primary-900/30 rounded-lg">
                                        <i class="fas fa-truck-loading text-xl text-primary-600 dark:text-primary-400"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Comparativo próprios vs terceiros -->
                        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
                            <div class="lg:col-span-1">
                                <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4">
                                    <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-3">Próprios vs Terceiros</h3>
                                    
                                    <div class="grid grid-cols-1 gap-4">
                                        <div class="bg-blue-50 dark:bg-blue-900/30 p-4 rounded-lg">
                                            <h4 class="text-sm font-medium text-gray-600 dark:text-gray-300">Produção de Próprios</h4>
                                            <div class="flex items-baseline mt-1">
                                                <span id="estatisticas-producao-proprios" class="text-xl font-bold text-blue-600 dark:text-blue-400">0 T</span>
                                            </div>
                                        </div>
                                        
                                        <div class="bg-green-50 dark:bg-green-900/30 p-4 rounded-lg">
                                            <h4 class="text-sm font-medium text-gray-600 dark:text-gray-300">Produção de Terceiros</h4>
                                            <div class="flex items-baseline mt-1">
                                                <span id="estatisticas-producao-terceiros" class="text-xl font-bold text-green-600 dark:text-green-400">0 T</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Gráfico de próprios vs terceiros -->
                            <div class="lg:col-span-2">
                                <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 h-full">
                                    <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-3">Distribuição da Produção</h3>
                                    <div class="h-64">
                                        <canvas id="estatisticas-chart-proprios-terceiros"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Exportar relatórios -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4">
                            <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-3">Exportar Relatórios</h3>
                            
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <button id="btn-export-estatisticas" class="inline-flex items-center justify-center px-4 py-2 bg-green-600 hover:bg-green-700 text-white font-medium rounded-lg text-sm">
                                    <i class="fas fa-chart-pie mr-2"></i> Exportar Estatísticas
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Conteúdo de Configurações -->
                <div id="content-configuracoes" class="content hidden">
                    <div class="mb-4">
                        <h2 class="text-xl font-bold text-gray-800 dark:text-white mb-2">Configurações</h2>
                        <p class="text-gray-600 dark:text-gray-400">Configurações do sistema e gestão de dados</p>
                    </div>
                    
                    <!-- Backup e Restauração -->
                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 mb-6">
                        <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-3">Backup e Restauração</h3>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                            <div>
                                <h4 class="text-md font-medium text-gray-700 dark:text-gray-300 mb-2">Exportar Dados</h4>
                                <p class="text-sm text-gray-600 dark:text-gray-400 mb-3">Exporte todos os dados para um arquivo JSON de backup</p>
                                <button id="btn-exportar-json" class="inline-flex items-center px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white font-medium rounded-lg text-sm">
                                    <i class="fas fa-download mr-2"></i> Exportar Backup
                                </button>
                            </div>
                            
                            <div>
                                <h4 class="text-md font-medium text-gray-700 dark:text-gray-300 mb-2">Importar Dados</h4>
                                <p class="text-sm text-gray-600 dark:text-gray-400 mb-3">Importe dados de um arquivo JSON previamente exportado</p>
                                
                                <button id="btn-importar-json" class="inline-flex items-center px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white font-medium rounded-lg text-sm">
                                    <i class="fas fa-upload mr-2"></i> Importar Backup
                                </button>
                                <input type="file" id="import-json-file" accept=".json" class="hidden">
                            </div>
                        </div>
                        
                        <div class="border-t border-gray-200 dark:border-gray-700 pt-4">
                            <h4 class="text-md font-medium text-gray-700 dark:text-gray-300 mb-2">Limpar Todos os Dados</h4>
                            <p class="text-sm text-gray-600 dark:text-gray-400 mb-3">
                                <span class="text-red-500 font-semibold">Atenção:</span> Esta ação irá remover permanentemente todos os dados do sistema.
                            </p>
                            <button id="btn-limpar-dados" class="inline-flex items-center px-4 py-2 bg-red-600 hover:bg-red-700 text-white font-medium rounded-lg text-sm">
                                <i class="fas fa-trash-alt mr-2"></i> Limpar Todos os Dados
                            </button>
                        </div>
                    </div>
                    
                    <!-- Relatórios -->
                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 mb-6">
                        <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-3">Relatórios do Sistema</h3>
                        
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <button id="btn-relatorio-producao" class="inline-flex items-center justify-center px-4 py-2 bg-green-600 hover:bg-green-700 text-white font-medium rounded-lg text-sm">
                                <i class="fas fa-chart-line mr-2"></i> Relatório de Produção
                            </button>
                            
                            <button id="btn-relatorio-colhedoras" class="inline-flex items-center justify-center px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg text-sm">
                                <i class="fas fa-tractor mr-2"></i> Relatório de Colhedoras
                            </button>
                            
                            <button id="btn-relatorio-caminhoes" class="inline-flex items-center justify-center px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white font-medium rounded-lg text-sm">
                                <i class="fas fa-truck mr-2"></i> Relatório de Frota
                            </button>
                        </div>
                    </div>
                    
                    <!-- Sobre o Sistema -->
                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4">
                        <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-3">Sobre o Sistema</h3>
                        
                        <div class="text-sm text-gray-600 dark:text-gray-400">
                            <p class="mb-2"><strong>Nome:</strong> GGOMES-LOG</p>
                            <p class="mb-2"><strong>Versão:</strong> 1.0.0</p>
                            <p class="mb-2"><strong>Descrição:</strong> Sistema de Gestão Agrícola para acompanhamento de colheita e logística.</p>
                            <p class="mb-4"><strong>Desenvolvido por:</strong> GGOMES Technologies</p>
                            
                            <div class="text-xs mt-4 text-gray-500 dark:text-gray-400">
                                <p>© 2025 GGOMES Technologies. Todos os direitos reservados.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>
    
    <!-- Painel de notificações -->
    <div id="notifications-panel" class="fixed inset-y-0 right-0 w-80 bg-white dark:bg-gray-800 shadow-lg transform translate-x-full transition-transform duration-300 ease-in-out z-20 flex flex-col">
        <div class="p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">
            <h3 class="text-lg font-semibold text-gray-800 dark:text-white">Notificações</h3>
            <button id="close-notifications" class="p-2 rounded-md text-gray-500 hover:text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:text-gray-300 dark:hover:bg-gray-700">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <div id="notifications-list" class="flex-1 overflow-y-auto p-4 space-y-4">
            <!-- Notificações serão preenchidas via JavaScript -->
            <div class="text-center text-gray-500 dark:text-gray-400 py-4">
                <i class="fas fa-bell text-2xl mb-2"></i>
                <p>Carregando notificações...</p>
            </div>
        </div>
        
        <div class="p-4 border-t border-gray-200 dark:border-gray-700 text-center">
            <button id="btn-clear-notifications" class="inline-flex items-center px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-700 dark:bg-gray-700 dark:hover:bg-gray-600 dark:text-white font-medium rounded-lg text-sm">
                <i class="fas fa-check-double mr-2"></i> Marcar Todas Como Lidas
            </button>
        </div>
    </div>
    
    <!-- Modal de confirmação para limpar dados -->
    <div id="modal-limpar-dados" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white dark:bg-gray-800 rounded-lg p-6 max-w-md w-full">
            <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-4">Confirmação de Limpeza</h3>
            
            <p class="text-gray-700 dark:text-gray-300 mb-4">
                <span class="text-red-500 font-semibold">Atenção:</span> Esta ação irá remover <span class="font-semibold">PERMANENTEMENTE</span> todos os dados do sistema.
            </p>
            
            <p class="text-gray-700 dark:text-gray-300 mb-6">
                Para confirmar, digite "CONFIRMAR" no campo abaixo:
            </p>
            
            <div class="mb-6">
                <input type="text" id="confirmacao-texto" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-red-500 focus:border-red-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-red-500 dark:focus:border-red-500" placeholder="Digite CONFIRMAR">
            </div>
            
            <div class="flex justify-end space-x-4">
                <button id="btn-cancelar-limpar" class="inline-flex items-center px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-700 dark:bg-gray-700 dark:hover:bg-gray-600 dark:text-white font-medium rounded-lg text-sm">
                    <i class="fas fa-times mr-2"></i> Cancelar
                </button>
                <button id="btn-confirmar-limpar" class="inline-flex items-center px-4 py-2 bg-red-600 hover:bg-red-700 text-white font-medium rounded-lg text-sm opacity-50 cursor-not-allowed" disabled>
                    <i class="fas fa-trash-alt mr-2"></i> Sim, Limpar Tudo
                </button>
            </div>
        </div>
    </div>
    
    <script>
        // Banco de dados simulado
        const DB = {
            // Inicialização do banco de dados
            init: function() {
                // Verificar se já existe algum dado
                if (!localStorage.getItem('ggomes_colhedoras')) {
                    // Criar alguns dados de exemplo
                    // Colhedoras
                    const colhedorasIniciais = [
                        { id: 'COL-001', marca: 'John Deere', modelo: '9670 STS', ano: 2021, observacoes: 'Em excelente estado' },
                        { id: 'COL-002', marca: 'New Holland', modelo: 'CR8.90', ano: 2020, observacoes: 'Manutenção recente' },
                        { id: 'COL-003', marca: 'Case IH', modelo: 'Axial-Flow 9250', ano: 2022, observacoes: 'Nova aquisição' }
                    ];
                    localStorage.setItem('ggomes_colhedoras', JSON.stringify(colhedorasIniciais));
                    
                    // Obter a data atual para registros de hoje
                    const hoje = new Date();
                    const dataHoje = hoje.toISOString().split('T')[0]; // Formato YYYY-MM-DD
                    
                    // Obter data de ontem para alguns registros
                    const ontem = new Date();
                    ontem.setDate(ontem.getDate() - 1);
                    const dataOntem = ontem.toISOString().split('T')[0];
                    
                    // Registros de produção (incluindo alguns para hoje)
                    const registrosIniciais = [
                        { id: 'REG-001', data: dataOntem, colhedoraId: 'COL-001', cultura: 'Soja', quantidade: 145.5, horas: 8.5, combustivel: 120, observacoes: 'Condições climáticas favoráveis' },
                        { id: 'REG-002', data: dataOntem, colhedoraId: 'COL-002', cultura: 'Milho', quantidade: 168.2, horas: 9, combustivel: 130, observacoes: 'Solo úmido pela manhã' },
                        { id: 'REG-003', data: dataOntem, colhedoraId: 'COL-003', cultura: 'Soja', quantidade: 152.8, horas: 8, combustivel: 115, observacoes: '' },
                        { id: 'REG-004', data: dataHoje, colhedoraId: 'COL-001', cultura: 'Milho', quantidade: 138.6, horas: 7.5, combustivel: 105, observacoes: 'Parada de 1h para manutenção' },
                        { id: 'REG-005', data: dataHoje, colhedoraId: 'COL-002', cultura: 'Soja', quantidade: 162.4, horas: 8.5, combustivel: 125, observacoes: 'Condições ideais' }
                    ];
                    localStorage.setItem('ggomes_registros', JSON.stringify(registrosIniciais));
                    
                    // Veículos cadastrados
                    const veiculosIniciais = [
                        { id: 'CAM-001', placa: 'ABC-1234', modelo: 'Volvo FH 540', tipo: 'proprio', capacidade: 30, motorista: 'João Silva', observacoes: 'Caminhão principal' },
                        { id: 'CAM-002', placa: 'DEF-5678', modelo: 'Scania R 450', tipo: 'proprio', capacidade: 28, motorista: 'Pedro Santos', observacoes: '' },
                        { id: 'CAM-003', placa: 'GHI-9012', modelo: 'Mercedes-Benz Atego', tipo: 'terceiro', capacidade: 26, motorista: 'Carlos Oliveira', observacoes: 'Empresa Transportes XYZ' }
                    ];
                    localStorage.setItem('ggomes_veiculos_cadastrados', JSON.stringify(veiculosIniciais));
                    
                    // Registros de caminhões
                    const caminhoesIniciais = [
                        { id: 'VIA-001', data: dataOntem, caminhaoId: 'CAM-001', producao: 28.5, cultura: 'Soja', tempoCampo: 45, tempoPatio: 30, observacoes: '' },
                        { id: 'VIA-002', data: dataOntem, caminhaoId: 'CAM-002', producao: 27.2, cultura: 'Soja', tempoCampo: 50, tempoPatio: 35, observacoes: '' },
                        { id: 'VIA-003', data: dataOntem, caminhaoId: 'CAM-003', producao: 25.8, cultura: 'Milho', tempoCampo: 42, tempoPatio: 28, observacoes: '' },
                        { id: 'VIA-004', data: dataHoje, caminhaoId: 'CAM-001', producao: 29.1, cultura: 'Soja', tempoCampo: 48, tempoPatio: 32, observacoes: '' },
                        { id: 'VIA-005', data: dataHoje, caminhaoId: 'CAM-002', producao: 26.9, cultura: 'Milho', tempoCampo: 46, tempoPatio: 31, observacoes: '' }
                    ];
                    localStorage.setItem('ggomes_caminhoes', JSON.stringify(caminhoesIniciais));
                    
                    // Registros de chuva
                    const chuvasIniciais = [
                        { id: 'CHV-001', dataInicio: '2025-05-10', dataFim: '2025-05-11', dias: 1.5, intensidade: 'media', observacoes: 'Chuva constante' },
                        { id: 'CHV-002', dataInicio: '2025-05-20', dataFim: '2025-05-22', dias: 2, intensidade: 'alta', observacoes: 'Tempestade com trovões' }
                    ];
                    localStorage.setItem('ggomes_chuvas', JSON.stringify(chuvasIniciais));
                    
                    // Registros de consumo
                    const consumosIniciais = [
                        { id: 'CON-001', data: dataOntem, tipoEquipamento: 'colhedora', equipamentoId: 'COL-001', tipoOleo: 'diesel', quantidade: 350.2, horimetro: 1205.5, observacoes: 'Abastecimento completo' },
                        { id: 'CON-002', data: dataOntem, tipoEquipamento: 'colhedora', equipamentoId: 'COL-002', tipoOleo: 'diesel', quantidade: 320.8, horimetro: 980.2, observacoes: '' },
                        { id: 'CON-003', data: dataOntem, tipoEquipamento: 'caminhao', equipamentoId: 'CAM-001', tipoOleo: 'diesel', quantidade: 180.5, horimetro: 15200, observacoes: '' },
                        { id: 'CON-004', data: dataHoje, tipoEquipamento: 'colhedora', equipamentoId: 'COL-001', tipoOleo: 'hidraulico', quantidade: 45.0, horimetro: 1210.5, observacoes: 'Troca programada' },
                        { id: 'CON-005', data: dataHoje, tipoEquipamento: 'caminhao', equipamentoId: 'CAM-002', tipoOleo: 'diesel', quantidade: 210.5, horimetro: 22450, observacoes: '' }
                    ];
                    localStorage.setItem('ggomes_consumos', JSON.stringify(consumosIniciais));
                    
                    // Dados iniciais de liberações
                    const liberacoesIniciais = [
                        { id: 'LIB-001', frente: 'Frente 01', fazenda: 'Fazenda São João', numero: 'LIB-2025-001', previsto: 1000, realizado: 850, restante: 150, data: dataOntem, observacoes: 'Liberação inicial', dataRegistro: new Date().toISOString() },
                        { id: 'LIB-002', frente: 'Frente 02', fazenda: 'Fazenda Boa Vista', numero: 'LIB-2025-002', previsto: 1500, realizado: 1200, restante: 300, data: dataHoje, observacoes: 'Em andamento', dataRegistro: new Date().toISOString() }
                    ];
                    localStorage.setItem('ggomes_liberacoes', JSON.stringify(liberacoesIniciais));
                    
                    // Notificações
                    const notificacoesIniciais = [
                        { id: 'notif-1', tipo: 'info', titulo: 'Bem-vindo ao GGOMES-LOG', mensagem: 'Sistema inicializado com sucesso! Comece cadastrando suas colhedoras e registrando a produção diária.', dataHora: new Date().toISOString(), lida: false },
                        { id: 'notif-2', tipo: 'warn', titulo: 'Manutenção Programada', mensagem: 'A colhedora COL-001 está agendada para manutenção em 3 dias.', dataHora: new Date().toISOString(), lida: false }
                    ];
                    localStorage.setItem('ggomes_notifications', JSON.stringify(notificacoesIniciais));
                    
                    // Configurações
                    localStorage.setItem('ggomes_config', JSON.stringify({
                        temaEscuro: true,
                        ultimoAcesso: new Date().toISOString()
                    }));
                }
                
                // Verificar se falta algum tipo de dado e inicializá-lo
                if (!localStorage.getItem('ggomes_colhedoras')) {
                    localStorage.setItem('ggomes_colhedoras', JSON.stringify([]));
                }
                if (!localStorage.getItem('ggomes_registros')) {
                    localStorage.setItem('ggomes_registros', JSON.stringify([]));
                }
                if (!localStorage.getItem('ggomes_veiculos_cadastrados')) {
                    localStorage.setItem('ggomes_veiculos_cadastrados', JSON.stringify([]));
                }
                if (!localStorage.getItem('ggomes_caminhoes')) {
                    localStorage.setItem('ggomes_caminhoes', JSON.stringify([]));
                }
                if (!localStorage.getItem('ggomes_chuvas')) {
                    localStorage.setItem('ggomes_chuvas', JSON.stringify([]));
                }
                if (!localStorage.getItem('ggomes_consumos')) {
                    localStorage.setItem('ggomes_consumos', JSON.stringify([]));
                }
                if (!localStorage.getItem('ggomes_notifications')) {
                    localStorage.setItem('ggomes_notifications', JSON.stringify([]));
                }
                if (!localStorage.getItem('ggomes_config')) {
                    localStorage.setItem('ggomes_config', JSON.stringify({ temaEscuro: true, ultimoAcesso: new Date().toISOString() }));
                }
                if (!localStorage.getItem('ggomes_liberacoes')) {
                    localStorage.setItem('ggomes_liberacoes', JSON.stringify([]));
                }
                
                // Atualizar última data de acesso
                const config = JSON.parse(localStorage.getItem('ggomes_config'));
                config.ultimoAcesso = new Date().toISOString();
                localStorage.setItem('ggomes_config', JSON.stringify(config));
            },
            
            // Método para limpar todos os dados
            clearAll: function() {
                try {
                    localStorage.removeItem('ggomes_colhedoras');
                    localStorage.removeItem('ggomes_registros');
                    localStorage.removeItem('ggomes_veiculos_cadastrados');
                    localStorage.removeItem('ggomes_caminhoes');
                    localStorage.removeItem('ggomes_chuvas');
                    localStorage.removeItem('ggomes_consumos');
                    localStorage.removeItem('ggomes_notifications');
                    localStorage.removeItem('ggomes_liberacoes');
                    
                    // Manter apenas as configurações
                    const config = JSON.parse(localStorage.getItem('ggomes_config') || '{}');
                    localStorage.setItem('ggomes_config', JSON.stringify({
                        ...config,
                        ultimoAcesso: new Date().toISOString()
                    }));
                    
                    // Inicializar com arrays vazios em vez de dados de exemplo
                    localStorage.setItem('ggomes_colhedoras', JSON.stringify([]));
                    localStorage.setItem('ggomes_registros', JSON.stringify([]));
                    localStorage.setItem('ggomes_veiculos_cadastrados', JSON.stringify([]));
                    localStorage.setItem('ggomes_caminhoes', JSON.stringify([]));
                    localStorage.setItem('ggomes_chuvas', JSON.stringify([]));
                    localStorage.setItem('ggomes_consumos', JSON.stringify([]));
                    localStorage.setItem('ggomes_notifications', JSON.stringify([]));
                    localStorage.setItem('ggomes_liberacoes', JSON.stringify([]));
                    
                    return true;
                } catch (error) {
                    console.error('Erro ao limpar dados:', error);
                    return false;
                }
            },
            
            // Exportar todos os dados para backup
            exportData: function() {
                try {
                    const data = {
                        colhedoras: JSON.parse(localStorage.getItem('ggomes_colhedoras') || '[]'),
                        registros: JSON.parse(localStorage.getItem('ggomes_registros') || '[]'),
                        veiculos: JSON.parse(localStorage.getItem('ggomes_veiculos_cadastrados') || '[]'),
                        caminhoes: JSON.parse(localStorage.getItem('ggomes_caminhoes') || '[]'),
                        chuvas: JSON.parse(localStorage.getItem('ggomes_chuvas') || '[]'),
                        consumos: JSON.parse(localStorage.getItem('ggomes_consumos') || '[]'),
                        notifications: JSON.parse(localStorage.getItem('ggomes_notifications') || '[]'),
                        liberacoes: JSON.parse(localStorage.getItem('ggomes_liberacoes') || '[]'),
                        config: JSON.parse(localStorage.getItem('ggomes_config') || '{}'),
                        metaData: {
                            exportDate: new Date().toISOString(),
                            version: '1.0.0'
                        }
                    };
                    
                    return JSON.stringify(data, null, 2);
                } catch (error) {
                    console.error('Erro ao exportar dados:', error);
                    throw new Error('Não foi possível exportar os dados.');
                }
            },
            
            // Importar dados de backup
            importData: function(jsonData) {
                try {
                    const data = JSON.parse(jsonData);
                    
                    // Validar estrutura mínima de dados
                    if (!data.colhedoras || !data.registros || !data.veiculos || 
                        !data.caminhoes || !data.chuvas) {
                        throw new Error('Arquivo de backup inválido ou corrompido.');
                    }
                    
                    // Restaurar dados
                    localStorage.setItem('ggomes_colhedoras', JSON.stringify(data.colhedoras));
                    localStorage.setItem('ggomes_registros', JSON.stringify(data.registros));
                    localStorage.setItem('ggomes_veiculos_cadastrados', JSON.stringify(data.veiculos));
                    localStorage.setItem('ggomes_caminhoes', JSON.stringify(data.caminhoes));
                    localStorage.setItem('ggomes_chuvas', JSON.stringify(data.chuvas));
                    
                    // Restaurar consumos se existirem
                    if (data.consumos) {
                        localStorage.setItem('ggomes_consumos', JSON.stringify(data.consumos));
                    }
                    
                    // Restaurar liberações se existirem
                    if (data.liberacoes) {
                        localStorage.setItem('ggomes_liberacoes', JSON.stringify(data.liberacoes));
                    }
                    
                    // Restaurar notificações e configurações se existirem
                    if (data.notifications) {
                        localStorage.setItem('ggomes_notifications', JSON.stringify(data.notifications));
                    }
                    
                    if (data.config) {
                        // Preservar tema atual mas atualizar outras configurações
                        const currentConfig = JSON.parse(localStorage.getItem('ggomes_config') || '{}');
                        const newConfig = {
                            ...data.config,
                            temaEscuro: currentConfig.temaEscuro, // Manter tema atual
                            ultimoAcesso: new Date().toISOString() // Atualizar acesso
                        };
                        localStorage.setItem('ggomes_config', JSON.stringify(newConfig));
                    }
                    
                    return true;
                } catch (error) {
                    console.error('Erro ao importar dados:', error);
                    throw error;
                }
            },
            
            // Operações com colhedoras
            colhedoras: {
                getAll: function() {
                    return JSON.parse(localStorage.getItem('ggomes_colhedoras') || '[]');
                },
                
                get: function(id) {
                    const colhedoras = JSON.parse(localStorage.getItem('ggomes_colhedoras') || '[]');
                    return colhedoras.find(c => c.id === id);
                },
                
                add: function(colhedora) {
                    const colhedoras = JSON.parse(localStorage.getItem('ggomes_colhedoras') || '[]');
                    
                    // Verificar se já existe uma colhedora com o mesmo ID
                    if (colhedoras.some(c => c.id === colhedora.id)) {
                        throw new Error('Já existe uma colhedora com este ID');
                    }
                    
                    // Adicionar colhedora
                    colhedoras.push(colhedora);
                    localStorage.setItem('ggomes_colhedoras', JSON.stringify(colhedoras));
                    
                    // Adicionar notificação
                    DB.notifications.add({
                        tipo: 'success',
                        titulo: 'Nova Colhedora',
                        mensagem: `A colhedora ${colhedora.id} foi cadastrada com sucesso.`
                    });
                    
                    return colhedora;
                },
                
                update: function(colhedora) {
                    const colhedoras = JSON.parse(localStorage.getItem('ggomes_colhedoras') || '[]');
                    
                    // Encontrar índice da colhedora
                    const index = colhedoras.findIndex(c => c.id === colhedora.id);
                    
                    if (index === -1) {
                        throw new Error('Colhedora não encontrada');
                    }
                    
                    // Atualizar colhedora
                    colhedoras[index] = { ...colhedoras[index], ...colhedora };
                    localStorage.setItem('ggomes_colhedoras', JSON.stringify(colhedoras));
                    
                    return colhedoras[index];
                },
                
                remove: function(id) {
                    const colhedoras = JSON.parse(localStorage.getItem('ggomes_colhedoras') || '[]');
                    
                    // Verificar se a colhedora está em uso
                    const registros = JSON.parse(localStorage.getItem('ggomes_registros') || '[]');
                    const temRegistros = registros.some(r => r.colhedoraId === id);
                    
                    if (temRegistros) {
                        throw new Error('Esta colhedora não pode ser excluída porque possui registros de produção');
                    }
                    
                    // Filtrar colhedoras
                    const novasColhedoras = colhedoras.filter(c => c.id !== id);
                    
                    if (novasColhedoras.length === colhedoras.length) {
                        throw new Error('Colhedora não encontrada');
                    }
                    
                    localStorage.setItem('ggomes_colhedoras', JSON.stringify(novasColhedoras));
                    
                    return true;
                }
            },
            
            // Operações com registros de produção
            registros: {
                getAll: function() {
                    return JSON.parse(localStorage.getItem('ggomes_registros') || '[]');
                },
                
                get: function(id) {
                    const registros = JSON.parse(localStorage.getItem('ggomes_registros') || '[]');
                    return registros.find(r => r.id === id);
                },
                
                add: function(registro) {
                    const registros = JSON.parse(localStorage.getItem('ggomes_registros') || '[]');
                    
                    // Adicionar ID único
                    registro.id = registro.id || 'REG-' + Date.now();
                    
                    // Adicionar registro
                    registros.push(registro);
                    localStorage.setItem('ggomes_registros', JSON.stringify(registros));
                    
                    return registro;
                },
                
                update: function(registro) {
                    const registros = JSON.parse(localStorage.getItem('ggomes_registros') || '[]');
                    
                    // Encontrar índice do registro
                    const index = registros.findIndex(r => r.id === registro.id);
                    
                    if (index === -1) {
                        throw new Error('Registro não encontrado');
                    }
                    
                    // Atualizar registro
                    registros[index] = { ...registros[index], ...registro };
                    localStorage.setItem('ggomes_registros', JSON.stringify(registros));
                    
                    return registros[index];
                },
                
                remove: function(id) {
                    const registros = JSON.parse(localStorage.getItem('ggomes_registros') || '[]');
                    
                    // Filtrar registros
                    const novosRegistros = registros.filter(r => r.id !== id);
                    
                    if (novosRegistros.length === registros.length) {
                        throw new Error('Registro não encontrado');
                    }
                    
                    localStorage.setItem('ggomes_registros', JSON.stringify(novosRegistros));
                    
                    return true;
                },
                
                // Obter estatísticas de equipamentos
                getEquipmentStats: function() {
                    const registros = JSON.parse(localStorage.getItem('ggomes_registros') || '[]');
                    const colhedoras = JSON.parse(localStorage.getItem('ggomes_colhedoras') || '[]');
                    
                    // Agrupar registros por colhedora
                    const statsPorColhedora = {};
                    
                    // Inicializar estatísticas para cada colhedora
                    colhedoras.forEach(colhedora => {
                        statsPorColhedora[colhedora.id] = {
                            id: colhedora.id,
                            registros: 0,
                            quantidade: 0,
                            horas: 0,
                            rendimento: 0,
                            mediaDiaria: 0,
                            diasUnicos: new Set()
                        };
                    });
                    
                    // Processar registros
                    registros.forEach(registro => {
                        const colhedoraId = registro.colhedoraId;
                        
                        if (statsPorColhedora[colhedoraId]) {
                            statsPorColhedora[colhedoraId].registros += 1;
                            statsPorColhedora[colhedoraId].quantidade += Number(registro.quantidade) || 0;
                            statsPorColhedora[colhedoraId].horas += Number(registro.horas) || 0;
                            statsPorColhedora[colhedoraId].diasUnicos.add(registro.data);
                        }
                    });
                    
                    // Calcular métricas finais
                    Object.values(statsPorColhedora).forEach(stats => {
                        stats.rendimento = stats.horas > 0 ? stats.quantidade / stats.horas : 0;
                        stats.mediaDiaria = stats.diasUnicos.size > 0 ? stats.quantidade / stats.diasUnicos.size : 0;
                        stats.diasUnicos = stats.diasUnicos.size; // Converter Set para contagem
                    });
                    
                    // Converter para array
                    return Object.values(statsPorColhedora);
                },
                
                // Obter estatísticas por cultura
                getCultureStats: function() {
                    const registros = JSON.parse(localStorage.getItem('ggomes_registros') || '[]');
                    
                    // Agrupar registros por cultura
                    const statsPorCultura = {};
                    
                    // Processar registros
                    registros.forEach(registro => {
                        const cultura = registro.cultura || 'Não especificada';
                        
                        if (!statsPorCultura[cultura]) {
                            statsPorCultura[cultura] = {
                                cultura: cultura,
                                registros: 0,
                                quantidade: 0,
                                horas: 0,
                                rendimento: 0,
                                mediaDiaria: 0,
                                diasUnicos: new Set()
                            };
                        }
                        
                        statsPorCultura[cultura].registros += 1;
                        statsPorCultura[cultura].quantidade += Number(registro.quantidade) || 0;
                        statsPorCultura[cultura].horas += Number(registro.horas) || 0;
                        statsPorCultura[cultura].diasUnicos.add(registro.data);
                    });
                    
                    // Calcular métricas finais
                    Object.values(statsPorCultura).forEach(stats => {
                        stats.rendimento = stats.horas > 0 ? stats.quantidade / stats.horas : 0;
                        stats.mediaDiaria = stats.diasUnicos.size > 0 ? stats.quantidade / stats.diasUnicos.size : 0;
                        stats.diasUnicos = stats.diasUnicos.size; // Converter Set para contagem
                    });
                    
                    // Converter para array
                    return Object.values(statsPorCultura);
                },
                
                // Obter estatísticas diárias
                getDailyStats: function(dias = 30) {
                    const registros = JSON.parse(localStorage.getItem('ggomes_registros') || '[]');
                    
                    // Filtrar registros por período
                    const dataLimite = new Date();
                    dataLimite.setDate(dataLimite.getDate() - dias);
                    const dataLimiteStr = dataLimite.toISOString().split('T')[0];
                    
                    const registrosFiltrados = dias > 0 ? 
                        registros.filter(r => r.data >= dataLimiteStr) : 
                        [...registros];
                    
                    // Agrupar por data
                    const statsPorDia = {};
                    
                    registrosFiltrados.forEach(registro => {
                        const data = registro.data;
                        
                        if (!statsPorDia[data]) {
                            statsPorDia[data] = {
                                data: data,
                                quantidade: 0,
                                horas: 0,
                                rendimento: 0
                            };
                        }
                        
                        statsPorDia[data].quantidade += Number(registro.quantidade) || 0;
                        statsPorDia[data].horas += Number(registro.horas) || 0;
                    });
                    
                    // Calcular rendimento
                    Object.values(statsPorDia).forEach(stats => {
                        stats.rendimento = stats.horas > 0 ? stats.quantidade / stats.horas : 0;
                    });
                    
                    // Converter para array e ordenar por data
                    return Object.values(statsPorDia).sort((a, b) => new Date(a.data) - new Date(b.data));
                }
            },
            
            // Operações com veículos cadastrados
            veiculosCadastrados: {
                getAll: function() {
                    return JSON.parse(localStorage.getItem('ggomes_veiculos_cadastrados') || '[]');
                },
                
                get: function(id) {
                    const veiculos = JSON.parse(localStorage.getItem('ggomes_veiculos_cadastrados') || '[]');
                    return veiculos.find(v => v.id === id);
                },
                
                add: function(veiculo) {
                    const veiculos = JSON.parse(localStorage.getItem('ggomes_veiculos_cadastrados') || '[]');
                    
                    // Verificar se já existe um veículo com o mesmo ID
                    if (veiculos.some(v => v.id === veiculo.id)) {
                        throw new Error('Já existe um caminhão com este ID');
                    }
                    
                    // Adicionar veículo
                    veiculos.push(veiculo);
                    localStorage.setItem('ggomes_veiculos_cadastrados', JSON.stringify(veiculos));
                    
                    return veiculo;
                },
                
                update: function(veiculo) {
                    const veiculos = JSON.parse(localStorage.getItem('ggomes_veiculos_cadastrados') || '[]');
                    
                    // Encontrar índice do veículo
                    const index = veiculos.findIndex(v => v.id === veiculo.id);
                    
                    if (index === -1) {
                        throw new Error('Caminhão não encontrado');
                    }
                    
                    // Atualizar veículo
                    veiculos[index] = { ...veiculos[index], ...veiculo };
                    localStorage.setItem('ggomes_veiculos_cadastrados', JSON.stringify(veiculos));
                    
                    return veiculos[index];
                },
                
                remove: function(id) {
                    const veiculos = JSON.parse(localStorage.getItem('ggomes_veiculos_cadastrados') || '[]');
                    
                    // Verificar se o veículo está em uso
                    const viagens = JSON.parse(localStorage.getItem('ggomes_caminhoes') || '[]');
                    const temViagens = viagens.some(v => v.caminhaoId === id);
                    
                    if (temViagens) {
                        throw new Error('Este caminhão não pode ser excluído porque possui registros de viagens');
                    }
                    
                    // Filtrar veículos
                    const novosVeiculos = veiculos.filter(v => v.id !== id);
                    
                    if (novosVeiculos.length === veiculos.length) {
                        throw new Error('Caminhão não encontrado');
                    }
                    
                    localStorage.setItem('ggomes_veiculos_cadastrados', JSON.stringify(novosVeiculos));
                    
                    return true;
                }
            },
            
            // Operações com registros de caminhões
            caminhoes: {
                getAll: function() {
                    return JSON.parse(localStorage.getItem('ggomes_caminhoes') || '[]');
                },
                
                get: function(id) {
                    const caminhoes = JSON.parse(localStorage.getItem('ggomes_caminhoes') || '[]');
                    return caminhoes.find(c => c.id === id);
                },
                
                add: function(viagem) {
                    const caminhoes = JSON.parse(localStorage.getItem('ggomes_caminhoes') || '[]');
                    
                    // Adicionar ID único
                    viagem.id = viagem.id || 'VIA-' + Date.now();
                    
                    // Adicionar viagem
                    caminhoes.push(viagem);
                    localStorage.setItem('ggomes_caminhoes', JSON.stringify(caminhoes));
                    
                    return viagem;
                },
                
                update: function(viagem) {
                    const caminhoes = JSON.parse(localStorage.getItem('ggomes_caminhoes') || '[]');
                    
                    // Encontrar índice da viagem
                    const index = caminhoes.findIndex(c => c.id === viagem.id);
                    
                    if (index === -1) {
                        throw new Error('Viagem não encontrada');
                    }
                    
                    // Atualizar viagem
                    caminhoes[index] = { ...caminhoes[index], ...viagem };
                    localStorage.setItem('ggomes_caminhoes', JSON.stringify(caminhoes));
                    
                    return caminhoes[index];
                },
                
                remove: function(id) {
                    const caminhoes = JSON.parse(localStorage.getItem('ggomes_caminhoes') || '[]');
                    
                    // Filtrar viagens
                    const novasCaminhoes = caminhoes.filter(c => c.id !== id);
                    
                    if (novasCaminhoes.length === caminhoes.length) {
                        throw new Error('Viagem não encontrada');
                    }
                    
                    localStorage.setItem('ggomes_caminhoes', JSON.stringify(novasCaminhoes));
                    
                    return true;
                },
                
                // Obter estatísticas de caminhões
                getStats: function() {
                    const caminhoes = JSON.parse(localStorage.getItem('ggomes_caminhoes') || '[]');
                    const veiculos = JSON.parse(localStorage.getItem('ggomes_veiculos_cadastrados') || '[]');
                    
                    // Inicializar estatísticas
                    const stats = {
                        totalViagens: caminhoes.length,
                        totalProducao: 0,
                        mediaTempoCampo: 0,
                        mediaTempoPatio: 0,
                        proprios: {
                            viagens: 0,
                            producao: 0,
                            tempoCampo: 0,
                            tempoPatio: 0
                        },
                        terceiros: {
                            viagens: 0,
                            producao: 0,
                            tempoCampo: 0,
                            tempoPatio: 0
                        }
                    };
                    
                    // Somar valores
                    let totalTempoCampo = 0;
                    let totalTempoPatio = 0;
                    
                    caminhoes.forEach(viagem => {
                        // Producao
                        const producao = Number(viagem.producao) || 0;
                        stats.totalProducao += producao;
                        
                        // Tempos
                        const tempoCampo = Number(viagem.tempoCampo) || 0;
                        const tempoPatio = Number(viagem.tempoPatio) || 0;
                        
                        totalTempoCampo += tempoCampo;
                        totalTempoPatio += tempoPatio;
                        
                        // Obter tipo do veículo
                        const veiculo = veiculos.find(v => v.id === viagem.caminhaoId);
                        const tipo = veiculo ? veiculo.tipo : 'proprio'; // Assume próprio se não encontrar
                        
                        // Atualizar estatísticas por tipo
                        if (tipo === 'terceiro') {
                            stats.terceiros.viagens += 1;
                            stats.terceiros.producao += producao;
                            stats.terceiros.tempoCampo += tempoCampo;
                            stats.terceiros.tempoPatio += tempoPatio;
                        } else {
                            stats.proprios.viagens += 1;
                            stats.proprios.producao += producao;
                            stats.proprios.tempoCampo += tempoCampo;
                            stats.proprios.tempoPatio += tempoPatio;
                        }
                    });
                    
                    // Calcular médias
                    stats.mediaTempoCampo = stats.totalViagens > 0 ? totalTempoCampo / stats.totalViagens : 0;
                    stats.mediaTempoPatio = stats.totalViagens > 0 ? totalTempoPatio / stats.totalViagens : 0;
                    
                    stats.proprios.mediaTempoCampo = stats.proprios.viagens > 0 ? stats.proprios.tempoCampo / stats.proprios.viagens : 0;
                    stats.proprios.mediaTempoPatio = stats.proprios.viagens > 0 ? stats.proprios.tempoPatio / stats.proprios.viagens : 0;
                    
                    stats.terceiros.mediaTempoCampo = stats.terceiros.viagens > 0 ? stats.terceiros.tempoCampo / stats.terceiros.viagens : 0;
                    stats.terceiros.mediaTempoPatio = stats.terceiros.viagens > 0 ? stats.terceiros.tempoPatio / stats.terceiros.viagens : 0;
                    
                    return stats;
                }
            },
            
            // Operações com registro de chuvas
            chuvas: {
                getAll: function() {
                    return JSON.parse(localStorage.getItem('ggomes_chuvas') || '[]');
                },
                
                get: function(id) {
                    const chuvas = JSON.parse(localStorage.getItem('ggomes_chuvas') || '[]');
                    return chuvas.find(c => c.id === id);
                },
                
                add: function(chuva) {
                    const chuvas = JSON.parse(localStorage.getItem('ggomes_chuvas') || '[]');
                    
                    // Adicionar ID único
                    chuva.id = chuva.id || 'CHV-' + Date.now();
                    
                    // Adicionar chuva
                    chuvas.push(chuva);
                    localStorage.setItem('ggomes_chuvas', JSON.stringify(chuvas));
                    
                    // Adicionar notificação
                    DB.notifications.add({
                        tipo: 'warn',
                        titulo: 'Nova Parada por Chuva',
                        mensagem: `Foi registrada uma parada de ${chuva.dias} dias por chuva.`
                    });
                    
                    return chuva;
                },
                
                update: function(chuva) {
                    const chuvas = JSON.parse(localStorage.getItem('ggomes_chuvas') || '[]');
                    
                    // Encontrar índice da chuva
                    const index = chuvas.findIndex(c => c.id === chuva.id);
                    
                    if (index === -1) {
                        throw new Error('Registro de chuva não encontrado');
                    }
                    
                    // Atualizar chuva
                    chuvas[index] = { ...chuvas[index], ...chuva };
                    localStorage.setItem('ggomes_chuvas', JSON.stringify(chuvas));
                    
                    return chuvas[index];
                },
                
                remove: function(id) {
                    const chuvas = JSON.parse(localStorage.getItem('ggomes_chuvas') || '[]');
                    
                    // Filtrar chuvas
                    const novasChuvas = chuvas.filter(c => c.id !== id);
                    
                    if (novasChuvas.length === chuvas.length) {
                        throw new Error('Registro de chuva não encontrado');
                    }
                    
                    localStorage.setItem('ggomes_chuvas', JSON.stringify(novasChuvas));
                    
                    return true;
                },
                
                // Obter total de dias parados
                getTotalDias: function() {
                    const chuvas = JSON.parse(localStorage.getItem('ggomes_chuvas') || '[]');
                    
                    // Somar dias de todas as chuvas
                    return chuvas.reduce((total, chuva) => total + Number(chuva.dias || 0), 0);
                },
                
                // Obter última chuva
                getLastChuva: function() {
                    const chuvas = JSON.parse(localStorage.getItem('ggomes_chuvas') || '[]');
                    
                    if (chuvas.length === 0) {
                        return null;
                    }
                    
                    // Ordenar por data de fim (mais recente primeiro)
                    return [...chuvas].sort((a, b) => new Date(b.dataFim) - new Date(a.dataFim))[0];
                },
                
                // Calcular impacto estimado da chuva na produção
                calcularImpactoEstimado: function() {
                    const chuvas = JSON.parse(localStorage.getItem('ggomes_chuvas') || '[]');
                    const registros = JSON.parse(localStorage.getItem('ggomes_registros') || '[]');
                    
                    // Total de dias parados
                    const totalDias = this.getTotalDias();
                    
                    if (totalDias === 0 || registros.length === 0) {
                        return 0;
                    }
                    
                    // Calcular produção média diária
                    const totalProducao = registros.reduce((total, registro) => total + Number(registro.quantidade || 0), 0);
                    
                    // Obter datas únicas de registro
                    const datasUnicas = new Set(registros.map(r => r.data));
                    const diasDeTrabalho = datasUnicas.size;
                    
                    if (diasDeTrabalho === 0) {
                        return 0;
                    }
                    
                    const mediaDiaria = totalProducao / diasDeTrabalho;
                    
                    // Calcular impacto
                    return mediaDiaria * totalDias;
                }
            },
            
            // Operações com registros de consumo
            consumos: {
                getAll: function() {
                    return JSON.parse(localStorage.getItem('ggomes_consumos') || '[]');
                },
                
                get: function(id) {
                    const consumos = JSON.parse(localStorage.getItem('ggomes_consumos') || '[]');
                    return consumos.find(c => c.id === id);
                },
                
                add: function(consumo) {
                    const consumos = JSON.parse(localStorage.getItem('ggomes_consumos') || '[]');
                    
                    // Adicionar ID único
                    consumo.id = consumo.id || 'CON-' + Date.now();
                    
                    // Adicionar registro
                    consumos.push(consumo);
                    localStorage.setItem('ggomes_consumos', JSON.stringify(consumos));
                    
                    return consumo;
                },
                
                update: function(consumo) {
                    const consumos = JSON.parse(localStorage.getItem('ggomes_consumos') || '[]');
                    
                    // Encontrar índice do consumo
                    const index = consumos.findIndex(c => c.id === consumo.id);
                    
                    if (index === -1) {
                        throw new Error('Registro de consumo não encontrado');
                    }
                    
                    // Atualizar consumo
                    consumos[index] = { ...consumos[index], ...consumo };
                    localStorage.setItem('ggomes_consumos', JSON.stringify(consumos));
                    
                    return consumos[index];
                },
                
                remove: function(id) {
                    const consumos = JSON.parse(localStorage.getItem('ggomes_consumos') || '[]');
                    
                    // Filtrar consumos
                    const novosConsumos = consumos.filter(c => c.id !== id);
                    
                    if (novosConsumos.length === consumos.length) {
                        throw new Error('Registro de consumo não encontrado');
                    }
                    
                    localStorage.setItem('ggomes_consumos', JSON.stringify(novosConsumos));
                    
                    return true;
                },
                
                // Obter estatísticas de consumo
                getStats: function(dias = 0) {
                    const consumos = JSON.parse(localStorage.getItem('ggomes_consumos') || '[]');
                    
                    // Filtrar por período se especificado
                    let consumosFiltrados = [...consumos];
                    
                    if (dias > 0) {
                        const dataLimite = new Date();
                        dataLimite.setDate(dataLimite.getDate() - dias);
                        const dataLimiteStr = dataLimite.toISOString().split('T')[0];
                        
                        consumosFiltrados = consumos.filter(c => {
                            return c.data >= dataLimiteStr;
                        });
                    }
                    
                    // Calcular totais
                    let totalDiesel = 0;
                    let totalHidraulico = 0;
                    let totalHoras = 0; // Assumindo que temos dados de horas para cálculo de média
                    
                    // Estatísticas por equipamento
                    const equipamentos = {};
                    
                    // Processar cada registro
                    consumosFiltrados.forEach(c => {
                        // Soma por tipo de óleo
                        if (c.tipoOleo === 'diesel') {
                            totalDiesel += Number(c.quantidade) || 0;
                        } else if (c.tipoOleo === 'hidraulico') {
                            totalHidraulico += Number(c.quantidade) || 0;
                        }
                        
                        // Agrupar por equipamento
                        const equipId = `${c.tipoEquipamento}-${c.equipamentoId}`;
                        
                        if (!equipamentos[equipId]) {
                            equipamentos[equipId] = {
                                tipo: c.tipoEquipamento,
                                id: c.equipamentoId,
                                diesel: 0,
                                hidraulico: 0,
                                registros: 0,
                                ultimoHorimetro: 0,
                                primeiroHorimetro: Number.MAX_SAFE_INTEGER
                            };
                        }
                        
                        // Adicionar consumo ao equipamento
                        if (c.tipoOleo === 'diesel') {
                            equipamentos[equipId].diesel += Number(c.quantidade) || 0;
                        } else if (c.tipoOleo === 'hidraulico') {
                            equipamentos[equipId].hidraulico += Number(c.quantidade) || 0;
                        }
                        
                        equipamentos[equipId].registros += 1;
                        
                        // Atualizar horímetro mais recente e mais antigo
                        if (c.horimetro) {
                            const horimetro = Number(c.horimetro);
                            if (horimetro > equipamentos[equipId].ultimoHorimetro) {
                                equipamentos[equipId].ultimoHorimetro = horimetro;
                            }
                            if (horimetro < equipamentos[equipId].primeiroHorimetro) {
                                equipamentos[equipId].primeiroHorimetro = horimetro;
                            }
                        }
                    });
                    
                    // Calcular horas totais e médias
                    Object.values(equipamentos).forEach(equip => {
                        if (equip.ultimoHorimetro > 0 && equip.primeiroHorimetro < Number.MAX_SAFE_INTEGER) {
                            const horasUsadas = equip.ultimoHorimetro - equip.primeiroHorimetro;
                            equip.horasUsadas = horasUsadas;
                            equip.mediaConsumoDiesel = horasUsadas > 0 ? equip.diesel / horasUsadas : 0;
                        }
                    });
                    
                    // Converter para array
                    const equipamentosArray = Object.values(equipamentos);
                    
                    return {
                        totalDiesel,
                        totalHidraulico,
                        totalRegistros: consumosFiltrados.length,
                        consumoMedioLitroHora: totalHoras > 0 ? totalDiesel / totalHoras : 0,
                        equipamentos: equipamentosArray
                    };
                }
            },
            
            // Operações com notificações
            notifications: {
                getAll: function() {
                    return JSON.parse(localStorage.getItem('ggomes_notifications') || '[]');
                },
                
                get: function(id) {
                    const notifications = JSON.parse(localStorage.getItem('ggomes_notifications') || '[]');
                    return notifications.find(n => n.id === id);
                },
                
                add: function(notification) {
                    const notifications = JSON.parse(localStorage.getItem('ggomes_notifications') || '[]');
                    
                    // Adicionar ID único e data/hora atual
                    notification.id = notification.id || 'notif-' + Date.now();
                    notification.dataHora = notification.dataHora || new Date().toISOString();
                    notification.lida = notification.lida || false;
                    
                    // Adicionar notificação (no início do array para mostrar as mais recentes primeiro)
                    notifications.unshift(notification);
                    
                    // Limitar a 100 notificações
                    if (notifications.length > 100) {
                        notifications.pop();
                    }
                    
                    localStorage.setItem('ggomes_notifications', JSON.stringify(notifications));
                    
                    return notification;
                },
                
                update: function(notification) {
                    const notifications = JSON.parse(localStorage.getItem('ggomes_notifications') || '[]');
                    
                    // Encontrar índice da notificação
                    const index = notifications.findIndex(n => n.id === notification.id);
                    
                    if (index === -1) {
                        throw new Error('Notificação não encontrada');
                    }
                    
                    // Atualizar notificação
                    notifications[index] = { ...notifications[index], ...notification };
                    localStorage.setItem('ggomes_notifications', JSON.stringify(notifications));
                    
                    return notifications[index];
                },
                
                remove: function(id) {
                    const notifications = JSON.parse(localStorage.getItem('ggomes_notifications') || '[]');
                    
                    // Filtrar notificações
                    const novasNotifications = notifications.filter(n => n.id !== id);
                    
                    if (novasNotifications.length === notifications.length) {
                        throw new Error('Notificação não encontrada');
                    }
                    
                    localStorage.setItem('ggomes_notifications', JSON.stringify(novasNotifications));
                    
                    return true;
                },
                
                // Marcar uma notificação como lida
                markAsRead: function(id) {
                    const notifications = JSON.parse(localStorage.getItem('ggomes_notifications') || '[]');
                    
                    // Encontrar a notificação
                    const index = notifications.findIndex(n => n.id === id);
                    
                    if (index === -1) {
                        return false;
                    }
                    
                    // Marcar como lida
                    notifications[index].lida = true;
                    localStorage.setItem('ggomes_notifications', JSON.stringify(notifications));
                    
                    return true;
                },
                
                // Marcar todas as notificações como lidas
                markAllAsRead: function() {
                    const notifications = JSON.parse(localStorage.getItem('ggomes_notifications') || '[]');
                    
                    // Marcar todas como lidas
                    notifications.forEach(n => {
                        n.lida = true;
                    });
                    
                    localStorage.setItem('ggomes_notifications', JSON.stringify(notifications));
                    
                    return true;
                },
                
                // Obter contagem de notificações não lidas
                getUnreadCount: function() {
                    const notifications = JSON.parse(localStorage.getItem('ggomes_notifications') || '[]');
                    return notifications.filter(n => !n.lida).length;
                }
            },
            
            // Módulo de liberações
            liberacoes: {
                // Obter todas as liberações
                getAll: function() {
                    try {
                        const liberacoes = localStorage.getItem('ggomes_liberacoes');
                        return liberacoes ? JSON.parse(liberacoes) : [];
                    } catch (error) {
                        console.error("Erro ao obter liberações:", error);
                        return [];
                    }
                },
                
                // Obter liberação por ID
                get: function(id) {
                    const liberacoes = this.getAll();
                    return liberacoes.find(l => l.id === id);
                },
                
                // Adicionar liberação
                add: function(liberacao) {
                    // Validar dados básicos
                    if (!liberacao.id || !liberacao.frente || !liberacao.fazenda || liberacao.previsto === undefined || liberacao.realizado === undefined || !liberacao.data) {
                        throw new Error('Dados incompletos. Preencha todos os campos obrigatórios.');
                    }
                    
                    // Obter liberações
                    const liberacoes = this.getAll();
                    
                    // Verificar se já existe uma liberação com o mesmo ID
                    if (liberacoes.some(l => l.id === liberacao.id)) {
                        throw new Error(`Já existe uma liberação com o ID "${liberacao.id}".`);
                    }
                    
                    // Calcular restante
                    if (liberacao.restante === undefined) {
                        liberacao.restante = Number(liberacao.previsto) - Number(liberacao.realizado);
                    }
                    
                    // Adicionar data de registro
                    liberacao.dataRegistro = liberacao.dataRegistro || new Date().toISOString();
                    
                    // Adicionar liberação
                    liberacoes.push(liberacao);
                    localStorage.setItem('ggomes_liberacoes', JSON.stringify(liberacoes));
                    
                    return liberacao;
                },
                
                // Atualizar liberação
                update: function(liberacao) {
                    // Validar dados básicos
                    if (!liberacao.id) {
                        throw new Error('ID da liberação é obrigatório.');
                    }
                    
                    // Obter liberações
                    const liberacoes = this.getAll();
                    
                    // Encontrar a liberação a ser atualizada
                    const index = liberacoes.findIndex(l => l.id === liberacao.id);
                    
                    if (index === -1) {
                        throw new Error(`Liberação com ID "${liberacao.id}" não encontrada.`);
                    }
                    
                    // Recalcular o restante se necessário
                    if (liberacao.previsto !== undefined || liberacao.realizado !== undefined) {
                        const previsto = liberacao.previsto !== undefined ? 
                            Number(liberacao.realizado) : 
                            Number(liberacoes[index].realizado);
                        
                        liberacao.restante = previsto - realizado;
                    }
                    
                    // Atualizar liberação
                    liberacoes[index] = { ...liberacoes[index], ...liberacao };
                    localStorage.setItem('ggomes_liberacoes', JSON.stringify(liberacoes));
                    
                    return liberacoes[index];
                },
                
                // Remover liberação
                remove: function(id) {
                    // Obter liberações
                    const liberacoes = this.getAll();
                    
                    // Verificar se a liberação existe
                    const index = liberacoes.findIndex(l => l.id === id);
                    
                    if (index === -1) {
                        throw new Error(`Liberação com ID "${id}" não encontrada.`);
                    }
                    
                    // Remover liberação
                    liberacoes.splice(index, 1);
                    localStorage.setItem('ggomes_liberacoes', JSON.stringify(liberacoes));
                    
                    return true;
                },
                
                // Obter totais
                getTotals: function(filtroFrente = '', filtroFazenda = '') {
                    // Obter liberações
                    let liberacoes = this.getAll();
                    
                    // Aplicar filtros
                    if (filtroFrente) {
                        liberacoes = liberacoes.filter(l => l.frente === filtroFrente);
                    }
                    
                    if (filtroFazenda) {
                        liberacoes = liberacoes.filter(l => l.fazenda === filtroFazenda);
                    }
                    
                    // Calcular totais
                    const totals = {
                        previsto: 0,
                        realizado: 0,
                        restante: 0
                    };
                    
                    liberacoes.forEach(l => {
                        totals.previsto += Number(l.previsto) || 0;
                        totals.realizado += Number(l.realizado) || 0;
                        totals.restante += Number(l.restante) || 0;
                    });
                    
                    return totals;
                },
                
                // Obter frentes e fazendas únicas
                getUniqueValues: function() {
                    const liberacoes = this.getAll();
                    
                    const frentes = new Set();
                    const fazendas = new Set();
                    
                    liberacoes.forEach(l => {
                        frentes.add(l.frente);
                        fazendas.add(l.fazenda);
                    });
                    
                    return {
                        frentes: Array.from(frentes).sort(),
                        fazendas: Array.from(fazendas).sort()
                    };
                }
            }
        };
        
        // Inicializar o banco de dados
        DB.init();
        
        // Utilidades e funções auxiliares
        const Utils = {
            // Formatar número como toneladas
            formatarToneladas: function(valor) {
                const numero = Number(valor) || 0;
                return numero.toLocaleString('pt-BR', { minimumFractionDigits: 1, maximumFractionDigits: 1 }) + ' T';
            },
            
            // Formatar número como percentual
            formatarPercentual: function(valor) {
                const numero = Number(valor) || 0;
                return numero.toLocaleString('pt-BR', { minimumFractionDigits: 1, maximumFractionDigits: 1 }) + '%';
            },
            
            // Formatar número como litros
            formatarLitros: function(valor) {
                const numero = Number(valor) || 0;
                return numero.toLocaleString('pt-BR', { minimumFractionDigits: 0, maximumFractionDigits: 0 }) + ' L';
            },
            
            // Formatar número como rendimento (T/h)
            formatarRendimento: function(valor) {
                const numero = Number(valor) || 0;
                return numero.toLocaleString('pt-BR', { minimumFractionDigits: 1, maximumFractionDigits: 1 }) + ' T/h';
            },
            
            // Formatar data no formato dd/mm/aaaa
            formatarData: function(dataStr) {
                if (!dataStr) return '--/--/----';
                
                const data = new Date(dataStr);
                return data.toLocaleDateString('pt-BR');
            },
            
            // Obter nome do mês (texto)
            obterNomeMes: function(mes) {
                const meses = ['Janeiro', 'Fevereiro', 'Março', 'Abril', 'Maio', 'Junho', 'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'];
                return meses[mes] || '';
            },
            
            // Gerar ID único baseado em um prefixo e timestamp
            gerarId: function(prefixo) {
                return (prefixo || 'id') + '-' + Date.now();
            },
            
            // Mostrar toast de notificação temporário
            exibirToast: function(mensagem, tipo = 'success', duracao = 3000) {
                const toastContainer = document.getElementById('toast-container');
                
                // Criar elemento de toast
                const toast = document.createElement('div');
                toast.className = `toast animate-fade-in p-4 mb-4 rounded-lg shadow-md flex items-center justify-between ${
                    tipo === 'success' ? 'bg-green-100 dark:bg-green-800 text-green-700 dark:text-green-300' :
                    tipo === 'error' ? 'bg-red-100 dark:bg-red-800 text-red-700 dark:text-red-300' :
                    tipo === 'warn' ? 'bg-yellow-100 dark:bg-yellow-800 text-yellow-700 dark:text-yellow-300' :
                    'bg-blue-100 dark:bg-blue-800 text-blue-700 dark:text-blue-300'
                }`;
                
                // Ícone baseado no tipo
                const icone = 
                    tipo === 'success' ? 'fa-check-circle' :
                    tipo === 'error' ? 'fa-exclamation-circle' :
                    tipo === 'warn' ? 'fa-exclamation-triangle' :
                    'fa-info-circle';
                
                toast.innerHTML = `
                    <div class="flex items-center">
                        <i class="fas ${icone} mr-2"></i>
                        <span>${mensagem}</span>
                    </div>
                    <button class="ml-4 text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white focus:outline-none">
                        <i class="fas fa-times"></i>
                    </button>
                `;
                
                // Adicionar evento de fechamento
                toast.querySelector('button').addEventListener('click', () => {
                    toast.classList.add('fade-out');
                    setTimeout(() => {
                        if (toast.parentNode) {
                            toast.parentNode.removeChild(toast);
                        }
                    }, 300);
                });
                
                // Adicionar ao container
                toastContainer.appendChild(toast);
                
                // Remover após a duração especificada
                setTimeout(() => {
                    if (toast.parentNode) {
                        toast.classList.add('fade-out');
                        setTimeout(() => {
                            if (toast.parentNode) {
                                toast.parentNode.removeChild(toast);
                            }
                        }, 300);
                    }
                }, duracao);
            },
            
            // Exportar dados para CSV
            exportarCSV: function(dados, nomeArquivo) {
                if (!dados || !dados.length) {
                    this.exibirToast('Não há dados para exportar', 'error');
                    return;
                }
                
                // Obter cabeçalhos
                const cabecalhos = Object.keys(dados[0]);
                
                // Criar linhas
                const linhas = [
                    cabecalhos.join(','), // Cabeçalhos
                    ...dados.map(item => 
                        cabecalhos.map(cabecalho => {
                            // Formatar valor para CSV (aspas se contiver vírgula ou aspas)
                            let valor = item[cabecalho];
                            
                            if (valor === null || valor === undefined) {
                                valor = '';
                            } else if (typeof valor === 'object') {
                                valor = JSON.stringify(valor);
                            } else {
                                valor = String(valor);
                            }
                            
                            if (valor.includes(',') || valor.includes('"') || valor.includes('\n')) {
                                valor = '"' + valor.replace(/"/g, '""') + '"';
                            }
                            
                            return valor;
                        }).join(',')
                    )
                ];
                
                // Criar blob e download
                const csv = linhas.join('\n');
                const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
                const url = URL.createObjectURL(blob);
                
                const link = document.createElement('a');
                link.setAttribute('href', url);
                link.setAttribute('download', nomeArquivo || 'dados.csv');
                link.style.display = 'none';
                
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            },
            
            // Exportar dados para PDF usando jsPDF e jspdf-autotable
            exportarPDF: function(titulo, dados, colunas, nomeArquivo) {
                if (!window.jspdf || !window.jspdf.jsPDF) {
                    this.exibirToast('Biblioteca PDF não carregada', 'error');
                    return;
                }
                
                if (!dados || !dados.length) {
                    this.exibirToast('Não há dados para exportar', 'error');
                    return;
                }
                
                try {
                    const { jsPDF } = window.jspdf;
                    
                    // Criar documento PDF
                    const doc = new jsPDF();
                    
                    // Adicionar título
                    doc.setFontSize(18);
                    doc.text(titulo, 14, 22);
                    
                    // Adicionar data e hora
                    doc.setFontSize(10);
                    doc.text(`Data: ${new Date().toLocaleDateString('pt-BR')}`, 14, 30);
                    
                    // Adicionar tabela
                    doc.autoTable({
                        head: [colunas.map(col => col.header)],
                        body: dados.map(item => colunas.map(col => {
                            // Obter valor usando a chave ou função personalizada
                            if (typeof col.dataKey === 'function') {
                                return col.dataKey(item);
                            }
                            return item[col.dataKey];
                        })),
                        startY: 35,
                        theme: 'grid',
                        styles: {
                            fontSize: 8,
                            cellPadding: 3
                        },
                        headStyles: {
                            fillColor: [93, 92, 222],
                            textColor: [255, 255, 255],
                            fontStyle: 'bold'
                        },
                        alternateRowStyles: {
                            fillColor: [240, 240, 240]
                        }
                    });
                    
                    // Adicionar rodapé
                    const pageCount = doc.internal.getNumberOfPages();
                    for(let i = 1; i <= pageCount; i++) {
                        doc.setPage(i);
                        doc.setFontSize(8);
                        doc.text(`Página ${i} de ${pageCount} - GGOMES-LOG`, doc.internal.pageSize.width / 2, doc.internal.pageSize.height - 10, { align: 'center' });
                    }
                    
                    // Salvar o documento
                    doc.save(nomeArquivo || 'relatorio.pdf');
                    
                    this.exibirToast('Relatório PDF gerado com sucesso', 'success');
                } catch (error) {
                    console.error('Erro ao gerar PDF:', error);
                    this.exibirToast('Erro ao gerar PDF', 'error');
                }
            }
        };
        
        // *** INICIALIZAÇÃO DA APLICAÇÃO ***
        document.addEventListener('DOMContentLoaded', function() {
            // Configurar tema (claro/escuro)
            configurarTema();
            
            // Navegação entre páginas
            configurarNavegacao();
            
            // Inicializar notificações
            inicializarNotificacoes();
            
            // Inicializar dashboard
            inicializarDashboard();
            
            // Configurar interações do menu lateral móvel
            configurarMenuLateral();
            
            // Configurar data atual no cabeçalho
            atualizarDataAtual();
            
            // Configurar funcionalidades da tela de colhedoras
            inicializarColhedoras();
            
            // Configurar funcionalidades da tela de registros
            inicializarRegistros();
            
            // Configurar funcionalidades da tela de caminhões
            inicializarCaminhoes();
            
            // Configurar funcionalidades da tela de chuvas
            inicializarChuvas();
            
            // Configurar funcionalidades da tela de consumo
            inicializarConsumo();
            
            // Configurar funcionalidades da tela de histórico
            inicializarHistorico();
            
            // Configurar funcionalidades da tela de liberações
            inicializarLiberacoes();
            
            // Configurar funcionalidades da tela de configurações
            inicializarConfiguracoes();
            
            // Adicionar dados de exemplo ao modal se estiver vazio
            adicionarDadosExemplo();
            
            // Mostrar página inicial (dashboard)
            document.getElementById('content-dashboard').classList.remove('hidden');
            document.querySelector('a[href="#dashboard"]').classList.add('active');
        });
        
        // *** FUNÇÕES DE INICIALIZAÇÃO DE COMPONENTES ***
        
        // Configurar tema (claro/escuro)
        function configurarTema() {
            const toggleButton = document.getElementById('toggle-theme');
            
            // Verificar preferência do usuário
            function applyTheme() {
                const config = JSON.parse(localStorage.getItem('ggomes_config') || '{}');
                if (config.temaEscuro) {
                    document.documentElement.classList.add('dark');
                } else {
                    document.documentElement.classList.remove('dark');
                }
            }
            
            // Aplicar tema inicial
            applyTheme();
            
            // Alternar tema ao clicar no botão
            toggleButton.addEventListener('click', function() {
                const config = JSON.parse(localStorage.getItem('ggomes_config') || '{}');
                config.temaEscuro = !config.temaEscuro;
                localStorage.setItem('ggomes_config', JSON.stringify(config));
                
                applyTheme();
            });
            
            // Detectar mudança de tema do sistema
            if (window.matchMedia) {
                window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', function(e) {
                    const config = JSON.parse(localStorage.getItem('ggomes_config') || '{}');
                    config.temaEscuro = e.matches;
                    localStorage.setItem('ggomes_config', JSON.stringify(config));
                    
                    applyTheme();
                });
            }
        }
        
        // Configurar navegação entre páginas
        function configurarNavegacao() {
            const links = document.querySelectorAll('.sidebar-link');
            const contents = document.querySelectorAll('.content');
            
            // Adicionar evento de clique a cada link
            links.forEach(function(link) {
                link.addEventListener('click', function(event) {
                    event.preventDefault();
                    
                    // Obter ID da seção pelo atributo href
                    const targetId = this.getAttribute('href').substring(1);
                    const targetElement = document.getElementById('content-' + targetId);
                    
                    if (targetElement) {
                        // Esconder todos os conteúdos
                        contents.forEach(function(content) {
                            content.classList.add('hidden');
                        });
                        
                        // Remover classe active de todos os links
                        links.forEach(function(lnk) {
                            lnk.classList.remove('active');
                            lnk.classList.remove('bg-primary-100');
                            lnk.classList.remove('dark:bg-primary-900');
                            lnk.classList.remove('text-primary-700');
                            lnk.classList.remove('dark:text-primary-300');
                        });
                        
                        // Mostrar conteúdo alvo
                        targetElement.classList.remove('hidden');
                        
                        // Adicionar classe active ao link clicado
                        this.classList.add('active');
                        this.classList.add('bg-primary-100');
                        this.classList.add('dark:bg-primary-900');
                        this.classList.add('text-primary-700');
                        this.classList.add('dark:text-primary-300');
                        
                        // Fechar menu lateral no móvel após selecionar
                        document.getElementById('app-container').classList.remove('sidebar-open');
                    }
                });
            });
            
            // Configurar navegação por hash na URL
            function handleHashChange() {
                const hash = window.location.hash.substring(1);
                if (hash) {
                    const link = document.querySelector(`.sidebar-link[href="#${hash}"]`);
                    if (link) {
                        link.click();
                    }
                }
            }
            
            // Verificar hash inicial
            handleHashChange();
            
            // Adicionar evento de mudança de hash
            window.addEventListener('hashchange', handleHashChange);
        }
        
        // Inicializar notificações
        function inicializarNotificacoes() {
            const notificationBadge = document.getElementById('notification-badge');
            const notificationsList = document.getElementById('notifications-list');
            const notificationsPanel = document.getElementById('notifications-panel');
            const btnNotifications = document.getElementById('btn-notifications');
            const closeNotifications = document.getElementById('close-notifications');
            const btnClearNotifications = document.getElementById('btn-clear-notifications');
            
            // Atualizar contagem de notificações não lidas
            function atualizarContagemNotificacoes() {
                const count = DB.notifications.getUnreadCount();
                
                if (count > 0) {
                    notificationBadge.textContent = count;
                    notificationBadge.classList.remove('hidden');
                } else {
                    notificationBadge.classList.add('hidden');
                }
            }
            
            // Carregar lista de notificações
            function carregarNotificacoes() {
                const notifications = DB.notifications.getAll();
                
                if (notifications.length === 0) {
                    notificationsList.innerHTML = `
                        <div class="text-center text-gray-500 dark:text-gray-400 py-8">
                            <i class="fas fa-bell-slash text-3xl mb-2"></i>
                            <p>Não há notificações</p>
                        </div>
                    `;
                    return;
                }
                
                // Limpar lista
                notificationsList.innerHTML = '';
                
                // Adicionar cada notificação
                notifications.forEach(function(notification) {
                    const notificationElement = document.createElement('div');
                    notificationElement.className = `notification p-3 rounded-lg border ${
                        notification.lida ? 
                            'bg-gray-50 dark:bg-gray-800 border-gray-200 dark:border-gray-700' : 
                            'bg-blue-50 dark:bg-blue-900/30 border-blue-200 dark:border-blue-800'
                    }`;
                    
                    // Determinar ícone baseado no tipo
                    let iconClass = 'fa-info-circle text-blue-500';
                    if (notification.tipo === 'success') {
                        iconClass = 'fa-check-circle text-green-500';
                    } else if (notification.tipo === 'error') {
                        iconClass = 'fa-exclamation-circle text-red-500';
                    } else if (notification.tipo === 'warn') {
                        iconClass = 'fa-exclamation-triangle text-yellow-500';
                    }
                    
                    // Formatar data
                    const data = new Date(notification.dataHora);
                    const dataFormatada = data.toLocaleDateString('pt-BR') + ' ' + 
                                          data.toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' });
                    
                    notificationElement.innerHTML = `
                        <div class="flex items-start">
                            <div class="flex-shrink-0 mr-3">
                                <i class="fas ${iconClass} text-lg"></i>
                            </div>
                            <div class="flex-1">
                                <h4 class="text-sm font-semibold text-gray-900 dark:text-white">${notification.titulo}</h4>
                                <p class="text-sm text-gray-600 dark:text-gray-400">${notification.mensagem}</p>
                                <div class="flex items-center mt-1 text-xs text-gray-500 dark:text-gray-500">
                                    <span>${dataFormatada}</span>
                                    <button data-id="${notification.id}" class="btn-mark-read ml-auto px-2 py-1 rounded hover:bg-gray-200 dark:hover:bg-gray-700 ${notification.lida ? 'hidden' : ''}">
                                        Marcar como lida
                                    </button>
                                </div>
                            </div>
                        </div>
                    `;
                    
                    notificationsList.appendChild(notificationElement);
                    
                    // Adicionar evento aos botões
                    const markReadBtn = notificationElement.querySelector('.btn-mark-read');
                    if (markReadBtn) {
                        markReadBtn.addEventListener('click', function() {
                            const notificationId = this.getAttribute('data-id');
                            DB.notifications.markAsRead(notificationId);
                            atualizarContagemNotificacoes();
                            carregarNotificacoes();
                        });
                    }
                });
            }
            
            // Abrir painel de notificações
            btnNotifications.addEventListener('click', function() {
                notificationsPanel.classList.toggle('translate-x-full');
                carregarNotificacoes();
            });
            
            // Fechar painel de notificações
            closeNotifications.addEventListener('click', function() {
                notificationsPanel.classList.add('translate-x-full');
            });
            
            // Marcar todas como lidas
            btnClearNotifications.addEventListener('click', function() {
                DB.notifications.markAllAsRead();
                atualizarContagemNotificacoes();
                carregarNotificacoes();
                Utils.exibirToast('Todas as notificações foram marcadas como lidas', 'success');
            });
            
            // Carregar inicialmente
            atualizarContagemNotificacoes();
        }
        
        // Configurar menu lateral (mobile)
        function configurarMenuLateral() {
            const menuToggle = document.getElementById('mobile-menu-toggle');
            const appContainer = document.getElementById('app-container');
            
            menuToggle.addEventListener('click', function() {
                appContainer.classList.toggle('sidebar-open');
            });
            
            // Fechar menu ao clicar fora (apenas em mobile)
            document.addEventListener('click', function(event) {
                if (window.innerWidth <= 768 && 
                    appContainer.classList.contains('sidebar-open') && 
                    !event.target.closest('aside') && 
                    !event.target.closest('#mobile-menu-toggle')) {
                    appContainer.classList.remove('sidebar-open');
                }
            });
        }
        
        // Atualizar data atual
        function atualizarDataAtual() {
            const currentDateElement = document.getElementById('current-date');
            const date = new Date();
            currentDateElement.textContent = date.toLocaleDateString('pt-BR');
            
            // Simular informações meteorológicas
            const weatherIcon = document.getElementById('weather-icon');
            const weatherTemp = document.getElementById('weather-temp');
            
            // Gerar temperatura aleatória entre 18 e 32
            const temperatura = Math.floor(Math.random() * (32 - 18 + 1)) + 18;
            
            // Definir ícone com base na hora do dia e temperatura
            const hour = date.getHours();
            let icon = '';
            
            if (hour >= 6 && hour < 18) {
                if (temperatura > 28) {
                    icon = '<i class="fas fa-sun icon-sun"></i>';
                } else if (temperatura > 22) {
                    icon = '<i class="fas fa-cloud-sun"></i>';
                } else {
                    icon = '<i class="fas fa-cloud"></i>';
                }
            } else {
                if (temperatura > 25) {
                    icon = '<i class="fas fa-moon"></i>';
                } else {
                    icon = '<i class="fas fa-cloud-moon"></i>';
                }
            }
            
            weatherIcon.innerHTML = icon;
            weatherTemp.textContent = `${temperatura}°C`;
        }
        
        // *** FUNÇÕES DO DASHBOARD ***
        function inicializarDashboard() {
            // Configurar tabs do dashboard
            const dashboardTabs = document.querySelectorAll('.dashboard-tab');
            const dashboardContents = document.querySelectorAll('.dashboard-tab-content');
            
            dashboardTabs.forEach(function(tab) {
                tab.addEventListener('click', function() {
                    const tabTarget = this.getAttribute('data-tab');
                    
                    // Remover classe ativa de todas as tabs
                    dashboardTabs.forEach(function(t) {
                        t.classList.remove('tab-active');
                    });
                    
                    // Esconder todos os conteúdos
                    dashboardContents.forEach(function(content) {
                        content.classList.add('hidden');
                    });
                    
                    // Ativar a tab clicada
                    this.classList.add('tab-active');
                    
                    // Mostrar o conteúdo correspondente
                    document.getElementById('tab-' + tabTarget).classList.remove('hidden');
                    
                    // Inicializar gráficos se necessário
                    atualizarGraficosDashboard();
                });
            });
            
            // Configurar dropdown de período
            const periodSelect = document.getElementById('dashboard-period');
            periodSelect.addEventListener('change', function() {
                atualizarDashboard();
            });
            
            // Botão de atualizar dashboard
            document.getElementById('refresh-dashboard').addEventListener('click', function() {
                atualizarDashboard();
                Utils.exibirToast('Dashboard atualizado com sucesso', 'success');
            });
            
            // Inicializar dashboard pela primeira vez
            atualizarDashboard();
            
            // Configurar exportação de médias dos equipamentos
            document.querySelector('.btn-exportar-equipamentos').addEventListener('click', function() {
                const estatisticas = DB.registros.getEquipmentStats();
                const colhedoras = DB.colhedoras.getAll();
                
                // Adicionar nomes das colhedoras às estatísticas
                const dadosParaExportar = estatisticas.map(stat => {
                    const colhedora = colhedoras.find(c => c.id === stat.id) || {};
                    return {
                        id: stat.id,
                        marca: colhedora.marca || '',
                        modelo: colhedora.modelo || '',
                        totalColhido: stat.quantidade.toFixed(1),
                        rendimento: stat.rendimento.toFixed(1),
                        mediaDiaria: stat.mediaDiaria.toFixed(1),
                        diasDeTrabalho: stat.diasUnicos
                    };
                });
                
                // Definir colunas para o relatório
                const colunas = [
                    { header: 'ID', dataKey: 'id' },
                    { header: 'Marca', dataKey: 'marca' },
                    { header: 'Modelo', dataKey: 'modelo' },
                    { header: 'Total Colhido (T)', dataKey: 'totalColhido' },
                    { header: 'Rendimento (T/h)', dataKey: 'rendimento' },
                    { header: 'Média Diária (T/dia)', dataKey: 'mediaDiaria' },
                    { header: 'Dias de Trabalho', dataKey: 'diasDeTrabalho' }
                ];
                
                // Exportar para PDF
                Utils.exportarPDF(
                    'Relatório de Médias dos Equipamentos',
                    dadosParaExportar,
                    colunas,
                    'relatorio_equipamentos.pdf'
                );
            });
        }
        
        // Atualizar dados do dashboard
        function atualizarDashboard() {
            // Obter período selecionado
            const periodo = document.getElementById('dashboard-period').value;
            const dias = parseInt(periodo) || 0;
            
            // Carregar dados básicos
            carregarDadosBasicos(dias);
            
            // Carregar informações de produção
            carregarInfoProducao(dias);
            
            // Carregar comparativos por colhedora
            carregarComparativoColhedoras(dias);
            
            // Carregar estatísticas de culturas
            carregarEstatisticasCulturas(dias);
            
            // Carregar tabela de médias de equipamentos
            carregarTabelaMediasEquipamentos();
            
            // Inicializar outros dados específicos das tabs
            carregarDadosCaminhoes(dias);
            carregarDadosChuvas(dias);
            carregarDadosConsumos(dias);
            carregarDadosEstatisticas(dias);
            
            // Atualizar gráficos
            atualizarGraficosDashboard();
        }
        
        // Carregar dados básicos do dashboard
        function carregarDadosBasicos(dias) {
            // Obter todos os registros ou filtrados por período
            let registros = DB.registros.getAll();
            
            if (dias > 0) {
                const dataLimite = new Date();
                dataLimite.setDate(dataLimite.getDate() - dias);
                const dataLimiteStr = dataLimite.toISOString().split('T')[0];
                
                registros = registros.filter(r => r.data >= dataLimiteStr);
            }
            
            // Calcular total colhido
            const totalColhido = registros.reduce((total, registro) => {
                return total + Number(registro.quantidade || 0);
            }, 0);
            
            // Calcular total de horas
            const totalHoras = registros.reduce((total, registro) => {
                return total + Number(registro.horas || 0);
            }, 0);
            
            // Obter datas únicas de registro
            const datasUnicas = new Set(registros.map(r => r.data));
            const diasDeTrabalho = datasUnicas.size;
            
            // Calcular médias
            const mediaGeral = diasDeTrabalho > 0 ? totalColhido / diasDeTrabalho : 0;
            const mediaHora = totalHoras > 0 ? totalColhido / totalHoras : 0;
            
            // Obter dados de chuva
            const totalDiasParados = DB.chuvas.getTotalDias();
            
            // Simular tendências (em situação real seriam comparadas com período anterior)
            const trendTotal = Math.floor(Math.random() * 20) - 5; // Entre -5% e +15%
            const trendMedia = Math.floor(Math.random() * 15) - 3; // Entre -3% e +12%
            const trendMediaDia = Math.floor(Math.random() * 18) - 4; // Entre -4% e +14%
            const trendParadas = Math.floor(Math.random() * 10) - 8; // Entre -8% e +2%
            
            // Atualizar valores nos elementos do dashboard
            document.getElementById('dash-total-colhido').textContent = Utils.formatarToneladas(totalColhido);
            document.getElementById('dash-media-geral').textContent = Utils.formatarToneladas(mediaGeral) + '/dia';
            document.getElementById('dash-media-dia').textContent = Utils.formatarToneladas(mediaHora) + '/h';
            document.getElementById('dash-paradas-chuva').textContent = totalDiasParados + ' dias';
            
            // Atualizar indicadores rápidos no cabeçalho
            document.getElementById('quick-total-colhido').textContent = Utils.formatarToneladas(totalColhido);
            document.getElementById('quick-colhedoras').textContent = DB.colhedoras.getAll().length;
            document.getElementById('quick-paradas-chuva').textContent = totalDiasParados + ' dias';
            
            // Atualizar tendências
            document.getElementById('dash-total-trend').innerHTML = updateTrendIndicator(trendTotal);
            document.getElementById('dash-media-trend').innerHTML = updateTrendIndicator(trendMedia);
            document.getElementById('dash-media-dia-trend').innerHTML = updateTrendIndicator(trendMediaDia);
            document.getElementById('dash-paradas-trend').innerHTML = updateTrendIndicator(-trendParadas, true);
            
            // Atualizar barras de progresso
            document.getElementById('dash-total-progress').style.width = `${Math.abs(trendTotal) * 5}%`;
            document.getElementById('dash-media-progress').style.width = `${Math.abs(trendMedia) * 5}%`;
            document.getElementById('dash-media-dia-progress').style.width = `${Math.abs(trendMediaDia) * 5}%`;
            document.getElementById('dash-paradas-progress').style.width = `${Math.abs(trendParadas) * 5}%`;
            
            // Ajustar classes de cores das barras de progresso
            adjustProgressBarColor('dash-total-progress', trendTotal);
            adjustProgressBarColor('dash-media-progress', trendMedia);
            adjustProgressBarColor('dash-media-dia-progress', trendMediaDia);
            adjustProgressBarColor('dash-paradas-progress', -trendParadas);
            
            // Funções auxiliares para tendências
            function updateTrendIndicator(value, invertido = false) {
                const isPositive = invertido ? value < 0 : value > 0;
                const icon = isPositive ? 
                    '<i class="fas fa-arrow-up mr-1 text-green-500"></i>' : 
                    '<i class="fas fa-arrow-down mr-1 text-red-500"></i>';
                
                return `${icon}<span>${Math.abs(value)}% vs. período anterior</span>`;
            }
            
            function adjustProgressBarColor(elementId, trend) {
                const element = document.getElementById(elementId);
                
                // Remover classes existentes
                element.classList.remove('bg-green-500', 'bg-red-500', 'bg-yellow-500');
                
                // Adicionar classe apropriada
                if (trend > 0) {
                    element.classList.add('bg-green-500');
                } else if (trend < 0) {
                    element.classList.add('bg-red-500');
                } else {
                    element.classList.add('bg-yellow-500');
                }
            }
            
            // Carregar dados de produção do dia atual
            carregarProducaoDia();
        }
        
        // Carregar informações de produção do dia
        function carregarProducaoDia() {
            const hoje = new Date().toISOString().split('T')[0]; // Formato YYYY-MM-DD
            
            // Filtrar registros de hoje
            const registrosHoje = DB.registros.getAll().filter(r => r.data === hoje);
            
            // Calcular total colhido hoje
            const totalHoje = registrosHoje.reduce((total, registro) => {
                return total + Number(registro.quantidade || 0);
            }, 0);
            
            // Calcular total de horas hoje
            const horasHoje = registrosHoje.reduce((total, registro) => {
                return total + Number(registro.horas || 0);
            }, 0);
            
            // Calcular média por hora
            const mediaHora = horasHoje > 0 ? totalHoje / horasHoje : 0;
            
            // Atualizar cards
            document.getElementById('producao-hoje-total').textContent = Utils.formatarToneladas(totalHoje);
            document.getElementById('producao-hoje-hora').textContent = Utils.formatarRendimento(mediaHora);
        }
        
        // Carregar informações de produção (melhores desempenhos)
        function carregarInfoProducao(dias) {
            // Obter estatísticas de equipamentos
            const statsEquipamentos = DB.registros.getEquipmentStats();
            const colhedoras = DB.colhedoras.getAll();
            
            // Encontrar colhedora com melhor rendimento
            const melhorRendimento = [...statsEquipamentos].sort((a, b) => b.rendimento - a.rendimento)[0];
            
            // Encontrar colhedora com maior volume
            const maiorVolume = [...statsEquipamentos].sort((a, b) => b.quantidade - a.quantidade)[0];
            
            // Encontrar colhedora com melhor média diária
            const melhorMedia = [...statsEquipamentos].sort((a, b) => b.mediaDiaria - a.mediaDiaria)[0];
            
            // Obter nomes das colhedoras
            function getNomeColhedora(id) {
                const colhedora = colhedoras.find(c => c.id === id);
                return colhedora ? (colhedora.marca + ' ' + colhedora.modelo) : id;
            }
            
            // Atualizar cards de melhores colhedoras
            if (melhorRendimento) {
                document.getElementById('best-yield-colhedora').textContent = getNomeColhedora(melhorRendimento.id);
                document.getElementById('best-yield-value').textContent = Utils.formatarRendimento(melhorRendimento.rendimento);
            }
            
            if (maiorVolume) {
                document.getElementById('best-volume-colhedora').textContent = getNomeColhedora(maiorVolume.id);
                document.getElementById('best-volume-value').textContent = Utils.formatarToneladas(maiorVolume.quantidade);
            }
            
            if (melhorMedia) {
                document.getElementById('best-daily-colhedora').textContent = getNomeColhedora(melhorMedia.id);
                document.getElementById('best-daily-value').textContent = Utils.formatarToneladas(melhorMedia.mediaDiaria) + '/dia';
            }
            
            // Fazer o mesmo para culturas
            const statsCulturas = DB.registros.getCultureStats();
            
            // Encontrar cultura com melhor rendimento
            const melhorRendimentoCultura = [...statsCulturas].sort((a, b) => b.rendimento - a.rendimento)[0];
            
            // Encontrar cultura com maior volume
            const maiorVolumeCultura = [...statsCulturas].sort((a, b) => b.quantidade - a.quantidade)[0];
            
            // Encontrar cultura com melhor média diária
            const melhorMediaCultura = [...statsCulturas].sort((a, b) => b.mediaDiaria - a.mediaDiaria)[0];
            
            // Atualizar cards de melhores culturas
            if (melhorRendimentoCultura) {
                document.getElementById('best-yield-cultura').textContent = melhorRendimentoCultura.cultura;
                document.getElementById('best-yield-cultura-value').textContent = Utils.formatarRendimento(melhorRendimentoCultura.rendimento);
            }
            
            if (maiorVolumeCultura) {
                document.getElementById('best-volume-cultura').textContent = maiorVolumeCultura.cultura;
                document.getElementById('best-volume-cultura-value').textContent = Utils.formatarToneladas(maiorVolumeCultura.quantidade);
            }
            
            if (melhorMediaCultura) {
                document.getElementById('best-daily-cultura').textContent = melhorMediaCultura.cultura;
                document.getElementById('best-daily-cultura-value').textContent = Utils.formatarToneladas(melhorMediaCultura.mediaDiaria) + '/dia';
            }
        }
        
        // Carregar tabela de médias dos equipamentos
        function carregarTabelaMediasEquipamentos() {
            const tabelaElement = document.getElementById('tabela-medias-equipamentos');
            const colhedoras = DB.colhedoras.getAll();
            const statsEquipamentos = DB.registros.getEquipmentStats();
            
            // Limpar tabela
            tabelaElement.innerHTML = '';
            
            if (statsEquipamentos.length === 0) {
                tabelaElement.innerHTML = `
                    <tr>
                        <td colspan="4" class="px-4 py-3 text-center text-gray-500 dark:text-gray-400">
                            Nenhum registro encontrado
                        </td>
                    </tr>
                `;
                return;
            }
            
            // Ordenar por rendimento (maior para menor)
            const statsOrdenados = [...statsEquipamentos].sort((a, b) => b.rendimento - a.rendimento);
            
            // Adicionar cada linha
            statsOrdenados.forEach(stat => {
                const colhedora = colhedoras.find(c => c.id === stat.id) || { marca: '', modelo: '' };
                const nomeColhedora = `${colhedora.marca} ${colhedora.modelo} (${stat.id})`;
                
                // Calcular eficiência (% do melhor rendimento)
                const maxRendimento = statsOrdenados[0].rendimento;
                const eficiencia = maxRendimento > 0 ? (stat.rendimento / maxRendimento) * 100 : 0;
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="px-4 py-3 text-gray-700 dark:text-gray-300">${nomeColhedora}</td>
                    <td class="px-4 py-3 text-right text-gray-700 dark:text-gray-300">${Utils.formatarToneladas(stat.mediaDiaria)}/dia</td>
                    <td class="px-4 py-3 text-right text-gray-700 dark:text-gray-300">${Utils.formatarRendimento(stat.rendimento)}</td>
                    <td class="px-4 py-3 text-right">
                        <div class="flex items-center justify-end">
                            <span class="mr-2 text-sm font-medium text-gray-700 dark:text-gray-300">${eficiencia.toFixed(0)}%</span>
                            <div class="w-20 bg-gray-200 dark:bg-gray-700 rounded-full h-2">
                                <div class="bg-primary-600 h-2 rounded-full" style="width: ${eficiencia}%"></div>
                            </div>
                        </div>
                    </td>
                `;
                
                tabelaElement.appendChild(row);
            });
        }
        
        // Carregar comparativo de colhedoras
        function carregarComparativoColhedoras(dias) {
            // Os dados serão usados para criar gráficos
        }
        
        // Carregar estatísticas de culturas
        function carregarEstatisticasCulturas(dias) {
            // Os dados serão usados para criar gráficos
        }
        
        // Função para criar e atualizar gráficos
        function atualizarGraficosDashboard() {
            // Verificar se Charts.js está disponível
            if (!window.Chart) {
                console.error('Chart.js não encontrado. Os gráficos não serão renderizados.');
                return;
            }
            
            // Destruir gráficos existentes para recriá-los
            const chartsToDestroy = [
                'chart-culturas', 
                'chart-colhedoras-comparacao', 
                'chart-producao-tempo', 
                'chart-caminhoes-tipo', 
                'chart-caminhoes-tempo', 
                'chart-paradas-mes', 
                'chart-paradas-intensidade',
                'chart-consumo-equipamento',
                'chart-evolucao-consumo'
            ];
            
            chartsToDestroy.forEach(chartId => {
                const chartCanvas = document.getElementById(chartId);
                if (chartCanvas) {
                    const chartInstance = Chart.getChart(chartCanvas);
                    if (chartInstance) {
                        chartInstance.destroy();
                    }
                }
            });
            
            // Criar gráficos
            criarGraficoCulturas();
            criarGraficoColhedorasComparacao();
            criarGraficoProducaoTempo();
            criarGraficoCaminhoes();
            criarGraficoParadasChuva();
            criarGraficoConsumo();
        }
        
        // Criar gráfico de distribuição por cultura
        function criarGraficoCulturas() {
            const ctx = document.getElementById('chart-culturas');
            if (!ctx) return;
            
            const statsCulturas = DB.registros.getCultureStats();
            
            // Preparar dados para o gráfico
            const labels = statsCulturas.map(stat => stat.cultura);
            const data = statsCulturas.map(stat => stat.quantidade);
            
            // Gerar cores para cada cultura
            const colors = [
                'rgba(93, 92, 222, 0.8)',
                'rgba(54, 162, 235, 0.8)',
                'rgba(75, 192, 192, 0.8)',
                'rgba(255, 159, 64, 0.8)',
                'rgba(255, 99, 132, 0.8)',
                'rgba(153, 102, 255, 0.8)',
                'rgba(255, 205, 86, 0.8)',
                'rgba(201, 203, 207, 0.8)'
            ];
            
            // Criar gráfico
            new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: labels,
                    datasets: [{
                        data: data,
                        backgroundColor: colors.slice(0, labels.length),
                        borderColor: colors.slice(0, labels.length).map(c => c.replace('0.8', '1')),
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                color: document.documentElement.classList.contains('dark') ? 'white' : 'black',
                                font: {
                                    size: 11
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // Criar gráfico de comparação de colhedoras
        function criarGraficoColhedorasComparacao() {
            const ctx = document.getElementById('chart-colhedoras-comparacao');
            if (!ctx) return;
            
            const statsEquipamentos = DB.registros.getEquipmentStats();
            const colhedoras = DB.colhedoras.getAll();
            
            // Preparar dados para o gráfico
            const datasets = [
                {
                    label: 'Quantidade (T)',
                    data: statsEquipamentos.map(stat => stat.quantidade),
                    backgroundColor: 'rgba(93, 92, 222, 0.5)',
                    borderColor: 'rgba(93, 92, 222, 1)',
                    borderWidth: 1,
                    yAxisID: 'y'
                },
                {
                    label: 'Rendimento (T/h)',
                    data: statsEquipamentos.map(stat => stat.rendimento),
                    backgroundColor: 'rgba(255, 159, 64, 0.5)',
                    borderColor: 'rgba(255, 159, 64, 1)',
                    borderWidth: 1,
                    type: 'line',
                    yAxisID: 'y1'
                }
            ];
            
            // Criar rótulos com marca/modelo
            const labels = statsEquipamentos.map(stat => {
                const colhedora = colhedoras.find(c => c.id === stat.id) || {};
                return colhedora.marca ? `${colhedora.marca} ${colhedora.modelo}` : stat.id;
            });
            
            // Criar gráfico
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: datasets
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Quantidade (T)',
                                color: document.documentElement.classList.contains('dark') ? 'white' : 'black'
                            },
                            ticks: {
                                color: document.documentElement.classList.contains('dark') ? 'white' : 'black'
                            },
                            grid: {
                                color: document.documentElement.classList.contains('dark') ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)'
                            }
                        },
                        y1: {
                            beginAtZero: true,
                            position: 'right',
                            title: {
                                display: true,
                                text: 'Rendimento (T/h)',
                                color: document.documentElement.classList.contains('dark') ? 'white' : 'black'
                            },
                            ticks: {
                                color: document.documentElement.classList.contains('dark') ? 'white' : 'black'
                            },
                            grid: {
                                drawOnChartArea: false
                            }
                        },
                        x: {
                            ticks: {
                                color: document.documentElement.classList.contains('dark') ? 'white' : 'black'
                            },
                            grid: {
                                color: document.documentElement.classList.contains('dark') ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            labels: {
                                color: document.documentElement.classList.contains('dark') ? 'white' : 'black'
                            }
                        }
                    }
                }
            });
        }
        
        // Criar gráfico de produção ao longo do tempo
        function criarGraficoProducaoTempo() {
            const ctx = document.getElementById('chart-producao-tempo');
            if (!ctx) return;
            
            // Obter período selecionado
            const periodo = document.getElementById('dashboard-period').value;
            const dias = parseInt(periodo) || 30;
            
            // Obter estatísticas diárias
            const statsDiarias = DB.registros.getDailyStats(dias);
            
            // Preparar dados para o gráfico
            const labels = statsDiarias.map(stat => Utils.formatarData(stat.data));
            const datasets = [
                {
                    label: 'Produção Diária (T)',
                    data: statsDiarias.map(stat => stat.quantidade),
                    backgroundColor: 'rgba(93, 92, 222, 0.5)',
                    borderColor: 'rgba(93, 92, 222, 1)',
                    borderWidth: 1,
                    fill: true
                }
            ];
            
            // Criar gráfico
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: datasets
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Produção (T)',
                                color: document.documentElement.classList.contains('dark') ? 'white' : 'black'
                            },
                            ticks: {
                                color: document.documentElement.classList.contains('dark') ? 'white' : 'black'
                            },
                            grid: {
                                color: document.documentElement.classList.contains('dark') ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)'
                            }
                        },
                        x: {
                            ticks: {
                                color: document.documentElement.classList.contains('dark') ? 'white' : 'black',
                                maxRotation: 45,
                                minRotation: 45
                            },
                            grid: {
                                color: document.documentElement.classList.contains('dark') ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            labels: {
                                color: document.documentElement.classList.contains('dark') ? 'white' : 'black'
                            }
                        }
                    }
                }
            });
        }
        
        // Carregar dados de caminhões
        function carregarDadosCaminhoes(dias) {
            const statsCaminhoes = DB.caminhoes.getStats();
            
            // Atualizar cards
            document.getElementById('dash-total-caminhoes').textContent = DB.veiculosCadastrados.getAll().length;
            document.getElementById('dash-tempo-campo').textContent = Math.round(statsCaminhoes.mediaTempoCampo) + ' min';
            document.getElementById('dash-tempo-patio').textContent = Math.round(statsCaminhoes.mediaTempoPatio) + ' min';
            document.getElementById('dash-producao-transportada').textContent = Utils.formatarToneladas(statsCaminhoes.totalProducao);
        }
        
        // Criar gráficos de caminhões
        function criarGraficoCaminhoes() {
            // Gráfico por tipo de caminhão
            const ctxTipo = document.getElementById('chart-caminhoes-tipo');
            if (ctxTipo) {
                const statsCaminhoes = DB.caminhoes.getStats();
                
                // Dados para o gráfico
                const data = {
                    labels: ['Próprios', 'Terceiros'],
                    datasets: [{
                        data: [statsCaminhoes.proprios.producao, statsCaminhoes.terceiros.producao],
                        backgroundColor: ['rgba(54, 162, 235, 0.7)', 'rgba(75, 192, 192, 0.7)'],
                        borderColor: ['rgb(54, 162, 235)', 'rgb(75, 192, 192)'],
                        borderWidth: 1
                    }]
                };
                
                // Criar gráfico
                new Chart(ctxTipo, {
                    type: 'bar',
                    data: data,
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: 'Produção (T)',
                                    color: document.documentElement.classList.contains('dark') ? 'white' : 'black'
                                },
                                ticks: {
                                    color: document.documentElement.classList.contains('dark') ? 'white' : 'black'
                                },
                                grid: {
                                    color: document.documentElement.classList.contains('dark') ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)'
                                }
                            },
                            x: {
                                ticks: {
                                    color: document.documentElement.classList.contains('dark') ? 'white' : 'black'
                                },
                                grid: {
                                    color: document.documentElement.classList.contains('dark') ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)'
                                }
                            }
                        },
                        plugins: {
                            legend: {
                                display: false
                            }
                        }
                    }
                });
            }
            
            // Gráfico de tempo por caminhão
            const ctxTempo = document.getElementById('chart-caminhoes-tempo');
            if (ctxTempo) {
                const viagens = DB.caminhoes.getAll();
                const veiculos = DB.veiculosCadastrados.getAll();
                
                // Agrupar por caminhão
                const caminhoes = {};
                
                viagens.forEach(viagem => {
                    if (!caminhoes[viagem.caminhaoId]) {
                        const veiculo = veiculos.find(v => v.id === viagem.caminhaoId) || {};
                        caminhoes[viagem.caminhaoId] = {
                            id: viagem.caminhaoId,
                            placa: veiculo.placa || 'N/A',
                            modelo: veiculo.modelo || 'Desconhecido',
                            tempoCampo: 0,
                            tempoPatio: 0,
                            viagens: 0
                        };
                    }
                    
                    caminhoes[viagem.caminhaoId].tempoCampo += Number(viagem.tempoCampo || 0);
                    caminhoes[viagem.caminhaoId].tempoPatio += Number(viagem.tempoPatio || 0);
                    caminhoes[viagem.caminhaoId].viagens += 1;
                });
                
                // Calcular médias
                Object.values(caminhoes).forEach(caminhao => {
                    if (caminhao.viagens > 0) {
                        caminhao.mediaCampo = caminhao.tempoCampo / caminhao.viagens;
                        caminhao.mediaPatio = caminhao.tempoPatio / caminhao.viagens;
                    }
                });
                
                // Ordenar por tempo total (campo + pátio)
                const caminhoesOrdenados = Object.values(caminhoes)
                    .sort((a, b) => (b.mediaCampo + b.mediaPatio) - (a.mediaCampo + a.mediaPatio))
                    .slice(0, 5); // Limitar a 5 para melhor visualização
                
                // Dados para o gráfico
                const data = {
                    labels: caminhoesOrdenados.map(c => `${c.placa}`),
                    datasets: [
                        {
                            label: 'Tempo Campo (min)',
                            data: caminhoesOrdenados.map(c => c.mediaCampo),
                            backgroundColor: 'rgba(54, 162, 235, 0.7)',
                            borderColor: 'rgb(54, 162, 235)',
                            borderWidth: 1
                        },
                        {
                            label: 'Tempo Pátio (min)',
                            data: caminhoesOrdenados.map(c => c.mediaPatio),
                            backgroundColor: 'rgba(75, 192, 192, 0.7)',
                            borderColor: 'rgb(75, 192, 192)',
                            borderWidth: 1
                        }
                    ]
                };
                
                // Criar gráfico
                new Chart(ctxTempo, {
                    type: 'bar',
                    data: data,
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: 'Tempo Médio (min)',
                                    color: document.documentElement.classList.contains('dark') ? 'white' : 'black'
                                },
                                ticks: {
                                    color: document.documentElement.classList.contains('dark') ? 'white' : 'black'
                                },
                                grid: {
                                    color: document.documentElement.classList.contains('dark') ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)'
                                },
                                stacked: true
                            },
                            x: {
                                ticks: {
                                    color: document.documentElement.classList.contains('dark') ? 'white' : 'black'
                                },
                                grid: {
                                    color: document.documentElement.classList.contains('dark') ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)'
                                },
                                stacked: true
                            }
                        },
                        plugins: {
                            legend: {
                                labels: {
                                    color: document.documentElement.classList.contains('dark') ? 'white' : 'black'
                                }
                            }
                        }
                    }
                });
            }
        }
        
        // Carregar dados de chuvas
        function carregarDadosChuvas(dias) {
            const totalDiasParados = DB.chuvas.getTotalDias();
            const impactoEstimado = DB.chuvas.calcularImpactoEstimado();
            const ultimaChuva = DB.chuvas.getLastChuva();
            const totalRegistros = DB.chuvas.getAll().length;
            
            // Atualizar cards
            document.getElementById('dash-total-dias-parados').textContent = totalDiasParados + ' dias';
            document.getElementById('dash-impacto-estimado').textContent = Utils.formatarToneladas(impactoEstimado);
            document.getElementById('dash-ultima-parada').textContent = ultimaChuva ? Utils.formatarData(ultimaChuva.dataFim) : '--/--/----';
            document.getElementById('dash-total-registros-chuva').textContent = totalRegistros;
        }
        
        // Criar gráficos de chuvas
        function criarGraficoParadasChuva() {
            // Gráfico de dias parados por mês
            const ctxMes = document.getElementById('chart-paradas-mes');
            if (ctxMes) {
                const chuvas = DB.chuvas.getAll();
                
                // Agrupar por mês
                const mesesMap = {};
                
                chuvas.forEach(chuva => {
                    const dataInicio = new Date(chuva.dataInicio);
                    const mes = dataInicio.getMonth();
                    const ano = dataInicio.getFullYear();
                    const chave = `${ano}-${mes}`;
                    
                    if (!mesesMap[chave]) {
                        mesesMap[chave] = {
                            nome: Utils.obterNomeMes(mes) + '/' + ano,
                            dias: 0,
                            ordem: ano * 12 + mes // Para ordenação
                        };
                    }
                    
                    mesesMap[chave].dias += Number(chuva.dias || 0);
                });
                
                // Ordenar por data
                const mesesOrdenados = Object.values(mesesMap).sort((a, b) => a.ordem - b.ordem);
                
                // Dados para o gráfico
                const data = {
                    labels: mesesOrdenados.map(m => m.nome),
                    datasets: [{
                        label: 'Dias Parados',
                        data: mesesOrdenados.map(m => m.dias),
                        backgroundColor: 'rgba(54, 162, 235, 0.7)',
                        borderColor: 'rgb(54, 162, 235)',
                        borderWidth: 1
                    }]
                };
                
                // Criar gráfico
                new Chart(ctxMes, {
                    type: 'bar',
                    data: data,
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: 'Dias',
                                    color: document.documentElement.classList.contains('dark') ? 'white' : 'black'
                                },
                                ticks: {
                                    color: document.documentElement.classList.contains('dark') ? 'white' : 'black'
                                },
                                grid: {
                                    color: document.documentElement.classList.contains('dark') ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)'
                                }
                            },
                            x: {
                                ticks: {
                                    color: document.documentElement.classList.contains('dark') ? 'white' : 'black'
                                },
                                grid: {
                                    color: document.documentElement.classList.contains('dark') ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)'
                                }
                            }
                        },
                        plugins: {
                            legend: {
                                display: false
                            }
                        }
                    }
                });
            }
            
            // Gráfico de distribuição por intensidade
            const ctxIntensidade = document.getElementById('chart-paradas-intensidade');
            if (ctxIntensidade) {
                const chuvas = DB.chuvas.getAll();
                
                // Agrupar por intensidade
                const intensidades = {
                    baixa: 0,
                    media: 0,
                    alta: 0
                };
                
                chuvas.forEach(chuva => {
                    intensidades[chuva.intensidade] = (intensidades[chuva.intensidade] || 0) + Number(chuva.dias || 0);
                });
                
                // Dados para o gráfico
                const data = {
                    labels: ['Baixa', 'Média', 'Alta'],
                    datasets: [{
                        data: [intensidades.baixa, intensidades.media, intensidades.alta],
                        backgroundColor: ['rgba(75, 192, 192, 0.7)', 'rgba(255, 205, 86, 0.7)', 'rgba(255, 99, 132, 0.7)'],
                        borderColor: ['rgb(75, 192, 192)', 'rgb(255, 205, 86)', 'rgb(255, 99, 132)'],
                        borderWidth: 1
                    }]
                };
                
                // Criar gráfico
                new Chart(ctxIntensidade, {
                    type: 'pie',
                    data: data,
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    color: document.documentElement.classList.contains('dark') ? 'white' : 'black'
                                }
                            },
                            title: {
                                display: false,
                                text: 'Distribuição por Intensidade',
                                color: document.documentElement.classList.contains('dark') ? 'white' : 'black'
                            }
                        }
                    }
                });
            }
        }
        
        // Carregar dados de consumo
        function carregarDadosConsumos(dias) {
            const stats = DB.consumos.getStats(dias);
            
            // Atualizar cards
            document.getElementById('total-diesel').textContent = Utils.formatarLitros(stats.totalDiesel);
            document.getElementById('total-hidraulico').textContent = Utils.formatarLitros(stats.totalHidraulico);
            document.getElementById('consumo-medio-litro-hora').textContent = stats.consumoMedioLitroHora.toFixed(1) + ' L/h';
            document.getElementById('total-abastecimentos').textContent = stats.totalRegistros;
        }
        
        // Criar gráficos de consumo
        function criarGraficoConsumo() {
            // Gráfico de consumo por equipamento
            const ctxEquipamento = document.getElementById('chart-consumo-equipamento');
            if (ctxEquipamento) {
                const stats = DB.consumos.getStats();
                
                // Filtrar e ordenar por consumo de diesel (top 5)
                const equipamentosOrdenados = [...stats.equipamentos]
                    .sort((a, b) => b.diesel - a.diesel)
                    .slice(0, 5);
                
                // Dados para o gráfico
                const data = {
                    labels: equipamentosOrdenados.map(e => e.id),
                    datasets: [
                        {
                            label: 'Diesel (L)',
                            data: equipamentosOrdenados.map(e => e.diesel),
                            backgroundColor: 'rgba(255, 159, 64, 0.7)',
                            borderColor: 'rgb(255, 159, 64)',
                            borderWidth: 1
                        },
                        {
                            label: 'Hidráulico (L)',
                            data: equipamentosOrdenados.map(e => e.hidraulico),
                            backgroundColor: 'rgba(75, 192, 192, 0.7)',
                            borderColor: 'rgb(75, 192, 192)',
                            borderWidth: 1
                        }
                    ]
                };
                
                // Criar gráfico
                new Chart(ctxEquipamento, {
                    type: 'bar',
                    data: data,
                    options: {
                        indexAxis: 'y',
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            x: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: 'Litros',
                                    color: document.documentElement.classList.contains('dark') ? 'white' : 'black'
                                },
                                ticks: {
                                    color: document.documentElement.classList.contains('dark') ? 'white' : 'black'
                                },
                                grid: {
                                    color: document.documentElement.classList.contains('dark') ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)'
                                }
                            },
                            y: {
                                ticks: {
                                    color: document.documentElement.classList.contains('dark') ? 'white' : 'black'
                                },
                                grid: {
                                    color: document.documentElement.classList.contains('dark') ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)'
                                }
                            }
                        },
                        plugins: {
                            legend: {
                                labels: {
                                    color: document.documentElement.classList.contains('dark') ? 'white' : 'black'
                                }
                            }
                        }
                    }
                });
            }
            
            // Gráfico de evolução do consumo
            const ctxEvolucao = document.getElementById('chart-evolucao-consumo');
            if (ctxEvolucao) {
                const consumos = DB.consumos.getAll();
                
                // Agrupar por data
                const consumosPorData = {};
                
                consumos.forEach(consumo => {
                    const data = consumo.data;
                    
                    if (!consumosPorData[data]) {
                        consumosPorData[data] = {
                            data: data,
                            diesel: 0,
                            hidraulico: 0
                        };
                    }
                    
                    if (consumo.tipoOleo === 'diesel') {
                        consumosPorData[data].diesel += Number(consumo.quantidade || 0);
                    } else if (consumo.tipoOleo === 'hidraulico') {
                        consumosPorData[data].hidraulico += Number(consumo.quantidade || 0);
                    }
                });
                
                // Ordenar por data
                const consumosOrdenados = Object.values(consumosPorData).sort((a, b) => new Date(a.data) - new Date(b.data));
                
                // Dados para o gráfico
                const data = {
                    labels: consumosOrdenados.map(c => Utils.formatarData(c.data)),
                    datasets: [
                        {
                            label: 'Diesel (L)',
                            data: consumosOrdenados.map(c => c.diesel),
                            backgroundColor: 'rgba(255, 159, 64, 0.4)',
                            borderColor: 'rgb(255, 159, 64)',
                            borderWidth: 1,
                            fill: true
                        },
                        {
                            label: 'Hidráulico (L)',
                            data: consumosOrdenados.map(c => c.hidraulico),
                            backgroundColor: 'rgba(75, 192, 192, 0.4)',
                            borderColor: 'rgb(75, 192, 192)',
                            borderWidth: 1,
                            fill: true
                        }
                    ]
                };
                
                // Criar gráfico
                new Chart(ctxEvolucao, {
                    type: 'line',
                    data: data,
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: 'Litros',
                                    color: document.documentElement.classList.contains('dark') ? 'white' : 'black'
                                },
                                ticks: {
                                    color: document.documentElement.classList.contains('dark') ? 'white' : 'black'
                                },
                                grid: {
                                    color: document.documentElement.classList.contains('dark') ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)'
                                }
                            },
                            x: {
                                ticks: {
                                    color: document.documentElement.classList.contains('dark') ? 'white' : 'black',
                                    maxRotation: 45,
                                    minRotation: 45
                                },
                                grid: {
                                    color: document.documentElement.classList.contains('dark') ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)'
                                }
                            }
                        },
                        plugins: {
                            legend: {
                                labels: {
                                    color: document.documentElement.classList.contains('dark') ? 'white' : 'black'
                                }
                            }
                        }
                    }
                });
            }
            
            // Atualizar tabela de consumo por equipamento
            atualizarTabelaConsumoEquipamentos();
        }
        
        // Atualizar tabela de consumo por equipamento
        function atualizarTabelaConsumoEquipamentos() {
            const tabelaElement = document.getElementById('tabela-consumo-equipamentos');
            if (!tabelaElement) return;
            
            const stats = DB.consumos.getStats();
            const colhedoras = DB.colhedoras.getAll();
            const veiculos = DB.veiculosCadastrados.getAll();
            
            // Limpar tabela
            tabelaElement.innerHTML = '';
            
            if (stats.equipamentos.length === 0) {
                tabelaElement.innerHTML = `
                    <tr>
                        <td colspan="5" class="px-4 py-3 text-center text-gray-500 dark:text-gray-400">
                            Nenhum registro encontrado
                        </td>
                    </tr>
                `;
                return;
            }
            
            // Ordenar por consumo total (diesel + hidráulico)
            const equipamentosOrdenados = [...stats.equipamentos].sort(
                (a, b) => (b.diesel + b.hidraulico) - (a.diesel + a.hidraulico)
            );
            
            // Adicionar cada linha
            equipamentosOrdenados.forEach(equip => {
                // Obter nome do equipamento
                let nomeEquipamento = equip.id;
                let tipoEquipamento = equip.tipo;
                
                if (equip.tipo === 'colhedora') {
                    const colhedora = colhedoras.find(c => c.id === equip.id);
                    if (colhedora) {
                        nomeEquipamento = `${colhedora.marca} ${colhedora.modelo} (${colhedora.id})`;
                    }
                    tipoEquipamento = 'Colhedora';
                } else if (equip.tipo === 'caminhao') {
                    const veiculo = veiculos.find(v => v.id === equip.id);
                    if (veiculo) {
                        nomeEquipamento = `${veiculo.modelo} - ${veiculo.placa} (${veiculo.id})`;
                    }
                    tipoEquipamento = 'Caminhão';
                }
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="px-4 py-3 text-gray-700 dark:text-gray-300">${nomeEquipamento}</td>
                    <td class="px-4 py-3 text-gray-700 dark:text-gray-300">${tipoEquipamento}</td>
                    <td class="px-4 py-3 text-right text-gray-700 dark:text-gray-300">${Utils.formatarLitros(equip.diesel)}</td>
                    <td class="px-4 py-3 text-right text-gray-700 dark:text-gray-300">${Utils.formatarLitros(equip.hidraulico)}</td>
                    <td class="px-4 py-3 text-right text-gray-700 dark:text-gray-300">
                        ${equip.mediaConsumoDiesel ? equip.mediaConsumoDiesel.toFixed(1) + ' L/h' : '-'}
                    </td>
                `;
                
                tabelaElement.appendChild(row);
            });
        }
        
        // Carregar dados de estatísticas gerais
        function carregarDadosEstatisticas(dias) {
            // Stats de produção
            const registros = DB.registros.getAll();
            const totalColhido = registros.reduce((total, registro) => total + Number(registro.quantidade || 0), 0);
            const totalHoras = registros.reduce((total, registro) => total + Number(registro.horas || 0), 0);
            const rendimentoMedio = totalHoras > 0 ? totalColhido / totalHoras : 0;
            
            document.getElementById('stats-total-colhido').textContent = Utils.formatarToneladas(totalColhido);
            document.getElementById('stats-rendimento-medio').textContent = Utils.formatarRendimento(rendimentoMedio);
            document.getElementById('stats-registros-totais').textContent = registros.length;
            
            // Stats de frota
            const statsCaminhoes = DB.caminhoes.getStats();
            document.getElementById('stats-total-caminhoes').textContent = DB.veiculosCadastrados.getAll().length;
            document.getElementById('stats-tempo-medio-total').textContent = Math.round(statsCaminhoes.mediaTempoCampo + statsCaminhoes.mediaTempoPatio) + ' min';
            document.getElementById('stats-viagens-registradas').textContent = statsCaminhoes.totalViagens;
            
            // Stats de consumo
            const statsConsumo = DB.consumos.getStats();
            document.getElementById('stats-total-diesel').textContent = Utils.formatarLitros(statsConsumo.totalDiesel);
            document.getElementById('stats-total-hidraulico').textContent = Utils.formatarLitros(statsConsumo.totalHidraulico);
            
            // Calcular eficiência T/L
            const eficiencia = statsConsumo.totalDiesel > 0 ? totalColhido / statsConsumo.totalDiesel : 0;
            document.getElementById('stats-eficiencia-litro').textContent = eficiencia.toFixed(2) + ' T/L';
        }
        
        // *** FUNÇÕES PARA GERENCIAR COLHEDORAS ***
        function inicializarColhedoras() {
            const formColhedora = document.getElementById('form-colhedora');
            const btnAddColhedora = document.getElementById('btn-add-colhedora');
            const btnExportColhedoras = document.getElementById('btn-export-colhedoras');
            
            // Carregar colhedoras na inicialização
            carregarColhedoras();
            
            // Adicionar evento de envio do formulário
            if (formColhedora) {
                formColhedora.addEventListener('submit', function(event) {
                    event.preventDefault();
                    
                    // Obter dados do formulário
                    const colhedora = {
                        id: document.getElementById('colhedora-id').value,
                        marca: document.getElementById('colhedora-marca').value,
                        modelo: document.getElementById('colhedora-modelo').value,
                        ano: document.getElementById('colhedora-ano').value,
                        observacoes: document.getElementById('colhedora-observacoes').value
                    };
                    
                    try {
                        // Verificar se é uma edição (id preenchido) ou nova colhedora
                        const isEditing = formColhedora.hasAttribute('data-editing');
                        
                        if (isEditing) {
                            // Atualizar colhedora existente
                            DB.colhedoras.update(colhedora);
                            Utils.exibirToast(`Colhedora ${colhedora.id} atualizada com sucesso!`, 'success');
                        } else {
                            // Adicionar nova colhedora
                            DB.colhedoras.add(colhedora);
                            Utils.exibirToast(`Colhedora ${colhedora.id} adicionada com sucesso!`, 'success');
                        }
                        
                        // Resetar formulário e recarregar lista
                        formColhedora.reset();
                        formColhedora.removeAttribute('data-editing');
                        carregarColhedoras();
                    } catch (error) {
                        Utils.exibirToast(error.message, 'error');
                    }
                });
            }
            
            // Botão para adicionar nova colhedora (focus no form)
            if (btnAddColhedora) {
                btnAddColhedora.addEventListener('click', function() {
                    // Resetar formulário
                    formColhedora.reset();
                    formColhedora.removeAttribute('data-editing');
                    
                    // Focar no primeiro campo
                    document.getElementById('colhedora-id').focus();
                    
                    // Tornar o ID editável (caso estivesse desabilitado)
                    document.getElementById('colhedora-id').removeAttribute('disabled');
                });
            }
            
            // Exportar colhedoras
            if (btnExportColhedoras) {
                btnExportColhedoras.addEventListener('click', function() {
                    const colhedoras = DB.colhedoras.getAll();
                    
                    // Definir colunas para o relatório
                    const colunas = [
                        { header: 'ID', dataKey: 'id' },
                        { header: 'Marca', dataKey: 'marca' },
                        { header: 'Modelo', dataKey: 'modelo' },
                        { header: 'Ano', dataKey: 'ano' },
                        { header: 'Observações', dataKey: 'observacoes' }
                    ];
                    
                    // Exportar para PDF
                    Utils.exportarPDF(
                        'Relatório de Colhedoras',
                        colhedoras,
                        colunas,
                        'colhedoras.pdf'
                    );
                });
            }
        }
        
        // Carregar colhedoras na tabela
        function carregarColhedoras() {
            const tabelaElement = document.getElementById('tabela-colhedoras');
            if (!tabelaElement) return;
            
            const colhedoras = DB.colhedoras.getAll();
            
            // Limpar tabela
            tabelaElement.innerHTML = '';
            
            if (colhedoras.length === 0) {
                tabelaElement.innerHTML = `
                    <tr>
                        <td colspan="5" class="px-4 py-3 text-center text-gray-500 dark:text-gray-400">
                            Nenhuma colhedora cadastrada
                        </td>
                    </tr>
                `;
                return;
            }
            
            // Adicionar cada colhedora
            colhedoras.forEach(colhedora => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="px-4 py-3 text-gray-700 dark:text-gray-300">${colhedora.id}</td>
                    <td class="px-4 py-3 text-gray-700 dark:text-gray-300">${colhedora.marca || '-'}</td>
                    <td class="px-4 py-3 text-gray-700 dark:text-gray-300">${colhedora.modelo || '-'}</td>
                    <td class="px-4 py-3 text-center text-gray-700 dark:text-gray-300">${colhedora.ano || '-'}</td>
                    <td class="px-4 py-3 text-center">
                        <button class="btn-edit-colhedora text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-200 p-1 mr-1" data-id="${colhedora.id}">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn-delete-colhedora text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-200 p-1" data-id="${colhedora.id}">
                            <i class="fas fa-trash-alt"></i>
                        </button>
                    </td>
                `;
                
                tabelaElement.appendChild(row);
            });
            
            // Adicionar eventos aos botões
            document.querySelectorAll('.btn-edit-colhedora').forEach(button => {
                button.addEventListener('click', function() {
                    const id = this.getAttribute('data-id');
                    editarColhedora(id);
                });
            });
            
            document.querySelectorAll('.btn-delete-colhedora').forEach(button => {
                button.addEventListener('click', function() {
                    const id = this.getAttribute('data-id');
                    excluirColhedora(id);
                });
            });
        }
        
        // Editar colhedora
        function editarColhedora(id) {
            try {
                const colhedora = DB.colhedoras.get(id);
                if (!colhedora) {
                    Utils.exibirToast('Colhedora não encontrada', 'error');
                    return;
                }
                
                // Preencher formulário
                document.getElementById('colhedora-id').value = colhedora.id;
                document.getElementById('colhedora-marca').value = colhedora.marca || '';
                document.getElementById('colhedora-modelo').value = colhedora.modelo || '';
                document.getElementById('colhedora-ano').value = colhedora.ano || '';
                document.getElementById('colhedora-observacoes').value = colhedora.observacoes || '';
                
                // Marcar formulário como edição
                document.getElementById('form-colhedora').setAttribute('data-editing', 'true');
                
                // Desabilitar edição do ID
                document.getElementById('colhedora-id').setAttribute('disabled', 'disabled');
                
                // Scroll para o formulário
                document.getElementById('colhedora-marca').scrollIntoView({ behavior: 'smooth' });
                document.getElementById('colhedora-marca').focus();
            } catch (error) {
                Utils.exibirToast(error.message, 'error');
            }
        }
        
        // Excluir colhedora
        function excluirColhedora(id) {
            try {
                // Confirmar exclusão
                if (!confirm(`Tem certeza que deseja excluir a colhedora ${id}?`)) {
                    return;
                }
                
                // Tentar excluir
                DB.colhedoras.remove(id);
                
                // Atualizar lista
                carregarColhedoras();
                
                Utils.exibirToast(`Colhedora ${id} excluída com sucesso!`, 'success');
            } catch (error) {
                Utils.exibirToast(error.message, 'error');
            }
        }
        
        // *** FUNÇÕES PARA GERENCIAR REGISTROS DE PRODUÇÃO ***
        function inicializarRegistros() {
            const formRegistro = document.getElementById('form-registro');
            
            // Carregar colhedoras no select
            carregarColhedorasSelect();
            
            // Carregar estatísticas iniciais
            atualizarEstatisticasRegistros();
            
            // Adicionar evento de envio do formulário
            if (formRegistro) {
                formRegistro.addEventListener('submit', function(event) {
                    event.preventDefault();
                    
                    // Obter dados do formulário
                    const registro = {
                        data: document.getElementById('registro-data').value,
                        colhedoraId: document.getElementById('registro-colhedora').value,
                        cultura: document.getElementById('registro-cultura').value,
                        quantidade: document.getElementById('registro-quantidade').value,
                        horas: document.getElementById('registro-horas').value,
                        combustivel: document.getElementById('registro-combustivel').value,
                        observacoes: document.getElementById('registro-observacoes').value
                    };
                    
                    try {
                        // Verificar se é uma edição ou novo registro
                        const isEditing = formRegistro.hasAttribute('data-editing');
                        
                        if (isEditing) {
                            // Atualizar registro existente
                            const registroId = formRegistro.getAttribute('data-editing');
                            registro.id = registroId;
                            
                            DB.registros.update(registro);
                            Utils.exibirToast('Registro atualizado com sucesso!', 'success');
                        } else {
                            // Adicionar novo registro
                            registro.id = 'REG-' + Date.now();
                            
                            DB.registros.add(registro);
                            Utils.exibirToast('Registro adicionado com sucesso!', 'success');
                            
                            // Adicionar notificação
                            DB.notifications.add({
                                tipo: 'success',
                                titulo: 'Novo Registro de Produção',
                                mensagem: `Foi registrada a produção de ${registro.quantidade}T para a colhedora ${registro.colhedoraId}.`
                            });
                        }
                        
                        // Resetar formulário
                        formRegistro.reset();
                        formRegistro.removeAttribute('data-editing');
                        
                        // Definir data para hoje
                        document.getElementById('registro-data').value = new Date().toISOString().split('T')[0];
                        
                        // Atualizar estatísticas
                        atualizarEstatisticasRegistros();
                    } catch (error) {
                        Utils.exibirToast(error.message, 'error');
                    }
                });
                
                // Definir data para hoje por padrão
                document.getElementById('registro-data').value = new Date().toISOString().split('T')[0];
            }
        }
        
        // Carregar colhedoras no select
        function carregarColhedorasSelect() {
            const selectColhedora = document.getElementById('registro-colhedora');
            if (!selectColhedora) return;
            
            const colhedoras = DB.colhedoras.getAll();
            
            // Limpar opções, mantendo apenas a opção padrão
            selectColhedora.innerHTML = '<option value="">Selecione uma colhedora</option>';
            
            // Adicionar cada colhedora
            colhedoras.forEach(colhedora => {
                const option = document.createElement('option');
                option.value = colhedora.id;
                option.textContent = `${colhedora.marca} ${colhedora.modelo} (${colhedora.id})`;
                selectColhedora.appendChild(option);
            });
        }
        
        // Atualizar estatísticas de registros
        function atualizarEstatisticasRegistros() {
            // Obter todos os registros
            const registros = DB.registros.getAll();
            
            // Calcular total colhido
            const totalColhido = registros.reduce((total, registro) => {
                return total + Number(registro.quantidade || 0);
            }, 0);
            
            // Calcular total de horas
            const totalHoras = registros.reduce((total, registro) => {
                return total + Number(registro.horas || 0);
            }, 0);
            
            // Calcular rendimento médio
            const rendimentoMedio = totalHoras > 0 ? totalColhido / totalHoras : 0;
            
            // Obter total de dias parados por chuva
            const totalDiasParados = DB.chuvas.getTotalDias();
            
            // Atualizar elementos
            document.getElementById('total-colhido').textContent = Utils.formatarToneladas(totalColhido);
            document.getElementById('rendimento-medio').textContent = Utils.formatarRendimento(rendimentoMedio);
            document.getElementById('paradas-chuva-total').textContent = totalDiasParados + ' dias';
            
            // Atualizar tabela de produção por colhedora
            atualizarTabelaProducaoColhedoras();
        }
        
        // Atualizar tabela de produção por colhedora
        function atualizarTabelaProducaoColhedoras() {
            const tabelaElement = document.getElementById('tabela-producao-colhedoras');
            if (!tabelaElement) return;
            
            const statsEquipamentos = DB.registros.getEquipmentStats();
            const colhedoras = DB.colhedoras.getAll();
            
            // Limpar tabela
            tabelaElement.innerHTML = '';
            
            if (statsEquipamentos.length === 0) {
                tabelaElement.innerHTML = `
                    <tr>
                        <td colspan="3" class="px-4 py-3 text-center text-gray-500 dark:text-gray-400">
                            Nenhum registro encontrado
                        </td>
                    </tr>
                `;
                return;
            }
            
            // Ordenar por quantidade (maior para menor)
            const statsOrdenados = [...statsEquipamentos].sort((a, b) => b.quantidade - a.quantidade);
            
            // Adicionar cada linha
            statsOrdenados.forEach(stat => {
                const colhedora = colhedoras.find(c => c.id === stat.id) || { marca: '', modelo: '' };
                const nomeColhedora = `${colhedora.marca} ${colhedora.modelo} (${stat.id})`;
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="px-4 py-3 text-gray-700 dark:text-gray-300">${nomeColhedora}</td>
                    <td class="px-4 py-3 text-right text-gray-700 dark:text-gray-300">${Utils.formatarToneladas(stat.quantidade)}</td>
                    <td class="px-4 py-3 text-right text-gray-700 dark:text-gray-300">${Utils.formatarRendimento(stat.rendimento)}</td>
                `;
                
                tabelaElement.appendChild(row);
            });
        }
        
        // *** FUNÇÕES PARA GERENCIAR CAMINHÕES ***
        function inicializarCaminhoes() {
            // Configurar tabs de caminhões
            const caminhoesTabs = document.querySelectorAll('.caminhoes-tab');
            const caminhoesContents = document.querySelectorAll('.caminhoes-tab-content');
            
            caminhoesTabs.forEach(function(tab) {
                tab.addEventListener('click', function() {
                    const tabTarget = this.getAttribute('data-tab');
                    
                    // Remover classe ativa de todas as tabs
                    caminhoesTabs.forEach(function(t) {
                        t.classList.remove('tab-active');
                    });
                    
                    // Esconder todos os conteúdos
                    caminhoesContents.forEach(function(content) {
                        content.classList.add('hidden');
                    });
                    
                    // Ativar a tab clicada
                    this.classList.add('tab-active');
                    
                    // Mostrar o conteúdo correspondente
                    document.getElementById('tab-' + tabTarget).classList.remove('hidden');
                });
            });
            
            // Inicializar funcionalidades de cadastro
            inicializarCadastroCaminhao();
            
            // Inicializar funcionalidades de registro de viagem
            inicializarRegistroViagem();
            
            // Carregar estatísticas
            atualizarEstatisticasCaminhoes();
            
            // Criar gráfico de próprios vs terceiros (estatísticas)
            criarGraficoPropriosTerceiros();
        }
        
        // Inicializar cadastro de caminhão
        function inicializarCadastroCaminhao() {
            const formCadastroCaminhao = document.getElementById('form-cadastro-caminhao');
            const btnAddNewCaminhao = document.getElementById('btn-add-new-caminhao');
            const btnCancelarCadastroCaminhao = document.getElementById('btn-cancelar-cadastro-caminhao');
            const cadastroCaminhaoCard = document.getElementById('cadastro-caminhao-card');
            const btnExportCaminhoes = document.getElementById('btn-export-caminhoes');
            
            // Carregar caminhões na tabela
            carregarCaminhoesCadastrados();
            
            // Mostrar/esconder formulário de cadastro
            if (btnAddNewCaminhao) {
                btnAddNewCaminhao.addEventListener('click', function() {
                    formCadastroCaminhao.reset();
                    formCadastroCaminhao.removeAttribute('data-editing');
                    document.getElementById('cadastro-caminhao-id').removeAttribute('disabled');
                    cadastroCaminhaoCard.classList.remove('hidden');
                    document.getElementById('cadastro-caminhao-id').focus();
                });
            }
            
            // Cancelar cadastro
            if (btnCancelarCadastroCaminhao) {
                btnCancelarCadastroCaminhao.addEventListener('click', function() {
                    formCadastroCaminhao.reset();
                    cadastroCaminhaoCard.classList.add('hidden');
                });
            }
            
            // Processar formulário de cadastro
            if (formCadastroCaminhao) {
                formCadastroCaminhao.addEventListener('submit', function(event) {
                    event.preventDefault();
                    
                    // Obter dados do formulário
                    const caminhao = {
                        id: document.getElementById('cadastro-caminhao-id').value,
                        placa: document.getElementById('cadastro-caminhao-placa').value,
                        modelo: document.getElementById('cadastro-caminhao-modelo').value,
                        tipo: document.querySelector('input[name="tipo-caminhao"]:checked').value,
                        capacidade: document.getElementById('cadastro-caminhao-capacidade').value,
                        motorista: document.getElementById('cadastro-caminhao-motorista').value,
                        observacoes: document.getElementById('cadastro-caminhao-observacoes').value
                    };
                    
                    try {
                        // Verificar se é uma edição (id preenchido) ou novo
                        const isEditing = formCadastroCaminhao.hasAttribute('data-editing');
                        
                        if (isEditing) {
                            // Atualizar caminhão existente
                            DB.veiculosCadastrados.update(caminhao);
                            Utils.exibirToast(`Caminhão ${caminhao.id} atualizado com sucesso!`, 'success');
                        } else {
                            // Adicionar novo caminhão
                            DB.veiculosCadastrados.add(caminhao);
                            Utils.exibirToast(`Caminhão ${caminhao.id} adicionado com sucesso!`, 'success');
                        }
                        
                        // Resetar formulário e esconder
                        formCadastroCaminhao.reset();
                        formCadastroCaminhao.removeAttribute('data-editing');
                        cadastroCaminhaoCard.classList.add('hidden');
                        
                        // Recarregar lista e atualizar select de caminhões para registro
                        carregarCaminhoesCadastrados();
                        carregarCaminhoesSelect();
                    } catch (error) {
                        Utils.exibirToast(error.message, 'error');
                    }
                });
            }
            
            // Exportar relatório de caminhões
            if (btnExportCaminhoes) {
                btnExportCaminhoes.addEventListener('click', function() {
                    const veiculos = DB.veiculosCadastrados.getAll();
                    
                    // Formatar dados para exportação
                    const dadosFormatados = veiculos.map(veiculo => ({
                        id: veiculo.id,
                        placa: veiculo.placa,
                        modelo: veiculo.modelo,
                        tipo: veiculo.tipo === 'proprio' ? 'Próprio' : 'Terceiro',
                        capacidade: veiculo.capacidade ? veiculo.capacidade + ' T' : '-',
                        motorista: veiculo.motorista || '-',
                        observacoes: veiculo.observacoes || '-'
                    }));
                    
                    // Definir colunas para o relatório
                    const colunas = [
                        { header: 'ID', dataKey: 'id' },
                        { header: 'Placa', dataKey: 'placa' },
                        { header: 'Modelo', dataKey: 'modelo' },
                        { header: 'Tipo', dataKey: 'tipo' },
                        { header: 'Capacidade', dataKey: 'capacidade' },
                        { header: 'Motorista', dataKey: 'motorista' }
                    ];
                    
                    // Exportar para PDF
                    Utils.exportarPDF(
                        'Relatório de Caminhões Cadastrados',
                        dadosFormatados,
                        colunas,
                        'caminhoes_cadastrados.pdf'
                    );
                });
            }
        }
        
        // Carregar caminhões cadastrados na tabela
        function carregarCaminhoesCadastrados() {
            const tabelaElement = document.getElementById('tabela-caminhoes');
            if (!tabelaElement) return;
            
            const veiculos = DB.veiculosCadastrados.getAll();
            
            // Limpar tabela
            tabelaElement.innerHTML = '';
            
            if (veiculos.length === 0) {
                tabelaElement.innerHTML = `
                    <tr>
                        <td colspan="6" class="px-4 py-3 text-center text-gray-500 dark:text-gray-400">
                            Nenhum caminhão cadastrado
                        </td>
                    </tr>
                `;
                return;
            }
            
            // Adicionar cada veículo
            veiculos.forEach(veiculo => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="px-4 py-3 text-gray-700 dark:text-gray-300">${veiculo.id}</td>
                    <td class="px-4 py-3 text-gray-700 dark:text-gray-300">${veiculo.placa || '-'}</td>
                    <td class="px-4 py-3 text-gray-700 dark:text-gray-300">${veiculo.modelo || '-'}</td>
                    <td class="px-4 py-3 text-center text-gray-700 dark:text-gray-300">
                        <span class="px-2 py-1 text-xs rounded-full ${
                            veiculo.tipo === 'proprio' ? 
                                'bg-blue-100 text-blue-800 dark:bg-blue-800 dark:text-blue-100' : 
                                'bg-green-100 text-green-800 dark:bg-green-800 dark:text-green-100'
                        }">
                            ${veiculo.tipo === 'proprio' ? 'Próprio' : 'Terceiro'}
                        </span>
                    </td>
                    <td class="px-4 py-3 text-center text-gray-700 dark:text-gray-300">
                        ${veiculo.capacidade ? veiculo.capacidade + ' T' : '-'}
                    </td>
                    <td class="px-4 py-3 text-center">
                        <button class="btn-edit-caminhao text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-200 p-1 mr-1" data-id="${veiculo.id}">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn-delete-caminhao text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-200 p-1" data-id="${veiculo.id}">
                            <i class="fas fa-trash-alt"></i>
                        </button>
                    </td>
                `;
                
                tabelaElement.appendChild(row);
            });
            
            // Adicionar eventos aos botões
            document.querySelectorAll('.btn-edit-caminhao').forEach(button => {
                button.addEventListener('click', function() {
                    const id = this.getAttribute('data-id');
                    editarCaminhao(id);
                });
            });
            
            document.querySelectorAll('.btn-delete-caminhao').forEach(button => {
                button.addEventListener('click', function() {
                    const id = this.getAttribute('data-id');
                    excluirCaminhao(id);
                });
            });
        }
        
        // Editar caminhão
        function editarCaminhao(id) {
            try {
                const caminhao = DB.veiculosCadastrados.get(id);
                if (!caminhao) {
                    Utils.exibirToast('Caminhão não encontrado', 'error');
                    return;
                }
                
                // Mostrar formulário
                document.getElementById('cadastro-caminhao-card').classList.remove('hidden');
                
                // Preencher formulário
                document.getElementById('cadastro-caminhao-id').value = caminhao.id;
                document.getElementById('cadastro-caminhao-placa').value = caminhao.placa || '';
                document.getElementById('cadastro-caminhao-modelo').value = caminhao.modelo || '';
                document.getElementById('cadastro-caminhao-capacidade').value = caminhao.capacidade || '';
                document.getElementById('cadastro-caminhao-motorista').value = caminhao.motorista || '';
                document.getElementById('cadastro-caminhao-observacoes').value = caminhao.observacoes || '';
                
                // Selecionar tipo
                if (caminhao.tipo === 'proprio') {
                    document.getElementById('tipo-proprio').checked = true;
                } else {
                    document.getElementById('tipo-terceiro').checked = true;
                }
                
                // Marcar formulário como edição
                document.getElementById('form-cadastro-caminhao').setAttribute('data-editing', 'true');
                
                // Desabilitar edição do ID
                document.getElementById('cadastro-caminhao-id').setAttribute('disabled', 'disabled');
                
                // Scroll para o formulário
                document.getElementById('cadastro-caminhao-placa').scrollIntoView({ behavior: 'smooth' });
                document.getElementById('cadastro-caminhao-placa').focus();
            } catch (error) {
                Utils.exibirToast(error.message, 'error');
            }
        }
        
        // Excluir caminhão
        function excluirCaminhao(id) {
            try {
                // Confirmar exclusão
                if (!confirm(`Tem certeza que deseja excluir o caminhão ${id}?`)) {
                    return;
                }
                
                // Tentar excluir
                DB.veiculosCadastrados.remove(id);
                
                // Atualizar lista
                carregarCaminhoesCadastrados();
                carregarCaminhoesSelect();
                
                Utils.exibirToast(`Caminhão ${id} excluído com sucesso!`, 'success');
            } catch (error) {
                Utils.exibirToast(error.message, 'error');
            }
        }
        
        // Inicializar registro de viagem
        function inicializarRegistroViagem() {
            const formCaminhao = document.getElementById('form-caminhao');
            const btnExportViagens = document.getElementById('btn-export-viagens');
            
            // Carregar caminhões no select
            carregarCaminhoesSelect();
            
            // Carregar histórico de viagens
            carregarHistoricoViagens();
            
            // Processar formulário de viagem
            if (formCaminhao) {
                formCaminhao.addEventListener('submit', function(event) {
                    event.preventDefault();
                    
                    // Obter dados do formulário
                    const viagem = {
                        data: document.getElementById('caminhao-data').value,
                        caminhaoId: document.getElementById('caminhao-id').value,
                        cultura: document.getElementById('caminhao-cultura').value,
                        producao: document.getElementById('caminhao-producao').value,
                        tempoCampo: document.getElementById('caminhao-tempo-campo').value,
                        tempoPatio: document.getElementById('caminhao-tempo-patio').value,
                        observacoes: document.getElementById('caminhao-observacoes').value
                    };
                    
                    try {
                        // Verificar se é uma edição ou nova viagem
                        const isEditing = formCaminhao.hasAttribute('data-editing');
                        
                        if (isEditing) {
                            // Atualizar viagem existente
                            const viagemId = formCaminhao.getAttribute('data-editing');
                            viagem.id = viagemId;
                            
                            DB.caminhoes.update(viagem);
                            Utils.exibirToast('Viagem atualizada com sucesso!', 'success');
                        } else {
                            // Adicionar nova viagem
                            viagem.id = 'VIA-' + Date.now();
                            
                            DB.caminhoes.add(viagem);
                            Utils.exibirToast('Viagem registrada com sucesso!', 'success');
                        }
                        
                        // Resetar formulário
                        formCaminhao.reset();
                        formCaminhao.removeAttribute('data-editing');
                        
                        // Definir data para hoje
                        document.getElementById('caminhao-data').value = new Date().toISOString().split('T')[0];
                        
                        // Atualizar estatísticas e histórico
                        carregarHistoricoViagens();
                        atualizarEstatisticasCaminhoes();
                    } catch (error) {
                        Utils.exibirToast(error.message, 'error');
                    }
                });
                
                // Definir data para hoje por padrão
                document.getElementById('caminhao-data').value = new Date().toISOString().split('T')[0];
            }
            
            // Exportar viagens
            if (btnExportViagens) {
                btnExportViagens.addEventListener('click', function() {
                    const viagens = DB.caminhoes.getAll();
                    const veiculos = DB.veiculosCadastrados.getAll();
                    
                    // Formatar dados para exportação
                    const dadosFormatados = viagens.map(viagem => {
                        const veiculo = veiculos.find(v => v.id === viagem.caminhaoId) || {};
                        return {
                            data: Utils.formatarData(viagem.data),
                            caminhao: veiculo.placa ? `${veiculo.placa} (${viagem.caminhaoId})` : viagem.caminhaoId,
                            tipo: veiculo.tipo === 'proprio' ? 'Próprio' : 'Terceiro',
                            cultura: viagem.cultura || '-',
                            producao: viagem.producao ? viagem.producao + ' T' : '-',
                            tempoCampo: viagem.tempoCampo ? viagem.tempoCampo + ' min' : '-',
                            tempoPatio: viagem.tempoPatio ? viagem.tempoPatio + ' min' : '-'
                        };
                    });
                    
                    // Definir colunas para o relatório
                    const colunas = [
                        { header: 'Data', dataKey: 'data' },
                        { header: 'Caminhão', dataKey: 'caminhao' },
                        { header: 'Tipo', dataKey: 'tipo' },
                        { header: 'Cultura', dataKey: 'cultura' },
                        { header: 'Produção', dataKey: 'producao' },
                        { header: 'Tempo Campo', dataKey: 'tempoCampo' },
                        { header: 'Tempo Pátio', dataKey: 'tempoPatio' }
                    ];
                    
                    // Exportar para PDF
                    Utils.exportarPDF(
                        'Relatório de Viagens',
                        dadosFormatados,
                        colunas,
                        'viagens_caminhoes.pdf'
                    );
                });
            }
        }
        
        // Carregar caminhões no select
        function carregarCaminhoesSelect() {
            const selectCaminhao = document.getElementById('caminhao-id');
            if (!selectCaminhao) return;
            
            const veiculos = DB.veiculosCadastrados.getAll();
            
            // Limpar opções, mantendo apenas a opção padrão
            selectCaminhao.innerHTML = '<option value="">Selecione um caminhão</option>';
            
            // Adicionar cada caminhão
            veiculos.forEach(veiculo => {
                const option = document.createElement('option');
                option.value = veiculo.id;
                option.textContent = `${veiculo.placa} - ${veiculo.modelo} (${veiculo.id})`;
                selectCaminhao.appendChild(option);
            });
        }
        
        // Carregar histórico de viagens
        function carregarHistoricoViagens() {
            const tabelaElement = document.getElementById('tabela-historico-caminhoes');
            if (!tabelaElement) return;
            
            const viagens = DB.caminhoes.getAll();
            const veiculos = DB.veiculosCadastrados.getAll();
            
            // Limpar tabela
            tabelaElement.innerHTML = '';
            
            if (viagens.length === 0) {
                tabelaElement.innerHTML = `
                    <tr>
                        <td colspan="7" class="px-4 py-3 text-center text-gray-500 dark:text-gray-400">
                            Nenhuma viagem registrada
                        </td>
                    </tr>
                `;
                return;
            }
            
            // Ordenar por data (mais recente primeiro)
            const viagensOrdenadas = [...viagens].sort((a, b) => new Date(b.data) - new Date(a.data));
            
            // Adicionar cada viagem
            viagensOrdenadas.forEach(viagem => {
                const veiculo = veiculos.find(v => v.id === viagem.caminhaoId) || {};
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="px-4 py-3 text-gray-700 dark:text-gray-300">${Utils.formatarData(viagem.data)}</td>
                    <td class="px-4 py-3 text-gray-700 dark:text-gray-300">
                        ${veiculo.placa ? `${veiculo.placa} (${viagem.caminhaoId})` : viagem.caminhaoId}
                    </td>
                    <td class="px-4 py-3 text-center text-gray-700 dark:text-gray-300">
                        <span class="px-2 py-1 text-xs rounded-full ${
                            veiculo.tipo === 'proprio' ? 
                                'bg-blue-100 text-blue-800 dark:bg-blue-800 dark:text-blue-100' : 
                                'bg-green-100 text-green-800 dark:bg-green-800 dark:text-green-100'
                        }">
                            ${veiculo.tipo === 'proprio' ? 'Próprio' : 'Terceiro'}
                        </span>
                    </td>
                    <td class="px-4 py-3 text-right text-gray-700 dark:text-gray-300">${Utils.formatarToneladas(viagem.producao)}</td>
                    <td class="px-4 py-3 text-right text-gray-700 dark:text-gray-300">${viagem.tempoCampo} min</td>
                    <td class="px-4 py-3 text-right text-gray-700 dark:text-gray-300">${viagem.tempoPatio} min</td>
                    <td class="px-4 py-3 text-center">
                        <button class="btn-edit-viagem text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-200 p-1 mr-1" data-id="${viagem.id}">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn-delete-viagem text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-200 p-1" data-id="${viagem.id}">
                            <i class="fas fa-trash-alt"></i>
                        </button>
                    </td>
                `;
                
                tabelaElement.appendChild(row);
            });
            
            // Adicionar eventos aos botões
            document.querySelectorAll('.btn-edit-viagem').forEach(button => {
                button.addEventListener('click', function() {
                    const id = this.getAttribute('data-id');
                    editarViagem(id);
                });
            });
            
            document.querySelectorAll('.btn-delete-viagem').forEach(button => {
                button.addEventListener('click', function() {
                    const id = this.getAttribute('data-id');
                    excluirViagem(id);
                });
            });
        }
        
        // Editar viagem
        function editarViagem(id) {
            try {
                const viagem = DB.caminhoes.get(id);
                if (!viagem) {
                    Utils.exibirToast('Viagem não encontrada', 'error');
                    return;
                }
                
                // Preencher formulário
                document.getElementById('caminhao-data').value = viagem.data || '';
                document.getElementById('caminhao-id').value = viagem.caminhaoId || '';
                document.getElementById('caminhao-cultura').value = viagem.cultura || '';
                document.getElementById('caminhao-producao').value = viagem.producao || '';
                document.getElementById('caminhao-tempo-campo').value = viagem.tempoCampo || '';
                document.getElementById('caminhao-tempo-patio').value = viagem.tempoPatio || '';
                document.getElementById('caminhao-observacoes').value = viagem.observacoes || '';
                
                // Marcar formulário como edição
                document.getElementById('form-caminhao').setAttribute('data-editing', id);
                
                // Scroll para o formulário
                document.getElementById('caminhao-data').scrollIntoView({ behavior: 'smooth' });
                document.getElementById('caminhao-data').focus();
            } catch (error) {
                Utils.exibirToast(error.message, 'error');
            }
        }
        
        // Excluir viagem
        function excluirViagem(id) {
            try {
                // Confirmar exclusão
                if (!confirm('Tem certeza que deseja excluir esta viagem?')) {
                    return;
                }
                
                // Tentar excluir
                DB.caminhoes.remove(id);
                
                // Atualizar lista e estatísticas
                carregarHistoricoViagens();
                atualizarEstatisticasCaminhoes();
                
                Utils.exibirToast('Viagem excluída com sucesso!', 'success');
            } catch (error) {
                Utils.exibirToast(error.message, 'error');
            }
        }
        
        // Atualizar estatísticas de caminhões
        function atualizarEstatisticasCaminhoes() {
            const stats = DB.caminhoes.getStats();
            
            // Atualizar cards
            if (document.getElementById('estatisticas-total-producao-caminhoes')) {
                document.getElementById('estatisticas-total-producao-caminhoes').textContent = Utils.formatarToneladas(stats.totalProducao);
            }
            
            if (document.getElementById('estatisticas-media-campo')) {
                document.getElementById('estatisticas-media-campo').textContent = Math.round(stats.mediaTempoCampo) + ' min';
            }
            
            if (document.getElementById('estatisticas-media-patio')) {
                document.getElementById('estatisticas-media-patio').textContent = Math.round(stats.mediaTempoPatio) + ' min';
            }
            
            if (document.getElementById('estatisticas-total-registros-caminhoes')) {
                document.getElementById('estatisticas-total-registros-caminhoes').textContent = stats.totalViagens;
            }
            
            if (document.getElementById('estatisticas-producao-proprios')) {
                document.getElementById('estatisticas-producao-proprios').textContent = Utils.formatarToneladas(stats.proprios.producao);
            }
            
            if (document.getElementById('estatisticas-producao-terceiros')) {
                document.getElementById('estatisticas-producao-terceiros').textContent = Utils.formatarToneladas(stats.terceiros.producao);
            }
        }
        
        // Criar gráfico de próprios vs terceiros
        function criarGraficoPropriosTerceiros() {
            const ctx = document.getElementById('estatisticas-chart-proprios-terceiros');
            if (!ctx) return;
            
            const stats = DB.caminhoes.getStats();
            
            // Verificar se há dados
            if (stats.totalProducao === 0) {
                ctx.parentElement.innerHTML = `
                    <div class="flex items-center justify-center h-64 text-gray-500 dark:text-gray-400">
                        <p>Não há dados suficientes para gerar o gráfico</p>
                    </div>
                `;
                return;
            }
            
            // Calcular percentuais
            const percentualProprios = stats.totalProducao > 0 ? 
                (stats.proprios.producao / stats.totalProducao) * 100 : 0;
            
            const percentualTerceiros = stats.totalProducao > 0 ? 
                (stats.terceiros.producao / stats.totalProducao) * 100 : 0;
            
            // Criar chart
            if (Chart.getChart(ctx)) {
                Chart.getChart(ctx).destroy();
            }
            
            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Próprios', 'Terceiros'],
                    datasets: [{
                        data: [percentualProprios, percentualTerceiros],
                        backgroundColor: [
                            'rgba(54, 162, 235, 0.7)',
                            'rgba(75, 192, 192, 0.7)'
                        ],
                        borderColor: [
                            'rgb(54, 162, 235)',
                            'rgb(75, 192, 192)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                color: document.documentElement.classList.contains('dark') ? 'white' : 'black'
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const label = context.label || '';
                                    const value = context.raw.toFixed(1) + '%';
                                    return `${label}: ${value}`;
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // Inicializar exportação de relatório
        document.getElementById('btn-export-estatisticas')?.addEventListener('click', function() {
            const stats = DB.caminhoes.getStats();
            const veiculos = DB.veiculosCadastrados.getAll();
            
            // Agrupar viagens por caminhão
            const viagens = DB.caminhoes.getAll();
            const viagensPorCaminhao = {};
            
            viagens.forEach(viagem => {
                if (!viagensPorCaminhao[viagem.caminhaoId]) {
                    const veiculo = veiculos.find(v => v.id === viagem.caminhaoId) || {};
                    viagensPorCaminhao[viagem.caminhaoId] = {
                        id: viagem.caminhaoId,
                        placa: veiculo.placa || 'N/A',
                        modelo: veiculo.modelo || 'N/A',
                        tipo: veiculo.tipo === 'proprio' ? 'Próprio' : 'Terceiro',
                        producao: 0,
                        viagens: 0,
                        tempoTotal: 0
                    };
                }
                
                viagensPorCaminhao[viagem.caminhaoId].producao += Number(viagem.producao || 0);
                viagensPorCaminhao[viagem.caminhaoId].viagens += 1;
                viagensPorCaminhao[viagem.caminhaoId].tempoTotal += 
                    Number(viagem.tempoCampo || 0) + Number(viagem.tempoPatio || 0);
            });
            
            // Formatar para exportação
            const dadosFormatados = Object.values(viagensPorCaminhao).map(caminhao => ({
                identificacao: `${caminhao.placa} (${caminhao.id})`,
                modelo: caminhao.modelo,
                tipo: caminhao.tipo,
                producao: Utils.formatarToneladas(caminhao.producao),
                viagens: caminhao.viagens,
                tempoMedio: caminhao.viagens > 0 ? Math.round(caminhao.tempoTotal / caminhao.viagens) + ' min' : '-'
            }));
            
            // Adicionar estatísticas gerais
            dadosFormatados.push({
                identificacao: '--- TOTAIS ---',
                modelo: '',
                tipo: '',
                producao: Utils.formatarToneladas(stats.totalProducao),
                viagens: stats.totalViagens,
                tempoMedio: Math.round(stats.mediaTempoCampo + stats.mediaTempoPatio) + ' min'
            });
            
            // Definir colunas para o relatório
            const colunas = [
                { header: 'Caminhão', dataKey: 'identificacao' },
                { header: 'Modelo', dataKey: 'modelo' },
                { header: 'Tipo', dataKey: 'tipo' },
                { header: 'Produção', dataKey: 'producao' },
                { header: 'Viagens', dataKey: 'viagens' },
                { header: 'Tempo Médio', dataKey: 'tempoMedio' }
            ];
            
            // Exportar para PDF
            Utils.exportarPDF(
                'Relatório de Estatísticas de Caminhões',
                dadosFormatados,
                colunas,
                'estatisticas_caminhoes.pdf'
            );
        });
        
        // *** FUNÇÕES PARA GERENCIAR CHUVAS ***
        function inicializarChuvas() {
            const formChuva = document.getElementById('form-chuva');
            const btnExportChuvas = document.getElementById('btn-export-chuvas');
            
            // Carregar estatísticas iniciais
            atualizarEstatisticasChuva();
            
            // Carregar tabela de chuvas
            carregarTabelaChuvas();
            
            // Processar formulário de registro de chuva
            if (formChuva) {
                formChuva.addEventListener('submit', function(event) {
                    event.preventDefault();
                    
                    // Obter dados do formulário
                    const chuva = {
                        dataInicio: document.getElementById('chuva-data-inicio').value,
                        dataFim: document.getElementById('chuva-data-fim').value,
                        dias: document.getElementById('chuva-dias').value,
                        intensidade: document.getElementById('chuva-intensidade').value,
                        observacoes: document.getElementById('chuva-observacoes').value
                    };
                    
                    try {
                        // Validar datas
                        if (new Date(chuva.dataInicio) > new Date(chuva.dataFim)) {
                            throw new Error('A data de início deve ser anterior à data de fim');
                        }
                        
                        // Verificar se é uma edição ou novo registro
                        const isEditing = formChuva.hasAttribute('data-editing');
                        
                        if (isEditing) {
                            // Atualizar registro existente
                            const chuvaId = formChuva.getAttribute('data-editing');
                            chuva.id = chuvaId;
                            
                            DB.chuvas.update(chuva);
                            Utils.exibirToast('Registro de chuva atualizado com sucesso!', 'success');
                        } else {
                            // Adicionar novo registro
                            chuva.id = 'CHV-' + Date.now();
                            
                            DB.chuvas.add(chuva);
                            Utils.exibirToast('Parada registrada com sucesso!', 'success');
                        }
                        
                        // Resetar formulário
                        formChuva.reset();
                        formChuva.removeAttribute('data-editing');
                        
                        // Definir data de início para hoje
                        document.getElementById('chuva-data-inicio').value = new Date().toISOString().split('T')[0];
                        
                        // Atualizar estatísticas e tabela
                        atualizarEstatisticasChuva();
                        carregarTabelaChuvas();
                    } catch (error) {
                        Utils.exibirToast(error.message, 'error');
                    }
                });
                
                // Definir data de início para hoje por padrão
                document.getElementById('chuva-data-inicio').value = new Date().toISOString().split('T')[0];
            }
            
            // Exportar chuvas
            if (btnExportChuvas) {
                btnExportChuvas.addEventListener('click', function() {
                    const chuvas = DB.chuvas.getAll();
                    
                    // Formatar dados para exportação
                    const dadosFormatados = chuvas.map(chuva => ({
                        periodo: `${Utils.formatarData(chuva.dataInicio)} - ${Utils.formatarData(chuva.dataFim)}`,
                        dias: chuva.dias,
                        intensidade: chuva.intensidade.charAt(0).toUpperCase() + chuva.intensidade.slice(1),
                        observacoes: chuva.observacoes || '-'
                    }));
                    
                    // Definir colunas para o relatório
                    const colunas = [
                        { header: 'Período', dataKey: 'periodo' },
                        { header: 'Dias', dataKey: 'dias' },
                        { header: 'Intensidade', dataKey: 'intensidade' },
                        { header: 'Observações', dataKey: 'observacoes' }
                    ];
                    
                    // Exportar para PDF
                    Utils.exportarPDF(
                        'Relatório de Paradas por Chuva',
                        dadosFormatados,
                        colunas,
                        'paradas_chuva.pdf'
                    );
                });
            }
        }
        
        // Atualizar estatísticas de chuva
        function atualizarEstatisticasChuva() {
            const totalRegistros = DB.chuvas.getAll().length;
            const totalDias = DB.chuvas.getTotalDias();
            const ultimaChuva = DB.chuvas.getLastChuva();
            const impactoEstimado = DB.chuvas.calcularImpactoEstimado();
            
            // Atualizar elementos
            document.getElementById('chuva-total-registros').textContent = totalRegistros + ' registros';
            document.getElementById('chuva-total-dias').textContent = totalDias + ' dias';
            document.getElementById('chuva-ultima-parada').textContent = ultimaChuva ? Utils.formatarData(ultimaChuva.dataFim) : '--/--/----';
            document.getElementById('chuva-impacto-estimado').textContent = Utils.formatarToneladas(impactoEstimado);
        }
        
        // Carregar tabela de chuvas
        function carregarTabelaChuvas() {
            const tabelaElement = document.getElementById('tabela-chuvas');
            if (!tabelaElement) return;
            
            const chuvas = DB.chuvas.getAll();
            
            // Limpar tabela
            tabelaElement.innerHTML = '';
            
            if (chuvas.length === 0) {
                tabelaElement.innerHTML = `
                    <tr>
                        <td colspan="5" class="px-4 py-3 text-center text-gray-500 dark:text-gray-400">
                            Nenhum registro encontrado
                        </td>
                    </tr>
                `;
                return;
            }
            
            // Ordenar por data de início (mais recente primeiro)
            const chuvasOrdenadas = [...chuvas].sort((a, b) => new Date(b.dataInicio) - new Date(a.dataInicio));
            
            // Adicionar cada registro
            chuvasOrdenadas.forEach(chuva => {
                const row = document.createElement('tr');
                
                // Determinar classe CSS para intensidade
                let intensidadeClass = 'bg-blue-100 text-blue-800 dark:bg-blue-800 dark:text-blue-100';
                if (chuva.intensidade === 'media') {
                    intensidadeClass = 'bg-yellow-100 text-yellow-800 dark:bg-yellow-800 dark:text-yellow-100';
                } else if (chuva.intensidade === 'alta') {
                    intensidadeClass = 'bg-red-100 text-red-800 dark:bg-red-800 dark:text-red-100';
                }
                
                row.innerHTML = `
                    <td class="px-4 py-3 text-gray-700 dark:text-gray-300">
                        ${Utils.formatarData(chuva.dataInicio)} - ${Utils.formatarData(chuva.dataFim)}
                    </td>
                    <td class="px-4 py-3 text-center text-gray-700 dark:text-gray-300">
                        ${chuva.dias}
                    </td>
                    <td class="px-4 py-3 text-center">
                        <span class="px-2 py-1 text-xs rounded-full ${intensidadeClass}">
                            ${chuva.intensidade.charAt(0).toUpperCase() + chuva.intensidade.slice(1)}
                        </span>
                    </td>
                    <td class="px-4 py-3 text-gray-700 dark:text-gray-300">
                        ${chuva.observacoes || '-'}
                    </td>
                    <td class="px-4 py-3 text-center">
                        <button class="btn-edit-chuva text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-200 p-1 mr-1" data-id="${chuva.id}">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn-delete-chuva text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-200 p-1" data-id="${chuva.id}">
                            <i class="fas fa-trash-alt"></i>
                        </button>
                    </td>
                `;
                
                tabelaElement.appendChild(row);
            });
            
            // Adicionar eventos aos botões
            document.querySelectorAll('.btn-edit-chuva').forEach(button => {
                button.addEventListener('click', function() {
                    const id = this.getAttribute('data-id');
                    editarChuva(id);
                });
            });
            
            document.querySelectorAll('.btn-delete-chuva').forEach(button => {
                button.addEventListener('click', function() {
                    const id = this.getAttribute('data-id');
                    excluirChuva(id);
                });
            });
        }
        
        // Editar registro de chuva
        function editarChuva(id) {
            try {
                const chuva = DB.chuvas.get(id);
                if (!chuva) {
                    Utils.exibirToast('Registro não encontrado', 'error');
                    return;
                }
                
                // Preencher formulário
                document.getElementById('chuva-data-inicio').value = chuva.dataInicio || '';
                document.getElementById('chuva-data-fim').value = chuva.dataFim || '';
                document.getElementById('chuva-dias').value = chuva.dias || '';
                document.getElementById('chuva-intensidade').value = chuva.intensidade || '';
                document.getElementById('chuva-observacoes').value = chuva.observacoes || '';
                
                // Marcar formulário como edição
                document.getElementById('form-chuva').setAttribute('data-editing', id);
                
                // Scroll para o formulário
                document.getElementById('chuva-data-inicio').scrollIntoView({ behavior: 'smooth' });
                document.getElementById('chuva-data-inicio').focus();
            } catch (error) {
                Utils.exibirToast(error.message, 'error');
            }
        }
        
        // Excluir registro de chuva
        function excluirChuva(id) {
            try {
                // Confirmar exclusão
                if (!confirm('Tem certeza que deseja excluir este registro de parada?')) {
                    return;
                }
                
                // Tentar excluir
                DB.chuvas.remove(id);
                
                // Atualizar lista e estatísticas
                carregarTabelaChuvas();
                atualizarEstatisticasChuva();
                
                Utils.exibirToast('Registro excluído com sucesso!', 'success');
            } catch (error) {
                Utils.exibirToast(error.message, 'error');
            }
        }
        
        // *** FUNÇÕES PARA GERENCIAR CONSUMO ***
        function inicializarConsumo() {
            const formConsumo = document.getElementById('form-consumo');
            const btnExportConsumoHistorico = document.getElementById('btn-export-consumo-historico');
            
            // Eventos do select de tipo de equipamento
            const tipoEquipSelect = document.getElementById('consumo-tipo-equipamento');
            if (tipoEquipSelect) {
                tipoEquipSelect.addEventListener('change', function() {
                    carregarEquipamentosSelect(this.value);
                });
            }
            
            // Eventos para filtros
            document.getElementById('btn-aplicar-filtros-consumo')?.addEventListener('click', function() {
                carregarHistoricoConsumo();
            });
            
            document.getElementById('btn-limpar-filtros-consumo')?.addEventListener('click', function() {
                document.getElementById('filtro-consumo-tipo').value = '';
                document.getElementById('filtro-consumo-equipamento').value = '';
                document.getElementById('filtro-consumo-data-inicio').value = '';
                document.getElementById('filtro-consumo-data-fim').value = '';
                
                carregarHistoricoConsumo();
            });
            
            // Carregar equipamentos no filtro
            carregarEquipamentosSelectFiltro();
            
            // Carregar histórico inicial
            carregarHistoricoConsumo();
            
            // Carregar resumo de consumo
            atualizarResumoConsumo();
            
            // Exportar histórico de consumo
            if (btnExportConsumoHistorico) {
                btnExportConsumoHistorico.addEventListener('click', function() {
                    const consumos = DB.consumos.getAll();
                    const colhedoras = DB.colhedoras.getAll();
                    const veiculos = DB.veiculosCadastrados.getAll();
                    
                    // Formatar dados para exportação
                    const dadosFormatados = consumos.map(consumo => {
                        let nomeEquipamento = consumo.equipamentoId;
                        let tipoEquipamento = consumo.tipoEquipamento;
                        
                        // Obter nome do equipamento
                        if (consumo.tipoEquipamento === 'colhedora') {
                            const colhedora = colhedoras.find(c => c.id === consumo.equipamentoId);
                            if (colhedora) {
                                nomeEquipamento = `${colhedora.marca} ${colhedora.modelo} (${colhedora.id})`;
                            }
                            tipoEquipamento = 'Colhedora';
                        } else if (consumo.tipoEquipamento === 'caminhao') {
                            const veiculo = veiculos.find(v => v.id === consumo.equipamentoId);
                            if (veiculo) {
                                nomeEquipamento = `${veiculo.placa} (${veiculo.id})`;
                            }
                            tipoEquipamento = 'Caminhão';
                        }
                        
                        return {
                            data: Utils.formatarData(consumo.data),
                            equipamento: nomeEquipamento,
                            tipo: tipoEquipamento,
                            oleo: consumo.tipoOleo === 'diesel' ? 'Diesel' : 'Hidráulico',
                            quantidade: Utils.formatarLitros(consumo.quantidade),
                            horimetro: consumo.horimetro || '-',
                            observacoes: consumo.observacoes || '-'
                        };
                    });
                    
                    // Definir colunas para o relatório
                    const colunas = [
                        { header: 'Data', dataKey: 'data' },
                        { header: 'Equipamento', dataKey: 'equipamento' },
                        { header: 'Tipo', dataKey: 'tipo' },
                        { header: 'Óleo', dataKey: 'oleo' },
                        { header: 'Quantidade', dataKey: 'quantidade' },
                        { header: 'Horímetro', dataKey: 'horimetro' }
                    ];
                    
                    // Exportar para PDF
                    Utils.exportarPDF(
                        'Relatório de Consumo de Óleos',
                        dadosFormatados,
                        colunas,
                        'consumo_oleos.pdf'
                    );
                });
            }
            
            // Processar formulário de consumo
            if (formConsumo) {
                formConsumo.addEventListener('submit', function(event) {
                    event.preventDefault();
                    
                    // Obter dados do formulário
                    const consumo = {
                        data: document.getElementById('consumo-data').value,
                        tipoEquipamento: document.getElementById('consumo-tipo-equipamento').value,
                        equipamentoId: document.getElementById('consumo-equipamento').value,
                        tipoOleo: document.getElementById('consumo-tipo-oleo').value,
                        quantidade: document.getElementById('consumo-quantidade').value,
                        horimetro: document.getElementById('consumo-horimetro').value,
                        observacoes: document.getElementById('consumo-observacoes').value
                    };
                    
                    try {
                        // Verificar se é uma edição ou novo registro
                        const isEditing = formConsumo.hasAttribute('data-editing');
                        
                        if (isEditing) {
                            // Atualizar registro existente
                            const consumoId = formConsumo.getAttribute('data-editing');
                            consumo.id = consumoId;
                            
                            DB.consumos.update(consumo);
                            Utils.exibirToast('Registro de consumo atualizado com sucesso!', 'success');
                        } else {
                            // Adicionar novo registro
                            consumo.id = 'CON-' + Date.now();
                            
                            DB.consumos.add(consumo);
                            Utils.exibirToast('Consumo registrado com sucesso!', 'success');
                        }
                        
                        // Resetar formulário
                        formConsumo.reset();
                        formConsumo.removeAttribute('data-editing');
                        
                        // Desabilitar select de equipamento
                        document.getElementById('consumo-equipamento').disabled = true;
                        
                        // Definir data para hoje
                        document.getElementById('consumo-data').value = new Date().toISOString().split('T')[0];
                        
                        // Atualizar histórico e resumo
                        carregarHistoricoConsumo();
                        atualizarResumoConsumo();
                    } catch (error) {
                        Utils.exibirToast(error.message, 'error');
                    }
                });
                
                // Definir data para hoje por padrão
                document.getElementById('consumo-data').value = new Date().toISOString().split('T')[0];
            }
        }
        
        // Carregar equipamentos no select com base no tipo
        function carregarEquipamentosSelect(tipo) {
            const selectEquipamento = document.getElementById('consumo-equipamento');
            if (!selectEquipamento) return;
            
            // Limpar opções
            selectEquipamento.innerHTML = '<option value="">Selecione o equipamento</option>';
            
            if (!tipo) {
                selectEquipamento.disabled = true;
                return;
            }
            
            // Ativar select
            selectEquipamento.disabled = false;
            
            if (tipo === 'colhedora') {
                // Carregar colhedoras
                const colhedoras = DB.colhedoras.getAll();
                
                colhedoras.forEach(colhedora => {
                    const option = document.createElement('option');
                    option.value = colhedora.id;
                    option.textContent = `${colhedora.marca} ${colhedora.modelo} (${colhedora.id})`;
                    selectEquipamento.appendChild(option);
                });
            } else if (tipo === 'caminhao') {
                // Carregar caminhões
                const veiculos = DB.veiculosCadastrados.getAll();
                
                veiculos.forEach(veiculo => {
                    const option = document.createElement('option');
                    option.value = veiculo.id;
                    option.textContent = `${veiculo.placa} - ${veiculo.modelo} (${veiculo.id})`;
                    selectEquipamento.appendChild(option);
                });
            }
        }
        
        // Carregar equipamentos no select de filtro
        function carregarEquipamentosSelectFiltro() {
            const selectEquipamento = document.getElementById('filtro-consumo-equipamento');
            if (!selectEquipamento) return;
            
            // Limpar opções, mantendo apenas a opção padrão
            selectEquipamento.innerHTML = '<option value="">Todos</option>';
            
            // Adicionar colhedoras
            const colhedoras = DB.colhedoras.getAll();
            
            if (colhedoras.length > 0) {
                const optgroup = document.createElement('optgroup');
                optgroup.label = 'Colhedoras';
                
                colhedoras.forEach(colhedora => {
                    const option = document.createElement('option');
                    option.value = `colhedora-${colhedora.id}`;
                    option.textContent = `${colhedora.marca} ${colhedora.modelo} (${colhedora.id})`;
                    optgroup.appendChild(option);
                });
                
                selectEquipamento.appendChild(optgroup);
            }
            
            // Adicionar caminhões
            const veiculos = DB.veiculosCadastrados.getAll();
            
            if (veiculos.length > 0) {
                const optgroup = document.createElement('optgroup');
                optgroup.label = 'Caminhões';
                
                veiculos.forEach(veiculo => {
                    const option = document.createElement('option');
                    option.value = `caminhao-${veiculo.id}`;
                    option.textContent = `${veiculo.placa} (${veiculo.id})`;
                    optgroup.appendChild(option);
                });
                
                selectEquipamento.appendChild(optgroup);
            }
        }
        
        // Carregar histórico de consumo
        function carregarHistoricoConsumo() {
            const tabelaElement = document.getElementById('tabela-historico-consumo');
            if (!tabelaElement) return;
            
            // Obter filtros
            const filtroTipo = document.getElementById('filtro-consumo-tipo').value;
            const filtroEquipamento = document.getElementById('filtro-consumo-equipamento').value;
            const filtroDataInicio = document.getElementById('filtro-consumo-data-inicio').value;
            const filtroDataFim = document.getElementById('filtro-consumo-data-fim').value;
            
            // Obter todos os consumos
            let consumos = DB.consumos.getAll();
            
            // Aplicar filtros
            if (filtroTipo) {
                consumos = consumos.filter(c => c.tipoOleo === filtroTipo);
            }
            
            if (filtroEquipamento) {
                const [tipo, id] = filtroEquipamento.split('-');
                consumos = consumos.filter(c => c.tipoEquipamento === tipo && c.equipamentoId === id);
            }
            
            if (filtroDataInicio) {
                consumos = consumos.filter(c => c.data >= filtroDataInicio);
            }
            
            if (filtroDataFim) {
                consumos = consumos.filter(c => c.data <= filtroDataFim);
            }
            
            // Limpar tabela
            tabelaElement.innerHTML = '';
            
            if (consumos.length === 0) {
                tabelaElement.innerHTML = `
                    <tr>
                        <td colspan="6" class="px-4 py-3 text-center text-gray-500 dark:text-gray-400">
                            Nenhum registro encontrado
                        </td>
                    </tr>
                `;
                return;
            }
            
            // Ordenar por data (mais recente primeiro)
            const consumosOrdenados = [...consumos].sort((a, b) => new Date(b.data) - new Date(a.data));
            
            // Obter dados de equipamentos
            const colhedoras = DB.colhedoras.getAll();
            const veiculos = DB.veiculosCadastrados.getAll();
            
            // Adicionar cada registro
            consumosOrdenados.forEach(consumo => {
                // Obter nome do equipamento
                let nomeEquipamento = consumo.equipamentoId;
                
                if (consumo.tipoEquipamento === 'colhedora') {
                    const colhedora = colhedoras.find(c => c.id === consumo.equipamentoId);
                    if (colhedora) {
                        nomeEquipamento = `${colhedora.marca} ${colhedora.modelo} (${colhedora.id})`;
                    }
                } else if (consumo.tipoEquipamento === 'caminhao') {
                    const veiculo = veiculos.find(v => v.id === consumo.equipamentoId);
                    if (veiculo) {
                        nomeEquipamento = `${veiculo.placa} (${veiculo.id})`;
                    }
                }
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="px-4 py-3 text-gray-700 dark:text-gray-300">${Utils.formatarData(consumo.data)}</td>
                    <td class="px-4 py-3 text-gray-700 dark:text-gray-300">${nomeEquipamento}</td>
                    <td class="px-4 py-3 text-center">
                        <span class="px-2 py-1 text-xs rounded-full ${
                            consumo.tipoOleo === 'diesel' ? 
                                'bg-yellow-100 text-yellow-800 dark:bg-yellow-800 dark:text-yellow-100' : 
                                'bg-green-100 text-green-800 dark:bg-green-800 dark:text-green-100'
                        }">
                            ${consumo.tipoOleo === 'diesel' ? 'Diesel' : 'Hidráulico'}
                        </span>
                    </td>
                    <td class="px-4 py-3 text-right text-gray-700 dark:text-gray-300">${Utils.formatarLitros(consumo.quantidade)}</td>
                    <td class="px-4 py-3 text-right text-gray-700 dark:text-gray-300">${consumo.horimetro || '-'}</td>
                    <td class="px-4 py-3 text-center">
                        <button class="btn-edit-consumo text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-200 p-1 mr-1" data-id="${consumo.id}">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn-delete-consumo text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-200 p-1" data-id="${consumo.id}">
                            <i class="fas fa-trash-alt"></i>
                        </button>
                    </td>
                `;
                
                tabelaElement.appendChild(row);
            });
            
            // Adicionar eventos aos botões
            document.querySelectorAll('.btn-edit-consumo').forEach(button => {
                button.addEventListener('click', function() {
                    const id = this.getAttribute('data-id');
                    editarConsumo(id);
                });
            });
            
            document.querySelectorAll('.btn-delete-consumo').forEach(button => {
                button.addEventListener('click', function() {
                    const id = this.getAttribute('data-id');
                    excluirConsumo(id);
                });
            });
        }
        
        // Atualizar resumo de consumo
        function atualizarResumoConsumo() {
            const stats = DB.consumos.getStats();
            
            // Atualizar elementos
            document.getElementById('resumo-total-diesel').textContent = Utils.formatarLitros(stats.totalDiesel);
            document.getElementById('resumo-total-hidraulico').textContent = Utils.formatarLitros(stats.totalHidraulico);
            document.getElementById('resumo-media-consumo').textContent = '0 L/h'; // Substituir quando implementar cálculo correto
            document.getElementById('resumo-total-abastecimentos').textContent = stats.totalRegistros;
        }
        
        // Editar registro de consumo
        function editarConsumo(id) {
            try {
                const consumo = DB.consumos.get(id);
                if (!consumo) {
                    Utils.exibirToast('Registro não encontrado', 'error');
                    return;
                }
                
                // Selecionar tipo de equipamento e carregar opções
                document.getElementById('consumo-tipo-equipamento').value = consumo.tipoEquipamento;
                carregarEquipamentosSelect(consumo.tipoEquipamento);
                
                // Preencher formulário
                document.getElementById('consumo-data').value = consumo.data || '';
                document.getElementById('consumo-equipamento').value = consumo.equipamentoId || '';
                document.getElementById('consumo-tipo-oleo').value = consumo.tipoOleo || '';
                document.getElementById('consumo-quantidade').value = consumo.quantidade || '';
                document.getElementById('consumo-horimetro').value = consumo.horimetro || '';
                document.getElementById('consumo-observacoes').value = consumo.observacoes || '';
                
                // Marcar formulário como edição
                document.getElementById('form-consumo').setAttribute('data-editing', id);
                
                // Scroll para o formulário
                document.getElementById('consumo-data').scrollIntoView({ behavior: 'smooth' });
                document.getElementById('consumo-data').focus();
            } catch (error) {
                Utils.exibirToast(error.message, 'error');
            }
        }
        
        // Excluir registro de consumo
        function excluirConsumo(id) {
            try {
                // Confirmar exclusão
                if (!confirm('Tem certeza que deseja excluir este registro de consumo?')) {
                    return;
                }
                
                // Tentar excluir
                DB.consumos.remove(id);
                
                // Atualizar histórico e resumo
                carregarHistoricoConsumo();
                atualizarResumoConsumo();
                
                Utils.exibirToast('Registro excluído com sucesso!', 'success');
            } catch (error) {
                Utils.exibirToast(error.message, 'error');
            }
        }
        
        // *** FUNÇÕES PARA GERENCIAR HISTÓRICO ***
        function inicializarHistorico() {
            // Eventos para aplicar/limpar filtros
            document.getElementById('btn-aplicar-filtros')?.addEventListener('click', function() {
                carregarHistoricoRegistros();
            });
            
            document.getElementById('btn-limpar-filtros')?.addEventListener('click', function() {
                document.getElementById('filtro-colhedora').value = '';
                document.getElementById('filtro-cultura').value = '';
                document.getElementById('filtro-data-inicio').value = '';
                document.getElementById('filtro-data-fim').value = '';
                
                carregarHistoricoRegistros();
            });
            
            // Exportar histórico
            document.getElementById('btn-export-historico')?.addEventListener('click', function() {
                // Obter dados filtrados
                const filtroColhedora = document.getElementById('filtro-colhedora').value;
                const filtroCultura = document.getElementById('filtro-cultura').value;
                const filtroDataInicio = document.getElementById('filtro-data-inicio').value;
                const filtroDataFim = document.getElementById('filtro-data-fim').value;
                
                // Obter todos os registros
                let registros = DB.registros.getAll();
                
                // Aplicar filtros
                if (filtroColhedora) {
                    registros = registros.filter(r => r.colhedoraId === filtroColhedora);
                }
                
                if (filtroCultura) {
                    registros = registros.filter(r => r.cultura === filtroCultura);
                }
                
                if (filtroDataInicio) {
                    registros = registros.filter(r => r.data >= filtroDataInicio);
                }
                
                if (filtroDataFim) {
                    registros = registros.filter(r => r.data <= filtroDataFim);
                }
                
                // Ordenar por data (mais recente primeiro)
                const registrosOrdenados = [...registros].sort((a, b) => new Date(b.data) - new Date(a.data));
                
                // Obter colhedoras para nomes
                const colhedoras = DB.colhedoras.getAll();
                
                // Formatar dados para exportação
                const dadosFormatados = registrosOrdenados.map(registro => {
                    const colhedora = colhedoras.find(c => c.id === registro.colhedoraId) || {};
                    const nomeColhedora = colhedora.marca ? `${colhedora.marca} ${colhedora.modelo}` : registro.colhedoraId;
                    
                    // Calcular rendimento
                    const rendimento = Number(registro.horas) > 0 ? Number(registro.quantidade) / Number(registro.horas) : 0;
                    
                    return {
                        data: Utils.formatarData(registro.data),
                        colhedora: nomeColhedora,
                        cultura: registro.cultura,
                        quantidade: Utils.formatarToneladas(registro.quantidade),
                        horas: registro.horas,
                        rendimento: Utils.formatarRendimento(rendimento),
                        combustivel: registro.combustivel ? registro.combustivel + ' L' : '-',
                        observacoes: registro.observacoes || '-'
                    };
                });
                
                // Definir colunas para o relatório
                const colunas = [
                    { header: 'Data', dataKey: 'data' },
                    { header: 'Colhedora', dataKey: 'colhedora' },
                    { header: 'Cultura', dataKey: 'cultura' },
                    { header: 'Quantidade', dataKey: 'quantidade' },
                    { header: 'Horas', dataKey: 'horas' },
                    { header: 'Rendimento', dataKey: 'rendimento' },
                    { header: 'Combustível', dataKey: 'combustivel' }
                ];
                
                // Exportar para PDF
                Utils.exportarPDF(
                    'Relatório de Produção',
                    dadosFormatados,
                    colunas,
                    'historico_producao.pdf'
                );
            });
            
            // Carregar colhedoras e culturas nos filtros
            carregarFiltrosHistorico();
            
            // Carregar histórico inicial
            carregarHistoricoRegistros();
        }
        
        // Carregar filtros do histórico
        function carregarFiltrosHistorico() {
            // Carregar colhedoras no filtro
            const selectColhedora = document.getElementById('filtro-colhedora');
            if (selectColhedora) {
                const colhedoras = DB.colhedoras.getAll();
                
                // Limpar opções, mantendo apenas a opção padrão
                selectColhedora.innerHTML = '<option value="">Todas</option>';
                
                // Adicionar cada colhedora
                colhedoras.forEach(colhedora => {
                    const option = document.createElement('option');
                    option.value = colhedora.id;
                    option.textContent = `${colhedora.marca} ${colhedora.modelo} (${colhedora.id})`;
                    selectColhedora.appendChild(option);
                });
            }
            
            // Carregar culturas no filtro
            const selectCultura = document.getElementById('filtro-cultura');
            if (selectCultura) {
                const registros = DB.registros.getAll();
                const culturas = new Set();
                
                // Obter culturas únicas
                registros.forEach(registro => {
                    if (registro.cultura) {
                        culturas.add(registro.cultura);
                    }
                });
                
                // Limpar opções, mantendo apenas a opção padrão
                selectCultura.innerHTML = '<option value="">Todas</option>';
                
                // Adicionar cada cultura
                [...culturas].sort().forEach(cultura => {
                    const option = document.createElement('option');
                    option.value = cultura;
                    option.textContent = cultura;
                    selectCultura.appendChild(option);
                });
            }
        }
        
        // Carregar histórico de registros
        function carregarHistoricoRegistros() {
            const tabelaElement = document.getElementById('tabela-registros');
            if (!tabelaElement) return;
            
            // Obter filtros
            const filtroColhedora = document.getElementById('filtro-colhedora').value;
            const filtroCultura = document.getElementById('filtro-cultura').value;
            const filtroDataInicio = document.getElementById('filtro-data-inicio').value;
            const filtroDataFim = document.getElementById('filtro-data-fim').value;
            
            // Obter todos os registros
            let registros = DB.registros.getAll();
            
            // Aplicar filtros
            if (filtroColhedora) {
                registros = registros.filter(r => r.colhedoraId === filtroColhedora);
            }
            
            if (filtroCultura) {
                registros = registros.filter(r => r.cultura === filtroCultura);
            }
            
            if (filtroDataInicio) {
                registros = registros.filter(r => r.data >= filtroDataInicio);
            }
            
            if (filtroDataFim) {
                registros = registros.filter(r => r.data <= filtroDataFim);
            }
            
            // Atualizar contagem
            document.getElementById('registros-contagem').textContent = `(${registros.length})`;
            
            // Limpar tabela
            tabelaElement.innerHTML = '';
            
            if (registros.length === 0) {
                tabelaElement.innerHTML = `
                    <tr>
                        <td colspan="7" class="px-4 py-3 text-center text-gray-500 dark:text-gray-400">
                            Nenhum registro encontrado
                        </td>
                    </tr>
                `;
                return;
            }
            
            // Ordenar por data (mais recente primeiro)
            const registrosOrdenados = [...registros].sort((a, b) => new Date(b.data) - new Date(a.data));
            
            // Obter colhedoras para nomes
            const colhedoras = DB.colhedoras.getAll();
            
            // Adicionar cada registro
            registrosOrdenados.forEach(registro => {
                const colhedora = colhedoras.find(c => c.id === registro.colhedoraId) || {};
                const nomeColhedora = colhedora.marca ? `${colhedora.marca} ${colhedora.modelo}` : registro.colhedoraId;
                
                // Calcular rendimento
                const rendimento = Number(registro.horas) > 0 ? Number(registro.quantidade) / Number(registro.horas) : 0;
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="px-4 py-3 text-gray-700 dark:text-gray-300">${Utils.formatarData(registro.data)}</td>
                    <td class="px-4 py-3 text-gray-700 dark:text-gray-300">${nomeColhedora}</td>
                    <td class="px-4 py-3 text-gray-700 dark:text-gray-300">${registro.cultura}</td>
                    <td class="px-4 py-3 text-right text-gray-700 dark:text-gray-300">${Utils.formatarToneladas(registro.quantidade)}</td>
                    <td class="px-4 py-3 text-right text-gray-700 dark:text-gray-300">${registro.horas} h</td>
                    <td class="px-4 py-3 text-right text-gray-700 dark:text-gray-300">${Utils.formatarRendimento(rendimento)}</td>
                    <td class="px-4 py-3 text-center">
                        <button class="btn-view-registro text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-200 p-1 mr-1" data-id="${registro.id}" title="Ver detalhes">
                            <i class="fas fa-eye"></i>
                        </button>
                        <button class="btn-edit-registro text-green-600 hover:text-green-900 dark:text-green-400 dark:hover:text-green-200 p-1 mr-1" data-id="${registro.id}" title="Editar">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn-delete-registro text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-200 p-1" data-id="${registro.id}" title="Excluir">
                            <i class="fas fa-trash-alt"></i>
                        </button>
                    </td>
                `;
                
                tabelaElement.appendChild(row);
            });
            
            // Adicionar eventos aos botões
            document.querySelectorAll('.btn-view-registro').forEach(button => {
                button.addEventListener('click', function() {
                    const id = this.getAttribute('data-id');
                    visualizarRegistro(id);
                });
            });
            
            document.querySelectorAll('.btn-edit-registro').forEach(button => {
                button.addEventListener('click', function() {
                    const id = this.getAttribute('data-id');
                    editarRegistro(id);
                });
            });
            
            document.querySelectorAll('.btn-delete-registro').forEach(button => {
                button.addEventListener('click', function() {
                    const id = this.getAttribute('data-id');
                    excluirRegistro(id);
                });
            });
        }
        
        // Visualizar detalhes do registro
        function visualizarRegistro(id) {
            try {
                const registro = DB.registros.get(id);
                if (!registro) {
                    Utils.exibirToast('Registro não encontrado', 'error');
                    return;
                }
                
                // Obter colhedora
                const colhedora = DB.colhedoras.get(registro.colhedoraId) || {};
                const nomeColhedora = colhedora.marca ? `${colhedora.marca} ${colhedora.modelo} (${colhedora.id})` : registro.colhedoraId;
                
                // Calcular rendimento
                const rendimento = Number(registro.horas) > 0 ? Number(registro.quantidade) / Number(registro.horas) : 0;
                
                // Criar mensagem de detalhes
                const detalhes = `
                    <div class="text-gray-800 dark:text-gray-200">
                        <p><strong>Data:</strong> ${Utils.formatarData(registro.data)}</p>
                        <p><strong>Colhedora:</strong> ${nomeColhedora}</p>
                        <p><strong>Cultura:</strong> ${registro.cultura}</p>
                        <p><strong>Quantidade:</strong> ${Utils.formatarToneladas(registro.quantidade)}</p>
                        <p><strong>Horas Trabalhadas:</strong> ${registro.horas} h</p>
                        <p><strong>Rendimento:</strong> ${Utils.formatarRendimento(rendimento)}</p>
                        <p><strong>Combustível:</strong> ${registro.combustivel ? registro.combustivel + ' L' : 'Não informado'}</p>
                        <p><strong>Observações:</strong> ${registro.observacoes || 'Nenhuma observação'}</p>
                    </div>
                `;
                
                // Exibir modal ou toast com os detalhes
                // (Seria melhor um modal, mas como não implementamos ainda, vamos usar um toast mais longo)
                Utils.exibirToast(detalhes, 'info', 8000);
            } catch (error) {
                Utils.exibirToast(error.message, 'error');
            }
        }
        
        // Editar registro (navegar para a página de registros)
        function editarRegistro(id) {
            try {
                const registro = DB.registros.get(id);
                if (!registro) {
                    Utils.exibirToast('Registro não encontrado', 'error');
                    return;
                }
                
                // Navegar para a página de registros
                document.querySelector('a[href="#registros"]').click();
                
                // Timeout para permitir a troca de página
                setTimeout(() => {
                    // Preencher formulário
                    document.getElementById('registro-data').value = registro.data || '';
                    document.getElementById('registro-colhedora').value = registro.colhedoraId || '';
                    document.getElementById('registro-cultura').value = registro.cultura || '';
                    document.getElementById('registro-quantidade').value = registro.quantidade || '';
                    document.getElementById('registro-horas').value = registro.horas || '';
                    document.getElementById('registro-combustivel').value = registro.combustivel || '';
                    document.getElementById('registro-observacoes').value = registro.observacoes || '';
                    
                    // Marcar formulário como edição
                    document.getElementById('form-registro').setAttribute('data-editing', id);
                    
                    // Scroll para o formulário
                    document.getElementById('registro-data').scrollIntoView({ behavior: 'smooth' });
                    document.getElementById('registro-data').focus();
                }, 300);
            } catch (error) {
                Utils.exibirToast(error.message, 'error');
            }
        }
        
        // Excluir registro
        function excluirRegistro(id) {
            try {
                // Confirmar exclusão
                if (!confirm('Tem certeza que deseja excluir este registro?')) {
                    return;
                }
                
                // Tentar excluir
                DB.registros.remove(id);
                
                // Atualizar lista
                carregarHistoricoRegistros();
                
                Utils.exibirToast('Registro excluído com sucesso!', 'success');
            } catch (error) {
                Utils.exibirToast(error.message, 'error');
            }
        }
        
        // *** FUNÇÕES PARA GERENCIAR LIBERAÇÕES ***
        function inicializarLiberacoes() {
            const formLiberacao = document.getElementById('form-liberacao');
            const filtroFrente = document.getElementById('filtro-liberacao-frente');
            const filtroFazenda = document.getElementById('filtro-liberacao-fazenda');
            const btnExportLiberacoes = document.getElementById('btn-export-liberacoes');
            
            // Inicializar filtros e tabela
            atualizarFiltrosLiberacoes();
            atualizarTabelaLiberacoes();
            
            // Adicionar eventos aos filtros
            if (filtroFrente) {
                filtroFrente.addEventListener('change', function() {
                    atualizarTabelaLiberacoes();
                    atualizarResumoLiberacoes();
                });
            }
            
            if (filtroFazenda) {
                filtroFazenda.addEventListener('change', function() {
                    atualizarTabelaLiberacoes();
                    atualizarResumoLiberacoes();
                });
            }
            
            // Atualizar resumo inicial
            atualizarResumoLiberacoes();
            
            // Processar formulário de liberação
            if (formLiberacao) {
                formLiberacao.addEventListener('submit', function(event) {
                    event.preventDefault();
                    
                    // Obter dados do formulário
                    const liberacao = {
                        frente: document.getElementById('liberacao-frente').value,
                        fazenda: document.getElementById('liberacao-fazenda').value,
                        numero: document.getElementById('liberacao-numero').value,
                        previsto: document.getElementById('liberacao-previsto').value,
                        realizado: document.getElementById('liberacao-realizado').value,
                        data: document.getElementById('liberacao-data').value,
                        observacoes: document.getElementById('liberacao-observacoes').value
                    };
                    
                    try {
                        // Calcular restante
                        liberacao.restante = Number(liberacao.previsto) - Number(liberacao.realizado);
                        
                        // Verificar se é uma edição ou nova liberação
                        const isEditing = formLiberacao.hasAttribute('data-editing');
                        
                        if (isEditing) {
                            // Atualizar liberação existente
                            const liberacaoId = formLiberacao.getAttribute('data-editing');
                            liberacao.id = liberacaoId;
                            
                            DB.liberacoes.update(liberacao);
                            Utils.exibirToast('Liberação atualizada com sucesso!', 'success');
                        } else {
                            // Adicionar nova liberação
                            liberacao.id = 'LIB-' + Date.now();
                            
                            DB.liberacoes.add(liberacao);
                            Utils.exibirToast('Liberação registrada com sucesso!', 'success');
                        }
                        
                        // Resetar formulário
                        formLiberacao.reset();
                        formLiberacao.removeAttribute('data-editing');
                        
                        // Definir data para hoje
                        document.getElementById('liberacao-data').value = new Date().toISOString().split('T')[0];
                        
                        // Atualizar tabela, filtros e resumo
                        atualizarFiltrosLiberacoes();
                        atualizarTabelaLiberacoes();
                        atualizarResumoLiberacoes();
                    } catch (error) {
                        Utils.exibirToast(error.message, 'error');
                    }
                });
                
                // Definir data para hoje por padrão
                document.getElementById('liberacao-data').value = new Date().toISOString().split('T')[0];
            }
            
            // Exportar liberações
            if (btnExportLiberacoes) {
                btnExportLiberacoes.addEventListener('click', function() {
                    // Obter filtros
                    const filtroFrenteValue = filtroFrente ? filtroFrente.value : '';
                    const filtroFazendaValue = filtroFazenda ? filtroFazenda.value : '';
                    
                    // Obter liberações filtradas
                    let liberacoes = DB.liberacoes.getAll();
                    
                    if (filtroFrenteValue) {
                        liberacoes = liberacoes.filter(l => l.frente === filtroFrenteValue);
                    }
                    
                    if (filtroFazendaValue) {
                        liberacoes = liberacoes.filter(l => l.fazenda === filtroFazendaValue);
                    }
                    
                    // Ordenar por data (mais recente primeiro)
                    const liberacoesOrdenadas = [...liberacoes].sort((a, b) => new Date(b.data) - new Date(a.data));
                    
                    // Formatar dados para exportação
                    const dadosFormatados = liberacoesOrdenadas.map(liberacao => ({
                        frente: liberacao.frente,
                        fazenda: liberacao.fazenda,
                        numero: liberacao.numero || '-',
                        data: Utils.formatarData(liberacao.data),
                        previsto: Utils.formatarToneladas(liberacao.previsto),
                        realizado: Utils.formatarToneladas(liberacao.realizado),
                        restante: Utils.formatarToneladas(liberacao.restante),
                        progresso: ((Number(liberacao.realizado) / Number(liberacao.previsto)) * 100).toFixed(1) + '%',
                        observacoes: liberacao.observacoes || '-'
                    }));
                    
                    // Adicionar linha de totais
                    const totals = DB.liberacoes.getTotals(filtroFrenteValue, filtroFazendaValue);
                    dadosFormatados.push({
                        frente: '--- TOTAIS ---',
                        fazenda: '',
                        numero: '',
                        data: '',
                        previsto: Utils.formatarToneladas(totals.previsto),
                        realizado: Utils.formatarToneladas(totals.realizado),
                        restante: Utils.formatarToneladas(totals.restante),
                        progresso: totals.previsto > 0 ? ((totals.realizado / totals.previsto) * 100).toFixed(1) + '%' : '0%',
                        observacoes: ''
                    });
                    
                    // Definir colunas para o relatório
                    const colunas = [
                        { header: 'Frente', dataKey: 'frente' },
                        { header: 'Fazenda', dataKey: 'fazenda' },
                        { header: 'Nº Liberação', dataKey: 'numero' },
                        { header: 'Data', dataKey: 'data' },
                        { header: 'Previsto (T)', dataKey: 'previsto' },
                        { header: 'Realizado (T)', dataKey: 'realizado' },
                        { header: 'Restante (T)', dataKey: 'restante' },
                        { header: 'Progresso', dataKey: 'progresso' }
                    ];
                    
                    // Exportar para PDF
                    Utils.exportarPDF(
                        'Relatório de Liberações',
                        dadosFormatados,
                        colunas,
                        'liberacoes.pdf'
                    );
                });
            }
        }
        
        // Atualizar filtros de liberações
        function atualizarFiltrosLiberacoes() {
            const filtroFrente = document.getElementById('filtro-liberacao-frente');
            const filtroFazenda = document.getElementById('filtro-liberacao-fazenda');
            
            if (!filtroFrente || !filtroFazenda) return;
            
            // Obter valores únicos
            const valores = DB.liberacoes.getUniqueValues();
            
            // Salvar valores selecionados
            const frenteSelecionada = filtroFrente.value;
            const fazendaSelecionada = filtroFazenda.value;
            
            // Atualizar opções de frente
            filtroFrente.innerHTML = '<option value="">Todas</option>';
            valores.frentes.forEach(frente => {
                const option = document.createElement('option');
                option.value = frente;
                option.textContent = frente;
                filtroFrente.appendChild(option);
            });
            
            // Atualizar opções de fazenda
            filtroFazenda.innerHTML = '<option value="">Todas</option>';
            valores.fazendas.forEach(fazenda => {
                const option = document.createElement('option');
                option.value = fazenda;
                option.textContent = fazenda;
                filtroFazenda.appendChild(option);
            });
            
            // Restaurar valores selecionados se ainda existirem
            if (frenteSelecionada && valores.frentes.includes(frenteSelecionada)) {
                filtroFrente.value = frenteSelecionada;
            }
            
            if (fazendaSelecionada && valores.fazendas.includes(fazendaSelecionada)) {
                filtroFazenda.value = fazendaSelecionada;
            }
        }
        
        // Atualizar resumo de liberações
        function atualizarResumoLiberacoes() {
            // Obter filtros
            const filtroFrente = document.getElementById('filtro-liberacao-frente');
            const filtroFazenda = document.getElementById('filtro-liberacao-fazenda');
            
            const filtroFrenteValue = filtroFrente ? filtroFrente.value : '';
            const filtroFazendaValue = filtroFazenda ? filtroFazenda.value : '';
            
            // Obter totais
            const totals = DB.liberacoes.getTotals(filtroFrenteValue, filtroFazendaValue);
            
            // Atualizar elementos
            document.getElementById('resumo-total-previsto').textContent = Utils.formatarToneladas(totals.previsto);
            document.getElementById('resumo-total-realizado').textContent = Utils.formatarToneladas(totals.realizado);
            document.getElementById('resumo-total-restante').textContent = Utils.formatarToneladas(totals.restante);
        }
        
        // Atualizar tabela de liberações
        function atualizarTabelaLiberacoes() {
            const tabelaElement = document.getElementById('tabela-liberacoes');
            if (!tabelaElement) return;
            
            // Obter filtros
            const filtroFrente = document.getElementById('filtro-liberacao-frente');
            const filtroFazenda = document.getElementById('filtro-liberacao-fazenda');
            
            const filtroFrenteValue = filtroFrente ? filtroFrente.value : '';
            const filtroFazendaValue = filtroFazenda ? filtroFazenda.value : '';
            
            // Obter liberações
            let liberacoes = DB.liberacoes.getAll();
            
            // Aplicar filtros
            if (filtroFrenteValue) {
                liberacoes = liberacoes.filter(l => l.frente === filtroFrenteValue);
            }
            
            if (filtroFazendaValue) {
                liberacoes = liberacoes.filter(l => l.fazenda === filtroFazendaValue);
            }
            
            // Limpar tabela
            tabelaElement.innerHTML = '';
            
            if (liberacoes.length === 0) {
                tabelaElement.innerHTML = `
                    <tr>
                        <td colspan="8" class="px-4 py-3 text-center text-gray-500 dark:text-gray-400">
                            Nenhuma liberação encontrada
                        </td>
                    </tr>
                `;
                return;
            }
            
            // Ordenar por data (mais recente primeiro)
            const liberacoesOrdenadas = [...liberacoes].sort((a, b) => new Date(b.data) - new Date(a.data));
            
            // Adicionar cada liberação
            liberacoesOrdenadas.forEach(liberacao => {
                // Calcular progresso
                const progresso = Number(liberacao.previsto) > 0 ? 
                    (Number(liberacao.realizado) / Number(liberacao.previsto)) * 100 : 0;
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="px-4 py-3 text-gray-700 dark:text-gray-300">${liberacao.frente}</td>
                    <td class="px-4 py-3 text-gray-700 dark:text-gray-300">${liberacao.fazenda}</td>
                    <td class="px-4 py-3 text-gray-700 dark:text-gray-300">${liberacao.numero || '-'}</td>
                    <td class="px-4 py-3 text-right text-gray-700 dark:text-gray-300">${Utils.formatarToneladas(liberacao.previsto)}</td>
                    <td class="px-4 py-3 text-right text-gray-700 dark:text-gray-300">${Utils.formatarToneladas(liberacao.realizado)}</td>
                    <td class="px-4 py-3 text-right text-gray-700 dark:text-gray-300">${Utils.formatarToneladas(liberacao.restante)}</td>
                    <td class="px-4 py-3 text-center">
                        <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5">
                            <div class="bg-primary-600 h-2.5 rounded-full" style="width: ${progresso}%"></div>
                        </div>
                        <span class="text-xs font-medium text-gray-700 dark:text-gray-300">${progresso.toFixed(1)}%</span>
                    </td>
                    <td class="px-4 py-3 text-center">
                        <button class="btn-edit-liberacao text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-200 p-1 mr-1" data-id="${liberacao.id}">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn-delete-liberacao text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-200 p-1" data-id="${liberacao.id}">
                            <i class="fas fa-trash-alt"></i>
                        </button>
                    </td>
                `;
                
                tabelaElement.appendChild(row);
            });
            
            // Adicionar eventos aos botões
            document.querySelectorAll('.btn-edit-liberacao').forEach(button => {
                button.addEventListener('click', function() {
                    const id = this.getAttribute('data-id');
                    editarLiberacao(id);
                });
            });
            
            document.querySelectorAll('.btn-delete-liberacao').forEach(button => {
                button.addEventListener('click', function() {
                    const id = this.getAttribute('data-id');
                    excluirLiberacao(id);
                });
            });
        }
        
        // Editar liberação
        function editarLiberacao(id) {
            try {
                const liberacao = DB.liberacoes.get(id);
                if (!liberacao) {
                    Utils.exibirToast('Liberação não encontrada', 'error');
                    return;
                }
                
                // Preencher formulário
                document.getElementById('liberacao-frente').value = liberacao.frente || '';
                document.getElementById('liberacao-fazenda').value = liberacao.fazenda || '';
                document.getElementById('liberacao-numero').value = liberacao.numero || '';
                document.getElementById('liberacao-previsto').value = liberacao.previsto || '';
                document.getElementById('liberacao-realizado').value = liberacao.realizado || '';
                document.getElementById('liberacao-data').value = liberacao.data || '';
                document.getElementById('liberacao-observacoes').value = liberacao.observacoes || '';
                
                // Marcar formulário como edição
                document.getElementById('form-liberacao').setAttribute('data-editing', id);
                
                // Scroll para o formulário
                document.getElementById('liberacao-frente').scrollIntoView({ behavior: 'smooth' });
                document.getElementById('liberacao-frente').focus();
            } catch (error) {
                Utils.exibirToast(error.message, 'error');
            }
        }
        
        // Excluir liberação
        function excluirLiberacao(id) {
            try {
                // Confirmar exclusão
                if (!confirm('Tem certeza que deseja excluir esta liberação?')) {
                    return;
                }
                
                // Tentar excluir
                DB.liberacoes.remove(id);
                
                // Atualizar tabela, filtros e resumo
                atualizarFiltrosLiberacoes();
                atualizarTabelaLiberacoes();
                atualizarResumoLiberacoes();
                
                Utils.exibirToast('Liberação excluída com sucesso!', 'success');
            } catch (error) {
                Utils.exibirToast(error.message, 'error');
            }
        }
        
        // *** FUNÇÕES PARA GERENCIAR CONFIGURAÇÕES ***
        function inicializarConfiguracoes() {
            // Exportar JSON
            document.getElementById('btn-exportar-json')?.addEventListener('click', function() {
                try {
                    const dados = DB.exportData();
                    
                    // Criar blob e download
                    const blob = new Blob([dados], { type: 'application/json' });
                    const url = URL.createObjectURL(blob);
                    
                    const link = document.createElement('a');
                    link.setAttribute('href', url);
                    link.setAttribute('download', 'ggomes-log_backup_' + new Date().toISOString().split('T')[0] + '.json');
                    link.style.display = 'none';
                    
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    
                    Utils.exibirToast('Backup exportado com sucesso!', 'success');
                } catch (error) {
                    Utils.exibirToast('Erro ao exportar backup: ' + error.message, 'error');
                }
            });
            
            // Importar JSON
            document.getElementById('btn-importar-json')?.addEventListener('click', function() {
                document.getElementById('import-json-file').click();
            });
            
            document.getElementById('import-json-file')?.addEventListener('change', function(event) {
                const file = event.target.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    try {
                        const jsonData = e.target.result;
                        DB.importData(jsonData);
                        Utils.exibirToast('Backup importado com sucesso! A página será recarregada.', 'success');
                        
                        // Recarregar a página após um breve delay
                        setTimeout(() => {
                            location.reload();
                        }, 2000);
                    } catch (error) {
                        Utils.exibirToast('Erro ao importar backup: ' + error.message, 'error');
                    }
                };
                
                reader.readAsText(file);
            });
            
            // Limpar dados
            document.getElementById('btn-limpar-dados')?.addEventListener('click', function() {
                document.getElementById('modal-limpar-dados').classList.remove('hidden');
            });
            
            // Modal de confirmação
            document.getElementById('btn-cancelar-limpar')?.addEventListener('click', function() {
                document.getElementById('modal-limpar-dados').classList.add('hidden');
                document.getElementById('confirmacao-texto').value = '';
                document.getElementById('btn-confirmar-limpar').disabled = true;
                document.getElementById('btn-confirmar-limpar').classList.add('opacity-50', 'cursor-not-allowed');
            });
            
            document.getElementById('confirmacao-texto')?.addEventListener('input', function() {
                const confirmButton = document.getElementById('btn-confirmar-limpar');
                
                if (this.value === 'CONFIRMAR') {
                    confirmButton.disabled = false;
                    confirmButton.classList.remove('opacity-50', 'cursor-not-allowed');
                } else {
                    confirmButton.disabled = true;
                    confirmButton.classList.add('opacity-50', 'cursor-not-allowed');
                }
            });
            
            document.getElementById('btn-confirmar-limpar')?.addEventListener('click', function() {
                try {
                    DB.clearAll();
                    
                    document.getElementById('modal-limpar-dados').classList.add('hidden');
                    Utils.exibirToast('Todos os dados foram limpos com sucesso! A página será recarregada.', 'success');
                    
                    // Recarregar a página após um breve delay
                    setTimeout(() => {
                        location.reload();
                    }, 2000);
                } catch (error) {
                    Utils.exibirToast('Erro ao limpar dados: ' + error.message, 'error');
                }
            });
            
            // Botões de relatórios
            document.getElementById('btn-relatorio-producao')?.addEventListener('click', function() {
                const registros = DB.registros.getAll();
                const colhedoras = DB.colhedoras.getAll();
                
                // Obter estatísticas por colhedora
                const statsPorColhedora = {};
                
                registros.forEach(registro => {
                    const colhedoraId = registro.colhedoraId;
                    
                    if (!statsPorColhedora[colhedoraId]) {
                        statsPorColhedora[colhedoraId] = {
                            id: colhedoraId,
                            quantidade: 0,
                            horas: 0,
                            cultura: {},
                            diasUnicos: new Set()
                        };
                    }
                    
                    // Adicionar dados
                    statsPorColhedora[colhedoraId].quantidade += Number(registro.quantidade) || 0;
                    statsPorColhedora[colhedoraId].horas += Number(registro.horas) || 0;
                    statsPorColhedora[colhedoraId].diasUnicos.add(registro.data);
                    
                    // Adicionar cultura
                    if (registro.cultura) {
                        statsPorColhedora[colhedoraId].cultura[registro.cultura] = 
                            (statsPorColhedora[colhedoraId].cultura[registro.cultura] || 0) + 
                            Number(registro.quantidade || 0);
                    }
                });
                
                // Formatar dados para exportação
                const dadosFormatados = Object.values(statsPorColhedora).map(stats => {
                    const colhedora = colhedoras.find(c => c.id === stats.id) || {};
                    const nomeColhedora = colhedora.marca ? `${colhedora.marca} ${colhedora.modelo}` : stats.id;
                    
                    // Obter cultura principal
                    let culturaPrincipal = '';
                    let maiorQuantidade = 0;
                    
                    Object.entries(stats.cultura).forEach(([cultura, quantidade]) => {
                        if (quantidade > maiorQuantidade) {
                            maiorQuantidade = quantidade;
                            culturaPrincipal = cultura;
                        }
                    });
                    
                    // Calcular métricas
                    const rendimento = stats.horas > 0 ? stats.quantidade / stats.horas : 0;
                    const diasTrabalho = stats.diasUnicos.size;
                    const mediaDiaria = diasTrabalho > 0 ? stats.quantidade / diasTrabalho : 0;
                    
                    return {
                        colhedora: nomeColhedora,
                        cultura: culturaPrincipal,
                        producao: Utils.formatarToneladas(stats.quantidade),
                        horas: stats.horas.toFixed(1) + ' h',
                        rendimento: Utils.formatarRendimento(rendimento),
                        diasTrabalho: diasTrabalho,
                        mediaDiaria: Utils.formatarToneladas(mediaDiaria) + '/dia'
                    };
                });
                
                // Adicionar linha de totais
                const totalQuantidade = registros.reduce((total, r) => total + Number(r.quantidade || 0), 0);
                const totalHoras = registros.reduce((total, r) => total + Number(r.horas || 0), 0);
                const totalRendimento = totalHoras > 0 ? totalQuantidade / totalHoras : 0;
                
                // Obter datas únicas
                const datasUnicas = new Set(registros.map(r => r.data));
                const diasTotais = datasUnicas.size;
                const mediaDiariaTotal = diasTotais > 0 ? totalQuantidade / diasTotais : 0;
                
                dadosFormatados.push({
                    colhedora: '--- TOTAIS ---',
                    cultura: '',
                    producao: Utils.formatarToneladas(totalQuantidade),
                    horas: totalHoras.toFixed(1) + ' h',
                    rendimento: Utils.formatarRendimento(totalRendimento),
                    diasTrabalho: diasTotais,
                    mediaDiaria: Utils.formatarToneladas(mediaDiariaTotal) + '/dia'
                });
                
                // Definir colunas para o relatório
                const colunas = [
                    { header: 'Colhedora', dataKey: 'colhedora' },
                    { header: 'Cultura Principal', dataKey: 'cultura' },
                    { header: 'Produção Total', dataKey: 'producao' },
                    { header: 'Horas Trabalhadas', dataKey: 'horas' },
                    { header: 'Rendimento', dataKey: 'rendimento' },
                    { header: 'Dias de Trabalho', dataKey: 'diasTrabalho' },
                    { header: 'Média Diária', dataKey: 'mediaDiaria' }
                ];
                
                // Exportar para PDF
                Utils.exportarPDF(
                    'Relatório Completo de Produção',
                    dadosFormatados,
                    colunas,
                    'relatorio_completo_producao.pdf'
                );
            });
            
            document.getElementById('btn-relatorio-colhedoras')?.addEventListener('click', function() {
                const colhedoras = DB.colhedoras.getAll();
                const registros = DB.registros.getAll();
                const consumos = DB.consumos.getAll();
                
                // Obter estatísticas por colhedora
                const statsEquipamentos = DB.registros.getEquipmentStats();
                
                // Formatar dados para exportação
                const dadosFormatados = colhedoras.map(colhedora => {
                    const stats = statsEquipamentos.find(s => s.id === colhedora.id) || {
                        quantidade: 0,
                        horas: 0,
                        rendimento: 0,
                        diasUnicos: 0
                    };
                    
                    // Obter consumo
                    const consumosColhedora = consumos.filter(c => 
                        c.tipoEquipamento === 'colhedora' && 
                        c.equipamentoId === colhedora.id && 
                        c.tipoOleo === 'diesel'
                    );
                    
                    const totalDiesel = consumosColhedora.reduce(
                        (total, c) => total + Number(c.quantidade || 0), 0
                    );
                    
                    // Calcular eficiência
                    const eficiencia = totalDiesel > 0 ? stats.quantidade / totalDiesel : 0;
                    
                    return {
                        id: colhedora.id,
                        marca: colhedora.marca || '',
                        modelo: colhedora.modelo || '',
                        ano: colhedora.ano || '',
                        producao: Utils.formatarToneladas(stats.quantidade),
                        rendimento: Utils.formatarRendimento(stats.rendimento),
                        diasTrabalho: stats.diasUnicos,
                        mediaDiaria: Utils.formatarToneladas(stats.mediaDiaria) + '/dia',
                        consumoDiesel: Utils.formatarLitros(totalDiesel),
                        eficiencia: eficiencia.toFixed(2) + ' T/L'
                    };
                });
                
                // Definir colunas para o relatório
                const colunas = [
                    { header: 'ID', dataKey: 'id' },
                    { header: 'Marca', dataKey: 'marca' },
                    { header: 'Modelo', dataKey: 'modelo' },
                    { header: 'Ano', dataKey: 'ano' },
                    { header: 'Produção', dataKey: 'producao' },
                    { header: 'Rendimento', dataKey: 'rendimento' },
                    { header: 'Dias Trab.', dataKey: 'diasTrabalho' },
                    { header: 'Média Diária', dataKey: 'mediaDiaria' },
                    { header: 'Consumo Diesel', dataKey: 'consumoDiesel' },
                    { header: 'Eficiência', dataKey: 'eficiencia' }
                ];
                
                // Exportar para PDF
                Utils.exportarPDF(
                    'Relatório de Colhedoras',
                    dadosFormatados,
                    colunas,
                    'relatorio_colhedoras.pdf'
                );
            });
            
            document.getElementById('btn-relatorio-caminhoes')?.addEventListener('click', function() {
                const veiculos = DB.veiculosCadastrados.getAll();
                const viagens = DB.caminhoes.getAll();
                
                // Agrupar viagens por caminhão
                const viagensPorCaminhao = {};
                
                viagens.forEach(viagem => {
                    if (!viagensPorCaminhao[viagem.caminhaoId]) {
                        const veiculo = veiculos.find(v => v.id === viagem.caminhaoId) || {};
                        viagensPorCaminhao[viagem.caminhaoId] = {
                            id: viagem.caminhaoId,
                            placa: veiculo.placa || 'N/A',
                            modelo: veiculo.modelo || 'N/A',
                            tipo: veiculo.tipo === 'proprio' ? 'Próprio' : 'Terceiro',
                            producao: 0,
                            viagens: 0,
                            tempoCampo: 0,
                            tempoPatio: 0,
                            tempoTotal: 0
                        };
                    }
                    
                    viagensPorCaminhao[viagem.caminhaoId].producao += Number(viagem.producao || 0);
                    viagensPorCaminhao[viagem.caminhaoId].viagens += 1;
                    viagensPorCaminhao[viagem.caminhaoId].tempoCampo += Number(viagem.tempoCampo || 0);
                    viagensPorCaminhao[viagem.caminhaoId].tempoPatio += Number(viagem.tempoPatio || 0);
                    viagensPorCaminhao[viagem.caminhaoId].tempoTotal += 
                        Number(viagem.tempoCampo || 0) + Number(viagem.tempoPatio || 0);
                });
                
                // Formatar para exportação
                const dadosFormatados = Object.values(viagensPorCaminhao).map(caminhao => ({
                    id: caminhao.id,
                    placa: caminhao.placa,
                    modelo: caminhao.modelo,
                    tipo: caminhao.tipo,
                    producao: Utils.formatarToneladas(caminhao.producao),
                    viagens: caminhao.viagens,
                    tempoCampo: caminhao.viagens > 0 ? Math.round(caminhao.tempoCampo / caminhao.viagens) + ' min' : '-',
                    tempoPatio: caminhao.viagens > 0 ? Math.round(caminhao.tempoPatio / caminhao.viagens) + ' min' : '-',
                    tempoTotal: caminhao.viagens > 0 ? Math.round(caminhao.tempoTotal / caminhao.viagens) + ' min' : '-'
                }));
                
                // Adicionar estatísticas gerais
                const stats = DB.caminhoes.getStats();
                dadosFormatados.push({
                    id: '--- TOTAIS ---',
                    placa: '',
                    modelo: '',
                    tipo: '',
                    producao: Utils.formatarToneladas(stats.totalProducao),
                    viagens: stats.totalViagens,
                    tempoCampo: Math.round(stats.mediaTempoCampo) + ' min',
                    tempoPatio: Math.round(stats.mediaTempoPatio) + ' min',
                    tempoTotal: Math.round(stats.mediaTempoCampo + stats.mediaTempoPatio) + ' min'
                });
                
                // Definir colunas para o relatório
                const colunas = [
                    { header: 'ID', dataKey: 'id' },
                    { header: 'Placa', dataKey: 'placa' },
                    { header: 'Modelo', dataKey: 'modelo' },
                    { header: 'Tipo', dataKey: 'tipo' },
                    { header: 'Produção', dataKey: 'producao' },
                    { header: 'Viagens', dataKey: 'viagens' },
                    { header: 'Tempo Campo', dataKey: 'tempoCampo' },
                    { header: 'Tempo Pátio', dataKey: 'tempoPatio' },
                    { header: 'Tempo Total', dataKey: 'tempoTotal' }
                ];
                
                // Exportar para PDF
                Utils.exportarPDF(
                    'Relatório de Frota',
                    dadosFormatados,
                    colunas,
                    'relatorio_frota.pdf'
                );
            });
        }
        
        // Adicionar dados de exemplo se necessário
        function adicionarDadosExemplo() {
            // Já foi inicializado no método init do objeto DB
        }
    </script>
</body>
</html>
